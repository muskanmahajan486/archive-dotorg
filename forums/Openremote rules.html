<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Openremote rules</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Openremote rules
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Dec 03, 2012 by <font color="#0050B2">icefluffy</font>.
				    </div>

				    <p>I really don't know how to get rules working.<br/>
I just want a certain light to go on at 06:30 in the morning...</p>

<p>I created a 'TimeGrabber'<br/>
<img src="attachments/21038048/21135407.gif" align="absmiddle" border="0"/></p>

<p>Then I created a TimeSensor:<br/>
<img src="attachments/21038048/21135408.gif" align="absmiddle" border="0"/></p>

<p>The time sensor I can use to show the time in HH:mm format on my User Interface. (example of time would be 20:34)</p>

<p>I tried creating a rule to turn on a certain light at 06:30 with following rule:<br/>
<img src="attachments/21038048/21135409.gif" align="absmiddle" border="0"/></p>

<p>As you can see I do have a switch with that name:<br/>
<img src="attachments/21038048/21135410.gif" align="absmiddle" border="0"/></p>

<p>Why isn't it working and where can i find more documentation on rules.</p>

<p>If I'm doing thos all wrong, how should I handle it then?<br/>
I browsed this forum lots of times and all the examples I find are very unclear. Nowhere in the examples do i find what 'Switch' or 'timer' refers to in the list of existing commands made by the user. Sometimes I think it just refers to a property of a certain command.<br/>
Please someone help or send me to clear documentation</p>

<p>looking forward to hear from this really awesome motivated community! </p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038048/21135407.gif">TimeGrabber.GIF</a> (image/gif)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038048/21135408.gif">TimeSensor.GIF</a> (image/gif)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038048/21135409.gif">Rule.GIF</a> (image/gif)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038048/21135410.gif">Light17.GIF</a> (image/gif)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038048/21135421.gif">drules.GIF</a> (image/gif)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-21038055"></a>
                                    <font class="smallfont"><p>Having enabled rules once in the designer, I'm in real trouble.<br/>
I can't turn it off anymore in the designer. Leaving the rules.editor empty doesn't role back the config.<br/>
replacing the panels.obj file isn't possible and in the controller.xml and the panels.xml I can't turn off drools either.</p>

<p>STAY away from rules, it will mess up your config real bad.</p>

<p>Extract from the logs I finally got off of my NAS:</p>


<p>--------------------------------------------------------------------</p>

<p>  DEPLOYING NEW CONTROLLER RUNTIME...</p>

<p>--------------------------------------------------------------------</p>

<p>ERROR 2012-12-03 21:50:37,734 : Cannot start event processor 'Drools Rule Engine' : Unable to load dialect 'org.drools.rule.builder.dialect.java.JavaDialectConfiguration:java:org.drools.rule.builder.dialect.java.JavaDialectConfiguration'<br/>
org.drools.RuntimeDroolsException: Unable to load dialect 'org.drools.rule.builder.dialect.java.JavaDialectConfiguration:java:org.drools.rule.builder.dialect.java.JavaDialectConfiguration'<br/>
	at org.drools.compiler.PackageBuilderConfiguration.addDialect(PackageBuilderConfiguration.java:283)<br/>
	at org.drools.compiler.PackageBuilderConfiguration.buildDialectConfigurationMap(PackageBuilderConfiguration.java:268)<br/>
	at org.drools.compiler.PackageBuilderConfiguration.init(PackageBuilderConfiguration.java:181)<br/>
	at org.drools.compiler.PackageBuilderConfiguration.&lt;init&gt;(PackageBuilderConfiguration.java:159)<br/>
	at org.drools.compiler.PackageBuilder.&lt;init&gt;(PackageBuilder.java:210)<br/>
	at org.drools.compiler.PackageBuilder.&lt;init&gt;(PackageBuilder.java:143)<br/>
	at org.drools.builder.impl.KnowledgeBuilderFactoryServiceImpl.newKnowledgeBuilder(KnowledgeBuilderFactoryServiceImpl.java:34)<br/>
	at org.drools.builder.KnowledgeBuilderFactory.newKnowledgeBuilder(KnowledgeBuilderFactory.java:47)<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.getValidKnowledgePackages(RuleEngine.java:484)<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.start(RuleEngine.java:253)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.start(EventProcessorChain.java:112)<br/>
	at org.openremote.controller.statuscache.StatusCache.start(StatusCache.java:120)<br/>
	at org.openremote.controller.deployer.Version20ModelBuilder.buildSensorModel(Version20ModelBuilder.java:615)<br/>
	at org.openremote.controller.deployer.Version20ModelBuilder.build(Version20ModelBuilder.java:537)<br/>
	at org.openremote.controller.deployer.AbstractModelBuilder.buildModel(AbstractModelBuilder.java:148)<br/>
	at org.openremote.controller.service.Deployer.startup(Deployer.java:760)<br/>
	at org.openremote.controller.service.Deployer.softRestart(Deployer.java:373)<br/>
	at org.openremote.controller.service.Deployer$ControllerDefinitionWatch.run(Deployer.java:1188)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Caused by: org.drools.RuntimeDroolsException: value '1.7' is not a valid language level<br/>
	at org.drools.rule.builder.dialect.java.JavaDialectConfiguration.getDefaultLanguageLevel(JavaDialectConfiguration.java:162)<br/>
	at org.drools.rule.builder.dialect.java.JavaDialectConfiguration.init(JavaDialectConfiguration.java:57)<br/>
	at org.drools.compiler.PackageBuilderConfiguration.addDialect(PackageBuilderConfiguration.java:279)<br/>
	... 18 more<br/>
ERROR Controller Definition File Watcher for Default Deployer: Cannot start event processor 'Drools Rule Engine' : Unable to load dialect 'org.drools.rule.builder.dialect.java.JavaDialectConfiguration:java:org.drools.rule.builder.dialect.java.JavaDialectConfiguration'<br/>
org.drools.RuntimeDroolsException: Unable to load dialect 'org.drools.rule.builder.dialect.java.JavaDialectConfiguration:java:org.drools.rule.builder.dialect.java.JavaDialectConfiguration'<br/>
	at org.drools.compiler.PackageBuilderConfiguration.addDialect(PackageBuilderConfiguration.java:283)<br/>
	at org.drools.compiler.PackageBuilderConfiguration.buildDialectConfigurationMap(PackageBuilderConfiguration.java:268)<br/>
	at org.drools.compiler.PackageBuilderConfiguration.init(PackageBuilderConfiguration.java:181)<br/>
	at org.drools.compiler.PackageBuilderConfiguration.&lt;init&gt;(PackageBuilderConfiguration.java:159)<br/>
	at org.drools.compiler.PackageBuilder.&lt;init&gt;(PackageBuilder.java:210)<br/>
	at org.drools.compiler.PackageBuilder.&lt;init&gt;(PackageBuilder.java:143)<br/>
	at org.drools.builder.impl.KnowledgeBuilderFactoryServiceImpl.newKnowledgeBuilder(KnowledgeBuilderFactoryServiceImpl.java:34)<br/>
	at org.drools.builder.KnowledgeBuilderFactory.newKnowledgeBuilder(KnowledgeBuilderFactory.java:47)<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.getValidKnowledgePackages(RuleEngine.java:484)<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.start(RuleEngine.java:253)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.start(EventProcessorChain.java:112)<br/>
	at org.openremote.controller.statuscache.StatusCache.start(StatusCache.java:120)<br/>
	at org.openremote.controller.deployer.Version20ModelBuilder.buildSensorModel(Version20ModelBuilder.java:615)<br/>
	at org.openremote.controller.deployer.Version20ModelBuilder.build(Version20ModelBuilder.java:537)<br/>
	at org.openremote.controller.deployer.AbstractModelBuilder.buildModel(AbstractModelBuilder.java:148)<br/>
	at org.openremote.controller.service.Deployer.startup(Deployer.java:760)<br/>
	at org.openremote.controller.service.Deployer.softRestart(Deployer.java:373)<br/>
	at org.openremote.controller.service.Deployer$ControllerDefinitionWatch.run(Deployer.java:1188)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Caused by: org.drools.RuntimeDroolsException: value '1.7' is not a valid language level<br/>
	at org.drools.rule.builder.dialect.java.JavaDialectConfiguration.getDefaultLanguageLevel(JavaDialectConfiguration.java:162)<br/>
	at org.drools.rule.builder.dialect.java.JavaDialectConfiguration.init(JavaDialectConfiguration.java:57)<br/>
	at org.drools.compiler.PackageBuilderConfiguration.addDialect(PackageBuilderConfiguration.java:279)<br/>
	... 18 more<br/>
INFO 2012-12-03 21:50:38,032 : Registered sensor : Level Sensor (Name = 'Screen Links', ID = '653', Min: 0, Max: 100)<br/>
INFO 2012-12-03 21:50:38,033 : Registered sensor : Switch Sensor (Name = 'L1', ID = '652')<br/>
INFO 2012-12-03 21:50:38,033 : Registered sensor : Switch Sensor (Name = 'L11', ID = '655')<br/>
Exception in thread "Polling Sensor Thread ID = 653, Name ='Screen Links'" Exception in thread "Polling Sensor Thread ID = 652, Name ='L1'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
INFO 2012-12-03 21:50:38,036 : Registered sensor : Switch Sensor (Name = 'L21 SLK 5', ID = '654')<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 655, Name ='L11'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
INFO 2012-12-03 21:50:38,040 : Registered sensor : Switch Sensor (Name = 'L4', ID = '649')<br/>
INFO 2012-12-03 21:50:38,041 : Registered sensor : Switch Sensor (Name = 'L8', ID = '648')<br/>
INFO 2012-12-03 21:50:38,042 : Registered sensor : Switch Sensor (Name = 'L2', ID = '651')<br/>
INFO 2012-12-03 21:50:38,044 : Registered sensor : Switch Sensor (Name = 'L3', ID = '650')<br/>
INFO 2012-12-03 21:50:38,046 : Registered sensor : Switch Sensor (Name = 'L9', ID = '645')<br/>
INFO 2012-12-03 21:50:38,046 : Registered sensor : Switch Sensor (Name = 'L6', ID = '644')<br/>
INFO 2012-12-03 21:50:38,047 : Registered sensor : Level Sensor (Name = 'Screen SLK', ID = '647', Min: 0, Max: 100)<br/>
INFO 2012-12-03 21:50:38,049 : Registered sensor : Level Sensor (Name = 'Screen Rechts', ID = '646', Min: 0, Max: 100)<br/>
INFO 2012-12-03 21:50:38,052 : Registered sensor : Switch Sensor (Name = 'L15', ID = '641')<br/>
INFO 2012-12-03 21:50:38,054 : Registered sensor : Switch Sensor (Name = 'L16', ID = '640')<br/>
INFO 2012-12-03 21:50:38,055 : Registered sensor : Switch Sensor (Name = 'L7', ID = '643')<br/>
INFO 2012-12-03 21:50:38,056 : Registered sensor : Switch Sensor (Name = 'L5', ID = '642')<br/>
INFO 2012-12-03 21:50:38,057 : Registered sensor : Switch Sensor (Name = 'L10', ID = '772')<br/>
INFO 2012-12-03 21:50:38,058 : Registered sensor : Switch Sensor (Name = 'Licht Trap AAN/UIT', ID = '770')<br/>
INFO 2012-12-03 21:50:38,059 : Registered sensor : Switch Sensor (Name = 'Power ON/OFF', ID = '768')<br/>
INFO 2012-12-03 21:50:38,060 : Registered sensor : Switch Sensor (Name = 'L12', ID = '656')<br/>
INFO 2012-12-03 21:50:38,061 : Registered sensor : Switch Sensor (Name = 'L17', ID = '639')<br/>
Exception in thread "Polling Sensor Thread ID = 768, Name ='Power ON/OFF'" Exception in thread "Polling Sensor Thread ID = 770, Name ='Licht Trap AAN/UIT'" INFO 2012-12-03 21:50:38,063 : Registered sensor : Switch Sensor (Name = 'L13', ID = '657')<br/>
java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
INFO 2012-12-03 21:50:38,064 : Registered sensor : Switch Sensor (Name = 'L18', ID = '638')<br/>
java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
INFO 2012-12-03 21:50:38,066 : Registered sensor : Sensor (Name = 'DisplayDateSensor', ID = '658', State Mappings: {})<br/>
INFO 2012-12-03 21:50:38,067 : Registered sensor : Switch Sensor (Name = 'L14', ID = '659')<br/>
Exception in thread "Polling thread for sensor: DisplayDateSensor" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.protocol.datetime.DateTimeCommand.run(DateTimeCommand.java:173)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
INFO 2012-12-03 21:50:38,077 : Startup complete.<br/>
Exception in thread "Polling Sensor Thread ID = 642, Name ='L5'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 641, Name ='L15'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 646, Name ='Screen Rechts'" Exception in thread "Polling Sensor Thread ID = 645, Name ='L9'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 647, Name ='Screen SLK'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 649, Name ='L4'" java.lang.NullPointerException<br/>
Exception in thread "Polling Sensor Thread ID = 648, Name ='L8'" 	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 659, Name ='L14'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 639, Name ='L17'" java.lang.NullPointerException<br/>
Exception in thread "Polling Sensor Thread ID = 657, Name ='L13'" 	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 654, Name ='L21 SLK 5'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 772, Name ='L10'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 643, Name ='L7'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 640, Name ='L16'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 644, Name ='L6'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 650, Name ='L3'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 651, Name ='L2'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 638, Name ='L18'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)<br/>
Exception in thread "Polling Sensor Thread ID = 656, Name ='L12'" java.lang.NullPointerException<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.push(RuleEngine.java:145)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.push(EventProcessorChain.java:188)<br/>
	at org.openremote.controller.statuscache.StatusCache.update(StatusCache.java:260)<br/>
	at org.openremote.controller.model.sensor.Sensor.update(Sensor.java:342)<br/>
	at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)<br/>
	at java.lang.Thread.run(Thread.java:722)</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by icefluffy at Dec 03, 2012 21:11
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038068"></a>
                                    <font class="smallfont"><p>OpenRemote drools does not support Java7 yet.<br/>
Please use Java6 to run the controller.<br/>
There are lots of rules examples for timer in the forums.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 04, 2012 08:30
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038070"></a>
                                    <font class="smallfont"><p>Oops, I am using Java 7 indeed.</p>

<p>I will try downgrading my NAS 213+ to Java6 and see what it gives.<br/>
Thanks for the help, I'll post the outcome here as soon as i have em</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by icefluffy at Dec 04, 2012 10:31
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038118"></a>
                                    <font class="smallfont"><p>I downgraded to Java 6 on my synology 213+.</p>

<p>The file is ejre-1_6_0_34-fcs-b04-linux-ppc-e500v2-headless-19_jul_2012.tar.gz on following link:
<a href="http://www.oracle.com/technetwork/java/embedded/downloads/javase/index.html">http://www.oracle.com/technetwork/java/embedded/downloads/javase/index.html</a></p>

<p>Drools doesn't give any problems anymore, my openremote controller works again.</p>

<p>I still need to get my "timesensor" working.</p>

<p>The latest code I have is:</p>

<p>package org.openremote.controller.model.event<br/>
global org.openremote.controller.statuscache.CommandFacade execute;<br/>
global org.openremote.controller.statuscache.SwitchFacade switches;<br/>
import org.openremote.controller.protocol.*;<br/>
rule "Turn Light On"<br/>
when<br/>
  Switch ( source == "DisplayDateSensor", value == "00:05" )<br/>
then<br/>
 System.out.println("rule executed"); <br/>
  execute.command("0/0/5 ON");<br/>
end</p>


<p>still not working...<br/>
This freak'n trial and error is getting on my nerves!</p>

<p>Good documentation and concrete examples would be helpfull.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by icefluffy at Dec 04, 2012 20:48
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038119"></a>
                                    <font class="smallfont"><p>You don't need a DateTimeCommand todo something at a certain time.<br/>
Drools has support for this build-in. There are posts on the forum regarding cron based triggers in the rules engine.<br/>
Just search on the forums.</p>

<p>We know documentation needs to improve and we are always looking for volunteers.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 04, 2012 20:59
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038130"></a>
                                    <font class="smallfont"><p>I've been scrolling the forums for 18hrs now, no results. I definetly volunteer to make a document on my findings loool.<br/>
Right now I just need some rest.</p>

<p>on following link are examples but I dont understand them:
<a href="http://www.openremote.org/display/forums/Rules+how+to?focusedCommentId=19437860">http://www.openremote.org/display/forums/Rules+how+to?focusedCommentId=19437860</a></p>

<p>the •Scheduled Command Execution example consists of this:</p>

<p>package org.openremote.controller.protocol<br/>
global org.openremote.controller.statuscache.CommandFacade execute;<br/>
rule "Execute Scheduled Command"<br/>
  timer (int: 0s 1s)<br/>
when<br/>
  eval(true)<br/>
then<br/>
  execute.command("counter");<br/>
end</p>

<p>what is timer? can i find it in the controller.xml? is it a name property of a sensor? commmand? an at that moment defined variable?<br/>
what is counter? can i find it in controller.xml? is it the 'name' property of a sensor? command?</p>

<p>sorry for being a pain guys...</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by icefluffy at Dec 04, 2012 21:18
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038132"></a>
                                    <font class="smallfont"><p>"timer" is a keyword for schedules in rules but better is to use "cron" syntax.<br/>
You can find a discussion here: <a href="http://www.openremote.org/display/forums/Cron+vs.+Rules">http://www.openremote.org/display/forums/Cron+vs.+Rules</a><br/>
"counter" is that case is a name of a command. You can execute commands based on their names.</p>

<p>Rules can be triggered based on events and their values, or just events or with the internal scheduler. <br/>
Events come from the sensors and you have to use a sensor name to address them.<br/>
For example:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
<span class="code-keyword">package</span> org.openremote.controller.model.event

global org.openremote.controller.statuscache.CommandFacade execute;
global org.openremote.controller.statuscache.SwitchFacade switches;

<span class="code-keyword">import</span> org.openremote.controller.protocol.Event;

rule <span class="code-quote">"Turn Music on via KNX"</span>
when
  $evt:Event(source == <span class="code-quote">"SwitchSensor"</span>, value == <span class="code-quote">"on"</span>)
then
  execute.command(<span class="code-quote">"test"</span>);
end
</pre>
</div></div>

<p>This rule waits for an event from a sensor where the sensor name is "SwitchSensor" and the value is "on".<br/>
It then executes a command with the name "test"</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 04, 2012 21:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038134"></a>
                                    <font class="smallfont"><p>This may help:</p>


<p>Cron expressions are comprised of 6 required fields and one optional field separated by white space. The fields respectively are described as follows:</p>

<p>Field Name Allowed Values Allowed Special Characters</p>

<p> Seconds 0-59 , - * /<br/>
 Minutes 0-59 , - * /<br/>
 Hours 0-23 , - * /<br/>
 Day-of-month 1-31 , - * ? / L W<br/>
 Month 1-12 or JAN-DEC , - * /<br/>
 Day-of-Week 1-7 or SUN-SAT , - * ? / L #<br/>
 Year (Optional) empty, 1970-2199 , - * /</p>

<p>The * character is used to specify all values. For example, * in the minute field means "every minute".</p>

<p>The '?' character is allowed for the day-of-month and day-of-week fields. It is used to specify 'no specific value'. This is useful when you need to specify something in one of the two fields, but not the other.</p>

<p>The '-' character is used to specify ranges For example "10-12" in the hour field means "the hours 10, 11 and 12".</p>

<p>The ',' character is used to specify additional values. For example "MON,WED,FRI" in the day-of-week field means "the days Monday, Wednesday, and Friday".</p>

<p>The '/' character is used to specify increments. For example "0/15" in the seconds field means "the seconds 0, 15, 30, and 45". And "5/15" in the seconds field means "the seconds 5, 20, 35, and 50". Specifying '*' before the '/' is equivalent to specifying 0 is the value to start with. Essentially, for each field in the expression, there is a set of numbers that can be turned on or off. For seconds and minutes, the numbers range from 0 to 59. For hours 0 to 23, for days of the month 0 to 31, and for months 1 to 12. The "/" character simply helps you turn on every "nth" value in the given set. Thus "7/6" in the month field only turns on month "7", it does NOT mean every 6th month, please note that subtlety.</p>

<p>The 'L' character is allowed for the day-of-month and day-of-week fields. This character is short-hand for "last", but it has different meaning in each of the two fields. For example, the value "L" in the day-of-month field means "the last day of the month" - day 31 for January, day 28 for February on non-leap years. If used in the day-of-week field by itself, it simply means "7" or "SAT". But if used in the day-of-week field after another value, it means "the last xxx day of the month" - for example "6L" means "the last friday of the month". When using the 'L' option, it is important not to specify lists, or ranges of values, as you'll get confusing results.</p>

<p>The 'W' character is allowed for the day-of-month field. This character is used to specify the weekday (Monday-Friday) nearest the given day. As an example, if you were to specify "15W" as the value for the day-of-month field, the meaning is: "the nearest weekday to the 15th of the month". So if the 15th is a Saturday, the trigger will fire on Friday the 14th. If the 15th is a Sunday, the trigger will fire on Monday the 16th. If the 15th is a Tuesday, then it will fire on Tuesday the 15th. However if you specify "1W" as the value for day-of-month, and the 1st is a Saturday, the trigger will fire on Monday the 3rd, as it will not 'jump' over the boundary of a month's days. The 'W' character can only be specified when the day-of-month is a single day, not a range or list of days.</p>

<p>The 'L' and 'W' characters can also be combined for the day-of-month expression to yield 'LW', which translates to "last weekday of the month".</p>

<p>The '#' character is allowed for the day-of-week field. This character is used to specify "the nth" XXX day of the month. For example, the value of "6#3" in the day-of-week field means the third Friday of the month (day 6 = Friday and "#3" = the 3rd one in the month). Other examples: "2#1" = the first Monday of the month and "4#5" = the fifth Wednesday of the month. Note that if you specify "#5" and there is not 5 of the given day-of-week in the month, then no firing will occur that month. If the '#' character is used, there can only be one expression in the day-of-week field ("3#1,6#3" is not valid, since there are two expressions).</p>

<p>The legal characters and the names of months and days of the week are not case sensitive.</p>

<p>NOTES:</p>

<p>Support for specifying both a day-of-week and a day-of-month value is not complete (you'll need to use the '?' character in one of these fields).</p>

<p>Overflowing ranges is supported - that is, having a larger number on the left hand side than the right. You might do 22-2 to catch 10 o'clock at night until 2 o'clock in the morning, or you might have NOV-FEB. It is very important to note that overuse of overflowing ranges creates ranges that don't make sense and no effort has been made to determine which interpretation CronExpression chooses. An example would be "0 0 14-6 ? * FRI-MON".</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by artart at Dec 05, 2012 00:10
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038153"></a>
                                    <font class="smallfont"><p>IT's FINALLY WORKING</p>

<p>Thank you Marcus and ART!</p>

<p>1. You need to have Java6 NOT 7 to be able to use drools!<br/>
2. Art BALOURDA's post about CRON EXPRESSIONS, right above this post is a must! !!!BUT!!! an * in the Day-of-Month field will cause errors in the controller!!<br/>
3. respect the lines and spacings in the rules editor</p>

<p>My finally working code:<br/>
<img src="attachments/21038048/21135421.gif" align="absmiddle" border="0"/><br/>
Notice the empty line before my rule line.<br/>
notice that between each line there is an empty line.<br/>
know that when there is a 'tab' at the front of the line, they are actually 2 spaces.</p>

<p>'timer' is drool language and need not be defined in your designer.<br/>
notice that 'timer' comes right after the rule line and that the next line is a 'when' line<br/>
the evaluation (in this case whether it's true) is done on the value of 'timer'<br/>
"L17 AAN" is a COMMAND I defined in designer:<br/>
<img src="attachments/21038048/21135410.gif" align="absmiddle" border="0"/></p>

<p>Good luck &amp; thanks to all for your inputs and help</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by icefluffy at Dec 05, 2012 19:06
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879294"></a>
                                    <font class="smallfont"><p>I get the same error for the rules engine not to start in OR2.1 on Qnap NAS. 'Cannot start event processor 'Drools Rule Engine' : Unable to load dialect'. Caused by: org.drools.RuntimeDroolsException: value '1.7′ is not a valid language level'. Already downgraded JRE from 7 to 6 but without success. Someone any suggestions on how to get this working?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by bunster at Nov 03, 2013 10:05
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879309"></a>
                                    <font class="smallfont"><p>The error says the jre is 1.7. You can verify the same using <div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">java -version</pre>
</div></div></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by atamariya at Nov 03, 2013 13:34
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 10:44</font></td>
		    </tr>
	    </table>
    </body>
</html>