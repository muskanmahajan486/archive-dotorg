<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Scripted change of image on a button</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Scripted change of image on a button
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on May 07, 2013 by <font color="#0050B2">garderhagen</font>.
				    </div>

				    <p>Hi.</p>

<p>I am currently working on a hourly schedule of temperature set values, and have been stuck with a problem.<br/>
I would like to have one button pr hour of a day, displaying the set degree value for that hour. </p>

<p>My problem is that i can use the image widget to get a sensor to update the current set value, but this does not support a command when pressed.<br/>
Using a button works fine, but here i can not link more than two images.</p>

<p>Can i use a button image and us a script to replace the image dependent on set value?<br/>
Any other suggestions to how i can achieve the goal here ?</p>

<p>Please find the attached screen to give more details. <br/>
The buttons are in Norwegian. Here is a quick translation:</p>

<p>Natt = Night<br/>
Formidag  = Morning<br/>
Eftermiddag = Afternoon<br/>
Kveld = Evening</p>

<p>Mandag = Monday<br/>
Tirsdag = Tuesday<br/>
Onsdag = Wednesday<br/>
Torsdag = Thursday<br/>
Fredag = Friday<br/>
Lørdag = Saturday<br/>
Søndag = Sunday</p>

<p><img src="attachments/22413695/22708246.png" align="absmiddle" border="0"/></p>


<p>Question 2.</p>

<p>To bring life to this screen i would have to generate a lot of commands. Are there any way to use parameters as part as the URL in a HTTP protocol ?<br/>
Example :</p>

<p>HTTP Protocol URL : http // 192.168.0.41/IISRestService/TempSettings/%ValueOfDeviceID%/%ParameterOfDeviceID%</p>

<p>Thank you for any input <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>I will of course share my template when done.</p>

<p>Best regards<br/>
Bjørn Tore</p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22413695/22708246.png">Tempreture schedule screen.png</a> (image/png)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-22413707"></a>
                                    <font class="smallfont"><p>Don't put any text in your button and put a label or image in front of it.</p>

<p>The ordering of UI elements in the designer is a bit dodgy (at best) and you'll have to play around with selecting/moving the objects to get the desired result. But the consoles should respect the order of widgets as they appear in the designer.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at May 07, 2013 12:07
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22413709"></a>
                                    <font class="smallfont"><p>Thanks. </p>

<p>I will try that.<br/>
I guess that means the Grid used has to go <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by garderhagen at May 07, 2013 12:53
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22413812"></a>
                                    <font class="smallfont"><p>You can still use a grid for the buttons if you prefer, but not for the label/image on top of it.</p>

<p>I tend to not use grids and just use the alignment buttons to get the same effect.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at May 08, 2013 09:09
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414108"></a>
                                    <font class="smallfont"><p>Thanks.</p>

<p>This works, gives me the effect i am after.</p>

<p>But I have a follow-up question. The GUI further up contains a lot of buttons and labels now, and to give it usability, I need high update frequencies on the commands. Should I be concerned?<br/>
I have 60 objects that need frequent updates.</p>

<p>I have tried to use /rest/status/device_id to force updates to related sensors when needed, but this looks like it does not trigger the underlying command.<br/>
Are there rest API to execute commands as well? Or other ways to update labels and switches when desired, without having to keep very high update frequency?</p>

<p>Thanks a lot.<br/>
Best regards<br/>
Bjørn Tore</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by garderhagen at May 11, 2013 12:02
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414150"></a>
                                    <font class="smallfont"><p>The console polls the controller constantly (server push technology) and it depends on the command how the related sensor is updated. Some do this depending on a loop (HTTP and poolingInterval) some do it based on the technology (KNX).</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at May 12, 2013 11:27
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414168"></a>
                                    <font class="smallfont"><p>Thanks.</p>

<p>I use HTTP, but i would like to avoid having polling interval set to 500ms. Can i force the sensor to update by using the Controller Rest API ?</p>

<p>Thanks<br/>
Best regards<br/>
Bjørn Tore</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by garderhagen at May 12, 2013 18:58
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414170"></a>
                                    <font class="smallfont"><p>If you use HTTP this is the only way since HTTP is request based.<br/>
The only way around would be to write a propriatary protocol for your device which keeps a constant connection open.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at May 12, 2013 19:28
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414172"></a>
                                    <font class="smallfont"><p>hmmmm.</p>

<p>Looking at the documentation.<br/>
Rest Status Update.<br/>
/rest/polling/{device_id}/{sensor_id},{sensor_id},...</p>

<p>Could i make a button, conneted to a HTTP command invoking this url to update the sensor connected to my label ?</p>

<p>Only trouble so far in testing this, is i do not know what the device_id is. I have not found anything in the documentation or forum explaining how i can get the device_id.<br/>
Finding the sensor id is ok.</p>

<p>Thanks again.</p>

<p>btg</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by garderhagen at May 12, 2013 19:48
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414177"></a>
                                    <font class="smallfont"><p>Just a wild guess. Aren't devices the elements directly underneath &lt;components&gt; in the controller.xml? So e.g. switch and button in the example below?</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml">  <span class="code-tag">&lt;components&gt;</span>
    <span class="code-tag">&lt;switch id=<span class="code-quote">"154"</span>&gt;</span>
      <span class="code-tag">&lt;on&gt;</span>
        <span class="code-tag">&lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"172"</span> /&gt;</span>
      <span class="code-tag">&lt;/on&gt;</span>
      <span class="code-tag">&lt;off&gt;</span>
        <span class="code-tag">&lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"171"</span> /&gt;</span>
      <span class="code-tag">&lt;/off&gt;</span>
      <span class="code-tag">&lt;include type=<span class="code-quote">"sensor"</span> ref=<span class="code-quote">"173"</span> /&gt;</span>
    <span class="code-tag">&lt;/switch&gt;</span>
    <span class="code-tag">&lt;button id=<span class="code-quote">"156"</span>&gt;</span>
      <span class="code-tag">&lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"172"</span> /&gt;</span>
    <span class="code-tag">&lt;/button&gt;</span></pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at May 12, 2013 20:43
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414179"></a>
                                    <font class="smallfont"><p>The protocol needs to update the sensor first.<br/>
This Rest call is used by the console to receive the sensor value from the controller and nothing todo how the sensor value gets into the controllers status cache.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at May 12, 2013 20:59
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414180"></a>
                                    <font class="smallfont"><p>I expected that to be the sensor_id in the last part of the URL.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by garderhagen at May 12, 2013 20:59
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414181"></a>
                                    <font class="smallfont"><p>Are there any other way to update the sensor without using a high frequent polling interval of the connected command ?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by garderhagen at May 12, 2013 21:02
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414182"></a>
                                    <font class="smallfont"><p>No, unless you program something for your device.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at May 12, 2013 21:09
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414194"></a>
                                    <font class="smallfont"><p>Can you explain a little further what you're trying to do?</p>

<p>I'm sort of lost in this thread of what is being attempted.</p>

<p>The normal interaction between panels, controller and HTTP device works like this:</p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>
(PANEL SENSOR VIEW) &lt;-- HTTP Server Push -- (CONTROLLER SENSOR VALUE) -- HTTP Request/Response Poll (PollingInterval) --&gt; (DEVICE)

</pre>
</div></div>

<p>Under normal circumstances there's nothing more that can be done for a HTTP based device other than adjusting the polling interval. Consequently this makes HTTP one of the <b>worst</b> integration protocols for device or sensor integration. Nevertheless it remains one of the most popular. </p>

<p>Adjusting the polling interval will impact the response time on the panel's sensor view.</p>

</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at May 13, 2013 11:51
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23593514"></a>
                                    <font class="smallfont"><blockquote><p>I'm sort of lost in this thread of what is being attempted</p></blockquote>

<p>It is not that difficult to see what Bjørn Tore intends to do. He is concerned about the heavy load of polling his sensors. The case is, that his device can not only reply on http requests <b>from</b> the ORC, but his device is also capable of making autonomous http requests <b>to</b> the ORC.<br/>
To the non-initiated user, the obvious choice for http requests to the ORC is the REST API. So with <em>rest/status</em>, and next <em>status/polling</em> he hoped that he could initiate a status request call from ORC to his device. The REST API documentation does not provide much documentation of what is happening behind the scenes. Unfortunately Bjørn Tore stopped at the status/polling thing because he did not know what device_id does stand for. I did give a few tries, but did not get any further. (In my experiments I used a status command with a polling interval of 23h, in the hope that external triggers would tak care for calling the command) </p>

<p>As I have been attempting similar things, I spend some time reading old threads that relate to this. Bjørn Tore is not the only one who wants to inititiate a Status update on an external (http) stimulus. As one of the original design documents says that this interface is not only intended for consoles, but also for devices, it may be worth to revisit the REST API in that context.</p>

<p>Some use cases I found<br/>
<b>Arduino related</b><br/>
<a href="http://www.openremote.org/display/forums/Display+data+from+received+HTTP+events">http://www.openremote.org/display/forums/Display+data+from+received+HTTP+events</a><br/>
<a href="http://www.openremote.org/display/forums/http+protocol%2C+json+and+multiple+calls+%28reduce+calls%29">http://www.openremote.org/display/forums/http+protocol%2C+json+and+multiple+calls+%28reduce+calls%29</a><br/>
<a href="http://www.openremote.org/display/forums/DIY+arduino+home+automation.?focusedCommentId=19432788#comment-19432788">http://www.openremote.org/display/forums/DIY+arduino+home+automation.?focusedCommentId=19432788#comment-19432788</a><br/>
<b>Other OR</b><br/>
Bjørn Tore Garderhagen:<a href="http://www.openremote.org/display/forums/Scripted+change+of+image+on+a+button?focusedCommentId=22414108#comment-22414108">http://www.openremote.org/display/forums/Scripted+change+of+image+on+a+button?focusedCommentId=22414108#comment-22414108</a><br/>
Francois Delpierre:<a href="http://www.openremote.org/pages/viewpage.action?pageId=19435069&amp;focusedCommentId=19435196#comment-19435196">http://www.openremote.org/pages/viewpage.action?pageId=19435069&amp;focusedCommentId=19435196#comment-19435196</a><br/>
<b>RaZberry</b><br/>
[http://www.openremote.org/pages/viewpage.action?pageId=22886530 (with some valuable background response from Marcus)</p>

<p>If I hadn't found these use cases, I had given up, and not posted this reply. For those getting tired, just ignore this reply.</p>


</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Nov 04, 2014 20:15
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23593654"></a>
                                    <font class="smallfont"><p>Pieter,</p>

<p>I do understand the use case but I'm not certain that the existing REST API (and certainly not the existing calls) are the appropriate way to achieve what is being requested.</p>

<p>Unfortunately, the answer is not that straightforward and I need to take time to think about how to best implement this. Time which I don't have at this moment but I'll eventually get back to this.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Nov 13, 2014 09:44
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23593657"></a>
                                    <font class="smallfont"><p>Eric,<br/>
Imho the basic misunderstanding about the REST API arises from the fact that its scope and intended use is not clearly described. Besides in one of the early design documents it was said that is was intended for use with consoles and devices.<br/>
So from a Webbrowser I was able to send a command  to set a switch on. Simple minded as I am, I thought I could do a similar call to a get status command being executed, which would update a sensor. That apparantly is not the case. So let us leave that behind us.</p>

<p>Lately I have been working quite a bit on the RaZberry end to see what I could do with UDPListener. As a matter off fact I can now let the Razberry send a UDP message at the moment a Z/Wave device reported a change of status in the form of a (sensor,value)-pair. For example <em>Switch2Status,off</em>. It is a bit clumsy, but should do for further experiments with OR. See:<a href="http://forum.z-wave.me/viewtopic.php?f=3422&amp;t=20816&amp;p=53047#p53047">RaZberry forum</a>. <br/>
I can imagine he UDPListener having a mode where it stores the value directly in the sensor, but also only based on the sensor name let it initiate sensor update request as defined within OR.   </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Nov 13, 2014 15:54
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:31</font></td>
		    </tr>
	    </table>
    </body>
</html>