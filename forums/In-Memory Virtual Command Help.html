<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : In-Memory Virtual Command Help</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : In-Memory Virtual Command Help
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Mar 31, 2013 by <font color="#0050B2">iloveautomation</font>.
				    </div>

				    <p>I have been trying (for a while) to create a switch for my X10 lights. Since X10 does not provide status feedback I was wondering if I could use the in-memory Virtual command? If yes, how do I define it?<br/>
I tried putting in ON for Command and DUMMY for address and vice versa but so far have had no luck. Also I could not find any documentation related to it which is understandable.</p>

<p>It would be great if I could get some help on it. <br/>
The X10 ON/OFF commands work a little bit erratic meaning, when I try to turn on K2 light, K3 or K9 command is passed on. Of course now my first task is to get the sensor/switch work. My setup is Win 7 64bit with Serial CM11A.</p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21859415/22708275.png">Off.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21859415/22708276.png">On.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21859415/22708277.png">Sensor.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21859415/22708278.png">Status.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21859415/22708279.png">Switch.png</a> (image/png)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-21859567"></a>
                                    <font class="smallfont"><p>Address will basically just be the name of your variable here.<br/>
You can use commands ON, OFF and STATUS.<br/>
ON will set variable to true, OFF to false and STATUS will read its value back.</p>

<p>So to create a switch, create the 3 commands above, create a switch sensor using the STATUS command, then create a switch object using the ON &amp; OFF commands and the sensor.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Apr 03, 2013 12:38
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21859573"></a>
                                    <font class="smallfont"><p>Eric - Thanks for explaining the functioning of virtual command. My next question is can I trigger the virtual ON command when I hit the X10 ON command? Can I use Rules to do that function?<br/>
So basically when I turn on a light using X10 (with X10 ON command) the ON virtual command also runs and sets the value to ON. This way the dummy sensor will provide feedback as ON.<br/>
Hope I was able to explain my idea.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by iloveautomation at Apr 03, 2013 16:37
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21859934"></a>
                                    <font class="smallfont"><p>See <a href="http://www.openremote.org/display/forums/Light+switches+in+Cleaning+Mode?focusedCommentId=21859932#comment-21859932">here</a> for an explanation of a similar problem and solution.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Apr 08, 2013 20:03
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22413724"></a>
                                    <font class="smallfont"><p>Dears,</p>

<p>I tried the above In Memory Virtual Commands, but so far I was not succesfull.<br/>
Do I need to enable the "In Memory Virtual Commands" or something?<br/>
I created a Dummy Device with commands ON/OFF/STATUS, linked them to the same Dummy address and made a UI Switch.<br/>
But so far I was not able to toggle the switch in the UI.</p>

<p>Please help!</p>

<p>Thanks,<br/>
Dieter</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dclaeys at May 07, 2013 15:07
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22413814"></a>
                                    <font class="smallfont"><p>Try to get it working step by step.<br/>
Create the 3 commands and the sensor.<br/>
Create 2 buttons for on/off and a label linked to the sensor.<br/>
Does pressing the on/off buttons update the label accordingly ?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at May 08, 2013 09:11
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22413816"></a>
                                    <font class="smallfont">
<p>I tried this yesterday.<br/>
just the 3 commands + the sensor + the switch.<br/>
The label doesn't update accoringly.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dclaeys at May 08, 2013 09:15
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22413913"></a>
                                    <font class="smallfont"><p>Can you post some screen shots of the commands from the designer website? I have been using it extensively and works well for me.<br/>
Make sure you are running the latest version of Openremote.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by iloveautomation at May 08, 2013 20:23
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414141"></a>
                                    <font class="smallfont"><p>Hello,<br/>
So far I made below commands:<br/>
<img src="attachments/21859415/22708276.png" align="absmiddle" border="0"/><br/>
<img src="attachments/21859415/22708275.png" align="absmiddle" border="0"/><br/>
<img src="attachments/21859415/22708278.png" align="absmiddle" border="0"/><br/>
<img src="attachments/21859415/22708277.png" align="absmiddle" border="0"/><br/>
<img src="attachments/21859415/22708279.png" align="absmiddle" border="0"/><br/>
Then I used the switch in my UI.<br/>
but it doesn't toggle...</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dclaeys at May 12, 2013 08:28
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414153"></a>
                                    <font class="smallfont"><p>Try changing the Names to something like "LightOn", "LightOff" and "LightStatus" and do the same for sensor and switch. Try it and provide response.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by iloveautomation at May 12, 2013 12:17
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414195"></a>
                                    <font class="smallfont"><p>Hello Ravi,<br/>
I tried it today.<br/>
It also doesnt work...</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dclaeys at May 13, 2013 12:02
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414196"></a>
                                    <font class="smallfont"><p>This is weird. I have it working with almost exactly the same configuration. The only difference is that I called it <em>Switch1</em>, and as address I use <em>knop</em>. But those differences should not matter.<br/>
I did use PRO designer 1.07 and controller 1.07.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at May 13, 2013 12:22
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414197"></a>
                                    <font class="smallfont"><p>I did test it, re-creating the elements exactly as in your screenshots and it does work for me on iOS console.</p>

<p>Which designer, controller and console (and version) are you using ?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at May 13, 2013 12:42
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414198"></a>
                                    <font class="smallfont"><p>I am working with the Demo version of Designer.<br/>
Could this be the reason?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dclaeys at May 13, 2013 12:42
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414199"></a>
                                    <font class="smallfont"><p>Hello Eric,</p>

<p>I use <a href="https://composer.openremote.org/demo/">https://composer.openremote.org/demo/</a> as designer<br/>
As controller I use the version 2.1.0 (latest version)<br/>
As console I use iPAD running iOS 6.1.3</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dclaeys at May 13, 2013 12:46
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22875330"></a>
                                    <font class="smallfont"><p>Hello to all openremote community</p>

<p>I have exactly the same issue, with the same configuration (Version OpenRemote 2.1 Alpha SNAPSHOT 2013-07-18). The issue appears both on ipad and webconsole, so i think that is not related to the ios app.<br/>
Checking xml-parser log files i can see this lines:</p>

<div style="max-width: 800px;"><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>DEBUG 2013-08-23 08:48:44,271 (XML): A switch sensor (Name = 'testsensor', ID = 231) has an incomplete &lt;state&gt; element mapping, the value attribute is missing in &lt;state name = on/&gt;.
DEBUG 2013-08-23 08:48:44,287 (XML): A switch sensor (Name = 'testsensor', ID = 231) has an incomplete &lt;state&gt; element mapping, the value attribute is missing in &lt;state name = off/&gt;.
DEBUG 2013-08-23 09:13:07,569 (XML): A switch sensor (Name = 'vDoorSensor', ID = 230) has an incomplete &lt;state&gt; element mapping, the value attribute is missing in &lt;state name = on/&gt;.
DEBUG 2013-08-23 09:13:07,569 (XML): A switch sensor (Name = 'vDoorSensor', ID = 230) has an incomplete &lt;state&gt; element mapping, the value attribute is missing in &lt;state name = off/&gt;.
</pre>
</div></div></div>

<p>So i have changed the on/off commands from "teston" to on, and "testoff" to off, and changed the sensor type from switch to custom, mapping the corresponding values. The same with vDoorSensor. Once i have made this changes, the error does not appear again.</p>

<p>Checking again, i saw that the issue persists, but now in the dev.log another issue appears:</p>

<div style="max-width:800px;"><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>2013-08-23 09:44:52,520 WARN [HTTP-Thread-7]: Unknown virtual protocol property '&lt;property name = "name" value = "on"/&gt;'.
2013-08-23 09:44:54,205 WARN [HTTP-Thread-7]: Unknown virtual protocol property '&lt;property name = "name" value = "off"/&gt;'.
2013-08-23 09:44:55,250 WARN [HTTP-Thread-7]: Unknown virtual protocol property '&lt;property name = "name" value = "off"/&gt;'.
</pre>
</div></div></div>

<p>This is the controller.xml, i don´t find any "property name = name", so i don´t know what else do :</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml">
  <span class="code-tag">&lt;components&gt;</span>
    <span class="code-tag">&lt;switch id=<span class="code-quote">"195"</span>&gt;</span>
      <span class="code-tag">&lt;on&gt;</span>
        <span class="code-tag">&lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"221"</span> /&gt;</span>
      <span class="code-tag">&lt;/on&gt;</span>
      <span class="code-tag">&lt;off&gt;</span>
        <span class="code-tag">&lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"222"</span> /&gt;</span>
      <span class="code-tag">&lt;/off&gt;</span>
      <span class="code-tag">&lt;include type=<span class="code-quote">"sensor"</span> ref=<span class="code-quote">"231"</span> /&gt;</span>
    <span class="code-tag">&lt;/switch&gt;</span>
    <span class="code-tag">&lt;button id=<span class="code-quote">"191"</span>&gt;</span>
      <span class="code-tag">&lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"222"</span> /&gt;</span>
    <span class="code-tag">&lt;/button&gt;</span>
    <span class="code-tag">&lt;button id=<span class="code-quote">"189"</span>&gt;</span>
      <span class="code-tag">&lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"221"</span> /&gt;</span>
    <span class="code-tag">&lt;/button&gt;</span>
    <span class="code-tag">&lt;label id=<span class="code-quote">"193"</span>&gt;</span>
      <span class="code-tag">&lt;include type=<span class="code-quote">"sensor"</span> ref=<span class="code-quote">"230"</span> /&gt;</span>
    <span class="code-tag">&lt;/label&gt;</span>
  <span class="code-tag">&lt;/components&gt;</span>
  <span class="code-tag">&lt;sensors&gt;</span>
    <span class="code-tag">&lt;sensor id=<span class="code-quote">"230"</span> name=<span class="code-quote">"test"</span> type=<span class="code-quote">"custom"</span>&gt;</span>
      <span class="code-tag">&lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"223"</span> /&gt;</span>
      <span class="code-tag">&lt;state name=<span class="code-quote">"off"</span> value=<span class="code-quote">"off"</span> /&gt;</span>
      <span class="code-tag">&lt;state name=<span class="code-quote">"on"</span> value=<span class="code-quote">"on"</span> /&gt;</span>
    <span class="code-tag">&lt;/sensor&gt;</span>
    <span class="code-tag">&lt;sensor id=<span class="code-quote">"231"</span> name=<span class="code-quote">"SensorDoor"</span> type=<span class="code-quote">"custom"</span>&gt;</span>
      <span class="code-tag">&lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"223"</span> /&gt;</span>
      <span class="code-tag">&lt;state name=<span class="code-quote">"off"</span> value=<span class="code-quote">"off"</span> /&gt;</span>
      <span class="code-tag">&lt;state name=<span class="code-quote">"on"</span> value=<span class="code-quote">"on"</span> /&gt;</span>
    <span class="code-tag">&lt;/sensor&gt;</span>
  <span class="code-tag">&lt;/sensors&gt;</span>
  <span class="code-tag">&lt;commands&gt;</span>
    <span class="code-tag">&lt;command id=<span class="code-quote">"221"</span> protocol=<span class="code-quote">"virtual"</span>&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"address"</span> value=<span class="code-quote">"yepa"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"command"</span> value=<span class="code-quote">"on"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"name"</span> value=<span class="code-quote">"on"</span> /&gt;</span>
    <span class="code-tag">&lt;/command&gt;</span>
    <span class="code-tag">&lt;command id=<span class="code-quote">"222"</span> protocol=<span class="code-quote">"virtual"</span>&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"address"</span> value=<span class="code-quote">"yepa"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"command"</span> value=<span class="code-quote">"off"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"name"</span> value=<span class="code-quote">"off"</span> /&gt;</span>
    <span class="code-tag">&lt;/command&gt;</span>
    <span class="code-tag">&lt;command id=<span class="code-quote">"223"</span> protocol=<span class="code-quote">"virtual"</span>&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"address"</span> value=<span class="code-quote">"yepa"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"command"</span> value=<span class="code-quote">"status"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"name"</span> value=<span class="code-quote">"status"</span> /&gt;</span>
    <span class="code-tag">&lt;/command&gt;</span>
</pre>
</div></div>

<p>Any help would be appreciated.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by kolsan at Aug 23, 2013 08:53
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22875525"></a>
                                    <font class="smallfont"><p>Hello Again</p>

<p>Somebody could provide me a controller.xml file with virtual commands in order to test in my environment?<br/>
I appreciate too information about the working environment, OS, OpenRemote version,java version...</p>


<p>Thanks in advanced and regards</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by kolsan at Aug 25, 2013 10:51
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22875576"></a>
                                    <font class="smallfont"><p>Hmm, nothing in the above that immediately jumps out as causing an issue. It is strange that it's not working for you.</p>


</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Aug 26, 2013 17:15
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22875589"></a>
                                    <font class="smallfont"><p>Thanks Juha for your answer</p>

<p>Is a java related issue, i was using jdk 1.7. With latest 1.6 jdk version is working fine...</p>

<p>Regards!</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by kolsan at Aug 27, 2013 10:51
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:41</font></td>
		    </tr>
	    </table>
    </body>
</html>