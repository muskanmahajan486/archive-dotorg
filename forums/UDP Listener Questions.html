<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : UDP Listener Questions</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : UDP Listener Questions
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Nov 03, 2013 by <font color="#0050B2">orjo</font>.
				    </div>

				    <p>Hi,</p>

<p>i`m currently working on the implementation of UDPListener Commands to my OR-Setup.<br/>
The final goal is to send UDP-packages from LIRC (after receiving an IR-command over an IR-Dongle) to OR and then send from OR commands to a iTach-device.</p>

<p>But at the moment i`m struggling with the basics.<br/>
I can send UDP-packages from my linux machine to the OR-controller on a specific port. I created a command "Status" with the UDP Listener Protocol on the specific Port. But how can i continue now?</p>

<p>Do i have to create a sensor to catch the package? Which Regex do i have to set (currently .*) and is there a log to check if the UDP-package is received by OR?</p>

<p>Thank you</p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22879300/23036259.png">1_Device.PNG</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22879300/23036260.png">Command_Udp.PNG</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22879300/23036261.png">Sensor_UDP.PNG</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22879300/23036262.png">cusotm_sensor.PNG</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22879300/23036279.png">UDPListener_Command.PNG</a> (image/png)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-22879625"></a>
                                    <font class="smallfont"><p>Nobody here Who can help me to get started with the Udplistener thing?</p>

<p>Thank you</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by orjo at Nov 08, 2013 17:17
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879694"></a>
                                    <font class="smallfont"><p>The initial UDP listener did not update a sensor with the received value. It only set a timestamp if the regex was matched.<br/>
There is a new impl. in one of tha latest snapshots which can filter via regex and update a sensor with the regex match.<br/>
You should see something in the log folder (the newer impl probably logs more then the initial version).</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Nov 10, 2013 22:40
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879722"></a>
                                    <font class="smallfont"><p>Thank you for your answer.<br/>
Can the command which holds the udp listener used in Rules?</p>

<p>So can i Run Another Command when the udp listener receives any Data on the spec. Port by a rule?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by orjo at Nov 11, 2013 17:09
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879735"></a>
                                    <font class="smallfont"><p>Yes, that works</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Nov 11, 2013 22:21
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879979"></a>
                                    <font class="smallfont"><p>Hi,</p>

<p>all my atempts to react on a received UDP_paket don`t work.</p>

<p>I created a UDP-Listener-command and a sensor with this command.<br/>
<img src="attachments/22879300/23036259.png" align="absmiddle" border="0"/><br/>
<img src="attachments/22879300/23036260.png" align="absmiddle" border="0"/><br/>
<img src="attachments/22879300/23036261.png" align="absmiddle" border="0"/></p>

<p>My Rules looks like the following:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"><span class="code-keyword">package</span> org.openremote.controller.protocol;
<span class="code-keyword">import</span> org.openremote.controller.utils.Logger;
<span class="code-keyword">import</span> org.openremote.controller.Constants;


function void log(<span class="code-object">String</span> msg)
{
  Logger.getLogger(Constants.CONTROLLER_ROOT_LOG_CATEGORY + <span class="code-quote">".RuleLog"</span>).info(msg);
}

global org.openremote.controller.statuscache.CommandFacade execute;

rule <span class="code-quote">"LightOn"</span>
when
  $evt : Event(source==<span class="code-quote">"(SENSOR)_IMVC"</span>, value==<span class="code-quote">"on"</span>)
then
   <span class="code-object">System</span>.out.println(<span class="code-quote">"Nothing"</span>);
   log(<span class="code-quote">"rule: LightON - Aktion: Nichts unternehmen"</span>);
   execute.command(<span class="code-quote">"(ON)_REAL"</span>);
end

rule <span class="code-quote">"LightOff"</span>
when
  $evt : Event(source==<span class="code-quote">"(SENSOR)_IMVC"</span>, value==<span class="code-quote">"off"</span>)
then
   <span class="code-object">System</span>.out.println(<span class="code-quote">"LightOff rule"</span>);
   execute.command(<span class="code-quote">"(OFF)_REAL"</span>);
   log(<span class="code-quote">"rule: LightOFF - Aktion: Ausschalten"</span>);
end

rule <span class="code-quote">"UDPListener"</span>
when
  $evt : Event(source==<span class="code-quote">"Statussensor"</span>, value==<span class="code-quote">"Hallo"</span>)
then
   <span class="code-object">System</span>.out.println(<span class="code-quote">"UDP"</span>);
   log(<span class="code-quote">"rule: UDPListener - Aktion: Nichts unternehmen"</span>);
</pre>
</div></div>

<p>The logging is working for the other rules but not for the UDP-Listener Rule. I`ve sent a UDP-package from both, windows and linux client (Data = Hallo) but the log is never written so i think the package is not prcessed by the rule.</p>

<p>Anything which i`ve forgotten or any Ideas which could be wrong?</p>

<p>Thank you.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by orjo at Nov 19, 2013 14:57
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879980"></a>
                                    <font class="smallfont"><p>You should not use a switch sensor but a custom sensor.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Nov 19, 2013 15:03
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879982"></a>
                                    <font class="smallfont"><p>Thank you for the quick reply.<br/>
I created a new custom-sensor.</p>

<p><img src="attachments/22879300/23036262.png" align="absmiddle" border="0"/></p>

<p>There is still nothing written to the log file. I looked to the other logfiles if the udp-paket is received by OR but i can not find any log file which contains data belonging to this sensor.</p>

<p>Is the usage of the regex correct and the value in the rule correct?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by orjo at Nov 19, 2013 15:10
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879985"></a>
                                    <font class="smallfont"><p>Maybe you don't use the version that includes the UDP listener that give the receives data.<br/>
But you should receive the timestamp if your regex matches the data received.<br/>
The rule would never trigger since the value is not "Hallo". Try the rule without the test on the value.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Nov 19, 2013 15:32
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879986"></a>
                                    <font class="smallfont"><p>Check what you receive:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
rule <span class="code-quote">"UDPListener"</span>
when
  $evt : Event(source==<span class="code-quote">"Statussensor"</span>, $v:value)
then
   <span class="code-object">System</span>.out.println(<span class="code-quote">"UDP"</span>);
   log(<span class="code-quote">"rule: UDPListener - Aktion: Nichts unternehmen"</span>+$v.toString());
end
</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Nov 19, 2013 15:43
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879987"></a>
                                    <font class="smallfont"><p>Thank you Marcus,</p>

<p>without a "value" it works.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by orjo at Nov 19, 2013 15:48
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879988"></a>
                                    <font class="smallfont"><p>Michael, very helpful tip for getting into this; Thank you</p>

<p>I receive a timestamp with three more numbers at the end but the first ten are a linux time stamp.</p>

<p>At the moment i don`t need passing the UDP-Data to a Label or something but would this work when using the current Snapshot from 2013-07-18 (OpenRemote 2.1 Alpha SNAPSHOT 2013-07-18 (27.3 MB))</p>

<p>Is there anything to be careful with when updating or can i copy it over my current controller?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by orjo at Nov 19, 2013 15:52
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879991"></a>
                                    <font class="smallfont"><p>FYI</p>

<p>I`ve tried several differnet Controller-versions but there was none which didn`t write me anything other than a timestamp to the log.</p>

<p>Any Information where i can find the right version is welcome.</p>

<p>Thank you</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by orjo at Nov 19, 2013 18:11
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879993"></a>
                                    <font class="smallfont"><p>I asked Juha who merged the contribution and will let you know.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Nov 19, 2013 19:07
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879998"></a>
                                    <font class="smallfont"><p>Can you please try this binary <a href="https://dl.dropboxusercontent.com/u/2892838/OpenRemote-Controller-2.1.0_ORCJAVA-348.zip">https://dl.dropboxusercontent.com/u/2892838/OpenRemote-Controller-2.1.0_ORCJAVA-348.zip</a> and let us know what it does?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Nov 19, 2013 20:21
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879999"></a>
                                    <font class="smallfont"><p>Hi Johannes,</p>

<p>The patch (and the patch for the patch) can be found in this thread: <a href="Forwarding match in UDPListener.html" title="Forwarding match in UDPListener">Forwarding match in UDPListener</a>.</p>

<p>There's no pre-compiled binary available for download yet.</p>

<p>&#8211; Juha</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Nov 19, 2013 20:28
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880002"></a>
                                    <font class="smallfont"><p>My binary above contains this patch already, however I haven't tested it yet.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Nov 19, 2013 20:45
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880003"></a>
                                    <font class="smallfont"><p>Michal,</p>

<p>your version tells me to link the controller to my designer account ant that my credentials are wrong.</p>

<p>And Sorry, i don`t know how to install the patch. Any Instructions on this?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by orjo at Nov 19, 2013 20:48
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880005"></a>
                                    <font class="smallfont"><p>Sorry it is the pro designer version. Just give me a few minutes and I'll make a free designer version.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Nov 19, 2013 21:01
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880007"></a>
                                    <font class="smallfont"><p>Free designer version of UDPlistener with regex <a href="https://dl.dropboxusercontent.com/u/2892838/OpenRemote-Controller-2.1.0_SNAPSHOT-2013-06-17.zip">https://dl.dropboxusercontent.com/u/2892838/OpenRemote-Controller-2.1.0_SNAPSHOT-2013-06-17.zip</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Nov 19, 2013 21:08
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880022"></a>
                                    <font class="smallfont"><p>Michal,</p>

<p>i deployed the Controller from your previous post but when i want to sync it with my designer account i get the error "An attemp was made to access service context before it was initialized".</p>

<p>I tried different solutions found on the OR-forum but nothing helped.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
---- Logging ----------------------------------------------------------

 Console (stdout) threshold [CONTROLLER_CONSOLE_THRESHOLD]: INFO

 <span class="code-object">System</span> logs:

   - Controller startup log [CONTROLLER_STARTUP_LOG_LEVEL]: DEBUG


-----------------------------------------------------------------------
20.11.2013 12:39:48 org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: /opt/openremote/or2/webapps/controller/WEB-INF/lib/<span class="code-keyword">native</span>
20.11.2013 12:39:48 org.apache.coyote.http11.Http11Protocol init
INFO: Initializing Coyote HTTP/1.1 on http-8080
20.11.2013 12:39:48 org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 951 ms
20.11.2013 12:39:48 org.apache.catalina.core.StandardService start
INFO: Starting service Catalina
20.11.2013 12:39:48 org.apache.catalina.core.StandardEngine start
INFO: Starting Servlet Engine: Apache Tomcat/6.0.18
20.11.2013 12:39:48 org.apache.catalina.startup.HostConfig deployWAR
INFO: Deploying web application archive webconsole.war
20.11.2013 12:39:49 org.apache.catalina.loader.WebappClassLoader validateJarFile
INFO: validateJarFile(/opt/openremote/or2/webapps/controller/WEB-INF/lib/servlet-api.jar) - jar not loaded. See Servlet Spec 2.3, section 9.7.2. Offending class: javax/servlet/Servlet.class
20.11.2013 12:39:50 org.openremote.controller.bootstrap.Startup redirectJULtoLog4j
INFO: Initialized JUL to LOG4J Redirector.


=============================================================================

 Application initialization failed:
 Cannot find class [org.openremote.controller.MarantzAVRConfig] <span class="code-keyword">for</span> bean with name 'marantzAVRConfig' defined in class path resource [applicationContext.xml]; nested exception is java.lang.ClassNotFoundException: org.openremote.controller.MarantzAVRConfig

=============================================================================


org.springframework.beans.factory.CannotLoadBeanClassException: Cannot find class [org.openremote.controller.MarantzAVRConfig] <span class="code-keyword">for</span> bean with name 'marantzAVRConfig' defined in class path resource [applicationContext.xml]; nested exception is java.lang.ClassNotFoundException: org.openremote.controller.MarantzAVRConfig
Caused by: java.lang.ClassNotFoundException: org.openremote.controller.MarantzAVRConfig
        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1387)
        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1233)
        at org.springframework.util.ClassUtils.forName(ClassUtils.java:177)
        at org.springframework.beans.factory.support.AbstractBeanDefinition.resolveBeanClass(AbstractBeanDefinition.java:313)
        at org.springframework.beans.factory.support.AbstractBeanFactory.resolveBeanClass(AbstractBeanFactory.java:912)
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanNamesForType(DefaultListableBeanFactory.java:165)
        at org.springframework.context.support.AbstractApplicationContext.getBeanNamesForType(AbstractApplicationContext.java:687)
        at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:397)
        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:330)
        at org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:92)
        at org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:77)
        at org.openremote.controller.spring.SpringContext.&lt;init&gt;(SpringContext.java:74)
        at org.openremote.controller.spring.SpringContext.&lt;init&gt;(SpringContext.java:69)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:532)
        at java.lang.<span class="code-object">Class</span>.newInstance0(<span class="code-object">Class</span>.java:374)
        at java.lang.<span class="code-object">Class</span>.newInstance(<span class="code-object">Class</span>.java:327)
        at org.openremote.controller.bootstrap.Startup.loadServiceContext(Startup.java:81)
        at org.openremote.controller.bootstrap.servlet.ServletStartup.initializeServiceContext(ServletStartup.java:190)
        at org.openremote.controller.bootstrap.servlet.ServletStartup.contextInitialized(ServletStartup.java:109)
        at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:3843)
        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4342)
        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:791)
        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:771)
        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:525)
        at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:926)
        at org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:889)
        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:492)
        at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1149)
        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:311)
        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)
        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
        at org.apache.catalina.core.StandardHost.start(StandardHost.java:719)
        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
        at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
        at org.apache.catalina.core.StandardService.start(StandardService.java:516)
        at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)
        at org.apache.catalina.startup.Catalina.start(Catalina.java:578)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)
        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)
20.11.2013 12:39:51 org.apache.coyote.http11.Http11Protocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
20.11.2013 12:39:51 org.apache.catalina.startup.Catalina start
INFO: Server startup in 2980 ms
ERROR 2013-11-20 12:39:58,114 : Synchronizing controller with online account failed : An attempt was made to access service context before it was initialized.
java.lang.IllegalStateException: An attempt was made to access service context before it was initialized.
        at org.openremote.controller.service.ServiceContext.getInstance(ServiceContext.java:297)
        at org.openremote.controller.service.ServiceContext.getDeployer(ServiceContext.java:202)
        at org.openremote.controller.action.ConfigManageController.syncOnline(ConfigManageController.java:140)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at org.springframework.web.servlet.mvc.multiaction.MultiActionController.invokeNamedMethod(MultiActionController.java:434)
        at org.springframework.web.servlet.mvc.multiaction.MultiActionController.handleRequestInternal(MultiActionController.java:372)
        at org.springframework.web.servlet.mvc.AbstractController.handleRequest(AbstractController.java:153)
        at org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:45)
        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:806)
        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:736)
        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:396)
        at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:360)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.openremote.controller.<span class="code-keyword">rest</span>.support.json.JSONCallbackFilter.doFilter(JSONCallbackFilter.java:63)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:78)
        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:77)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
        at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:354)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1146)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.<span class="code-object">Thread</span>.run(<span class="code-object">Thread</span>.java:679)
ERROR [HTTP-<span class="code-object">Thread</span>-1]: Synchronizing controller with online account failed : An attempt was made to access service context before it was initialized.
java.lang.IllegalStateException: An attempt was made to access service context before it was initialized.
        at org.openremote.controller.service.ServiceContext.getInstance(ServiceContext.java:297)
        at org.openremote.controller.service.ServiceContext.getDeployer(ServiceContext.java:202)
        at org.openremote.controller.action.ConfigManageController.syncOnline(ConfigManageController.java:140)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at org.springframework.web.servlet.mvc.multiaction.MultiActionController.invokeNamedMethod(MultiActionController.java:434)
        at org.springframework.web.servlet.mvc.multiaction.MultiActionController.handleRequestInternal(MultiActionController.java:372)
        at org.springframework.web.servlet.mvc.AbstractController.handleRequest(AbstractController.java:153)
        at org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:45)
        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:806)
        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:736)
        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:396)
        at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:360)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.openremote.controller.<span class="code-keyword">rest</span>.support.json.JSONCallbackFilter.doFilter(JSONCallbackFilter.java:63)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:78)
        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:77)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
        at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:354)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1146)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.<span class="code-object">Thread</span>.run(<span class="code-object">Thread</span>.java:679)
</pre>
</div></div>

<p>Any Ideas on this?<br/>
Thank you in advance</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by orjo at Nov 20, 2013 11:43
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880023"></a>
                                    <font class="smallfont"><p>The problem is:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
Cannot find class [org.openremote.controller.MarantzAVRConfig] <span class="code-keyword">for</span> bean with name 'marantzAVRConfig' defined in class path resource [applicationContext.xml]; nested exception is java.lang.ClassNotFoundException: org.openremote.controller.MarantzAVRConfig
</pre>
</div></div>
<p>Perhaps it has to do with the designer? Are you using the standard demo designer or the preview <a href="https://composer.openremote.org/preview/">https://composer.openremote.org/preview/</a> ?<br/>
You can also try to edit applicationContext.xml with text editor and remove reference to marantzAVRConfig.</p>

<p>Perhaps someone else with in deep understanding of configs and designers can help you further?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Nov 20, 2013 12:15
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880026"></a>
                                    <font class="smallfont"><p>I guess there has been some merge issue or something but there is an mismatch in the different files that have been used to build that controller.</p>

<p>I did download the above zip and looking the applicationContext.xml, I see indeed that there are references to the Marantz protocol classes (gateway, config and command builder) but looking in WEB-INF/classes, I can see that the classes are not present.</p>

<p>applicationContext.xml is the standard XML configuration for Spring. It defines the beans that are instantiated, how they are injected into each other, ...</p>

<p>So if Marantz classes are referenced in there, Spring will try to instantiate them and as the classes are not present, this will fail.</p>

<p>For the specific issue above, solution is to remove all references from Marantz classes from applicationContext.xml (as I take it that you're not interested in the Marantz protocol but in UDP Listener).</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Nov 20, 2013 15:11
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880028"></a>
                                    <font class="smallfont"><p>Yeah, I know how it comes, I've copied applicationContext.xml from my pro branch just to make fast the demo branch. Probably it would also work if Johannes simply overwrite applicationContext.xml with the one from other build.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Nov 20, 2013 17:18
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880263"></a>
                                    <font class="smallfont"><p>First off all, thank you for all the help.<br/>
I appreciate that.</p>

<p>Sorry for my late answer. The status is the following:</p>

<p>I`ve copied the applicationContext.xml from my productive controller to the one from michal. I`m now able to sync it with my !DEMO!-Designer-Account.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">sudo sendip -p ipv4 -is 192.168.132.2 -p udp -us 5070 -ud 47855 -d <span class="code-quote">"PENETRATION"</span> -v 192.168.132.2</pre>
</div></div>

<p>results in the following output in the log/rules/drools.log file:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">DEBUG 2013-11-24 19:17:58,062 (Drools): Rule Activation Imminent:
        rule <span class="code-quote">"UDP Penetration"</span> <span class="code-comment">// (<span class="code-keyword">package</span> org.openremote.controller.protocol)
</span>        Declarations
                Declaration: <span class="code-quote">"$evt"</span>
                Value:
                        Sensor Name: <span class="code-quote">"UDPL_PENETRATION_SENSOR"</span>
                        Sensor Value: <span class="code-quote">"1385317078060"</span>
                Declaration: <span class="code-quote">"$v"</span>
                Value:
                        Custom declarative value
        LHS objects(antecedents)
                <span class="code-object">Class</span>: <span class="code-quote">"CustomState"</span>
                Fields:
                        Event Name:     <span class="code-quote">"UDPL_PENETRATION_SENSOR"</span>
                        Event Value:    <span class="code-quote">"1385317078060"</span>

INFO 2013-11-24 19:17:58,063 (Drools): rule: UDP Penetration Test</pre>
</div></div>

<p>So it`s still not possible to forward the "REGEX-MATCH", right?</p>

<p>@Michal<br/>
I recognized that in your version of the controller there is a rule log file written (logs/rules/drools.log)<br/>
Where can this be configured? I really want to use this in my production controller.</p>

<p>Thank you.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by orjo at Nov 24, 2013 18:29
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880267"></a>
                                    <font class="smallfont"><p>The log file is of course configured in the /opt/OpenRemote-Controller/webapps/controller/WEB-INF/classes/log4j.properties file.<br/>
However, my controller implements the new rules listener code developed by Isaac Martin which is not available yet in other builds.<br/>
I have no idea when it will be included in the regular controller distribution. More about it is in this thread <a href="http://www.openremote.org/display/forums/Drools+rule+activation+feedback">http://www.openremote.org/display/forums/Drools+rule+activation+feedback</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Nov 24, 2013 21:38
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880353"></a>
                                    <font class="smallfont"><p>Do you think there`s a chance of getting the Regex-Match to the rules?<br/>
Otherwise i will have to create a Sensor and a rule for each of the commands which i want to send from my IR-remote to OR.</p>

<p>This would mean a huge Rules file and a lot of work.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by orjo at Nov 26, 2013 17:12
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880355"></a>
                                    <font class="smallfont"><p>I will look at the UDP stuff this week and try to make a documentation. I will look at the latest code and see what I can do.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Nov 26, 2013 18:34
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880356"></a>
                                    <font class="smallfont"><p>Thank you in advance</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by orjo at Nov 26, 2013 18:40
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880368"></a>
                                    <font class="smallfont"><p>The listener would return a match if it is grouped. Please add grouping - i.e. if you want to match Hello and return Hello then your regex should be (Hello), if you want to match any string and return it instead of timestamp the regex should be (.*) </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Nov 26, 2013 23:46
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880600"></a>
                                    <font class="smallfont"><p>I don't know which version Michal's controller includes but the UDPListener with this code</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
<span class="code-keyword">if</span> (matcher.find()) {
  <span class="code-keyword">if</span> (matcher.groupCount() &gt; 0) {
    sensor.update(matcher.group(1));
  } <span class="code-keyword">else</span> {
    sensor.update("" + <span class="code-object">System</span>.currentTimeMillis());
  }
}
</pre>
</div></div>
<p>and the correct regex returns the complete string received via UDP. I just tested this with my irtrans device.<br/>
If you link this to a custom sensor you will be able to access the regex match from the rules.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 02, 2013 22:15
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880623"></a>
                                    <font class="smallfont"><p>I've included exactly this piece of code. IMHO, the problem which Johannes has is that he does not use grouping parenthesis in his regex therefore the matcher.groupCount() is 0.<br/>
In other words, instead of regex</p>

<p>(Hallo) he uses Hallo</p>

<p>This way the above code after matching returns still the timestamp.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Dec 03, 2013 09:10
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22880678"></a>
                                    <font class="smallfont"><p>When using (.*) as the regex pattern it works perfect.<br/>
Thank you for all of your investigation.</p>

<p>Johannes</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by orjo at Dec 04, 2013 20:53
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22881812"></a>
                                    <font class="smallfont"><p>Michal said:</p>
<blockquote><p>However, my controller implements the new rules listener code developed by Isaac Martin which is not available yet in other builds.<br/>
I have no idea when it will be included in the regular controller distribution.</p></blockquote>
<p>Would be good to know if this is on "the" list at all. I did look into <a href="http://jira.openremote.org">http://jira.openremote.org</a>. I did not find a related issue there yet.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Dec 28, 2013 10:01
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22881814"></a>
                                    <font class="smallfont"><p>Michal,</p>

<blockquote><p>Can you please try this binary <a href="https://dl.dropboxusercontent.com/u/2892838/OpenRemote-Controller-2.1.0_ORCJAVA-348.zip">https://dl.dropboxusercontent.com/u/2892838/OpenRemote-Controller-2.1.0_ORCJAVA-348.zip</a> </p></blockquote>

<p>Does this still contain the latest version of UDPlistener and Rule logger for the PRO version? </p>

<p>I intend to do some experiments to get devices statuses from RaZberry pushed via UPD.</p>

<p>Pieter</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Dec 28, 2013 10:17
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22881830"></a>
                                    <font class="smallfont"><blockquote>
<p>Does this still contain the latest version of UDPlistener and Rule logger for the PRO version?</p></blockquote>

<p>Yes, it does.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Dec 28, 2013 23:46
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22888126"></a>
                                    <font class="smallfont"><p>Michal said:</p>
<blockquote><p>I have no idea when it will be included in the regular controller distribution. <br/>
More about it is in this thread <a href="http://www.openremote.org/display/forums/Drools+rule+activation+feedback">http://www.openremote.org/display/forums/Drools+rule+activation+feedback</a></p></blockquote>

<p>Judging from the only minor updates in recent releases, and those planned for PRO .14 and .15, I fear that many of the<br/>
recent community contributions will never be included.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Aug 20, 2014 14:23
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22888128"></a>
                                    <font class="smallfont"><blockquote><p>Difficult to see. Always in motion is the future.</p></blockquote>


<p>The UDPListener regexp change is part of Controller Pro 1.0.13<br/>
The rules logger is on the radar.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Aug 20, 2014 19:15
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22888344"></a>
                                    <font class="smallfont"><p>First off, many thanks to the creators and contributors to OpenRemote.</p>

<p><b>Background/Context</b><br/>
Having recently acquired an X10 CM15a (USB interface with read/write) I wanted to use it to capture the output of sensors. <br/>
Adding mochad to the Linux host enabled the X10 events to be posted to TCP as messages:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
user@host:/apps/3rdParty$ nc localhost 1099
  08/29 18:15:01 Rx RF HouseUnit: B3 Func: On
  08/29 18:15:01 Tx PL HouseUnit: B3
  08/29 18:15:01 Tx PL House: B Func: On
  08/29 18:15:01 Rx PL HouseUnit: B3
  08/29 18:15:02 Rx PL House: B Func: On
</pre>
</div></div>
<p>But this is TCP and I needed UDP for UDPListener </p>

<p>Fortunately Linux and netcat enables the TCP output to be piped to a UDP socket for the OpenRemote UDPListener</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
user@host: nc localhost 1099 | nc -u localhost 1199
</pre>
</div></div>
<p>resulting in the TCP messages now appearing in UDP on a different port</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
user@host:/apps/3rdParty$ nc -u -l localhost 1199
 08/29 18:19:38 Rx RF HouseUnit: B3 Func: On
 08/29 18:19:38 Tx PL HouseUnit: B3
 08/29 18:19:38 Tx PL House: B Func: On
 08/29 18:19:38 Rx PL HouseUnit: B3
 08/29 18:19:39 Rx PL House: B Func: On
</pre>
</div></div>
<p>Great! So I grabbed:  OpenRemote-Controller-2.1.0_FM_ORCJAVA-392-2</p>

<p>Now UDPListener should pick up the messages and using Drool rules I can parse the message.<br/>
Here is the rule for simply printing the messages:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
rule <span class="code-quote">"UDPListener"</span>
when
  $evt : Event(source==<span class="code-quote">"StatusSensor"</span>, $v:value)
then
   <span class="code-object">System</span>.out.println(<span class="code-quote">"UDP Listener value: "</span> + $v.toString());
   log(<span class="code-quote">"rule: UDPListener - Action: Chime me "</span> + $v.toString());
end
</pre>
</div></div>
<p>Or so I thought...</p>

<p>I enabled debug messages and the logfile for OpenRemote shows the following console output:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
UDP Listener value: 1409350605704
UDP Listener value: 1409350606120
</pre>
</div></div>

<p>The output in logs/dev/dev.log (udp.log is empty) shows:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
 2014-08-29 18:16:45,704 TRACE [UDPListener Port: 1199]: Processed '1409350605704', received '1409350605704'
 2014-08-29 18:16:45,704 INFO [UDPListener Port: 1199]: rule: UDPListener - Action: Chime me 1409350605704
 2014-08-29 18:16:46,120 TRACE [UDPListener Port: 1199]: Processed '1409350606120', received '1409350606120'
 2014-08-29 18:16:46,120 INFO [UDPListener Port: 1199]: rule: UDPListener - Action: Chime me 1409350606120
</pre>
</div></div>

<p><b>Question</b><br/>
Why does UDPListener show a numeric value coming from socket 1199 (e.g. 1409350605704)<br/>
when netcat shows the human readable string (08/29 18:19:38 Rx RF HouseUnit: B3 Func: On)?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by devodl at Aug 29, 2014 23:32
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22888355"></a>
                                    <font class="smallfont"><p>The first version of UDP Listener only gave a timestamp when a regex was met. <br/>
There is another version where a regex can be used to extract the real received value.<br/>
Look through the forum thread, it should be explained here.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Aug 30, 2014 20:24
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22888511"></a>
                                    <font class="smallfont"><p>Thanks for the reply.</p>

<p>I've tried these builds:<br/>
  OpenRemote-Controller-2.1.0_FM_ORCJAVA-392-2.zip<br/>
  OpenRemote-Controller-2.1.0_FM_SNAPSHOT-20130212-Lagarto.zip<br/>
  OpenRemote-Controller-2.1.0_FM-X10Events.zip<br/>
but none of them seem to contain the UDPListener that prints out the actual data message.</p>

<p>I also tried a build referenced in this thread OpenRemote-Controller-2.1.0_SNAPSHOT-2013-06-17.zip<br/>
but at startup it produces:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
Application initialization failed: 
 Cannot find class [org.openremote.controller.AMXNIConfig] <span class="code-keyword">for</span> bean with name 'AMXNIConfig' defined in class path resource [applicationContext.xml]; nested exception is java.lang.ClassNotFoundException: org.openremote.controller.AMXNIConfig
=============================================================================
org.springframework.beans.factory.CannotLoadBeanClassException: Cannot find class [org.openremote.controller.AMXNIConfig] <span class="code-keyword">for</span> bean with name 'AMXNIConfig' defined in class path resource [applicationContext.xml]; nested exception is java.lang.ClassNotFoundException: org.openremote.controller.AMXNIConfig
Caused by: java.lang.ClassNotFoundException: org.openremote.controller.AMXNIConfig
</pre>
</div></div>

<p>and when I attempt to sync the Controller it produces:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
ERROR 2014-09-04 21:29:08,188 : Synchronizing controller with online account failed : An attempt was made to access service context before it was initialized.
java.lang.IllegalStateException: An attempt was made to access service context before it was initialized.
</pre>
</div></div>

<p>Can someone point me to a build that has the UDPListener that produces the data messages?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by devodl at Sep 05, 2014 02:34
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22888515"></a>
                                    <font class="smallfont">
<p>The tag at <a href="http://svn.code.sf.net/p/openremote/code/tags/project/Controller/Controller_ProInstaller_1_0_13_20140505/">http://svn.code.sf.net/p/openremote/code/tags/project/Controller/Controller_ProInstaller_1_0_13_20140505/</a> contains it, but you'll need to build it yourself. Don't know if any binaries exist yet.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Sep 05, 2014 08:27
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22888518"></a>
                                    <font class="smallfont"><p>Thanks.<br/>
The project is in eclipse and I followed this page: 
<a href="http://www.openremote.org/display/docs/Eclipse+Project+Setup+Instructions">http://www.openremote.org/display/docs/Eclipse+Project+Setup+Instructions</a><br/>
to setup.</p>

<p>It can't resolve servlet.jar When I add Apache Tomcat library it resolves but I can't add a Tomcat server.<br/>
When I run the project it use jetty so I'm not sure how to resolve, configure and run.</p>

<p>Should I just build a war and deploy to a local server?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by devodl at Sep 05, 2014 11:30
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:43</font></td>
		    </tr>
	    </table>
    </body>
</html>