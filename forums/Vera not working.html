<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Vera not working</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Vera not working
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Apr 10, 2014 by <font color="#0050B2">ckbsmart</font>.
				    </div>

				    <p>I am running a OpenRemote-Controller-Pro1.0.12 on a WINDOWS 7 64bit machine with Java 1.6.0_45. I used to run a free version but I decided to switch because I thought Vera integration is no longer available for testing. </p>

<p>With the free version everything worked fine until few days back when I started to get th following error:</p>

<p>ERROR HTTP\-Thread\-1: Error executing command '/6/click' : Vera client is not s<br/>
tarted<br/>
org.openremote.controller.exception.NoSuchCommandException: Vera client is not s<br/>
tarted<br/>
        at org.openremote.controller.protocol.vera.VeraCommandBuilder.build(Unkn<br/>
own Source)<br/>
        at org.openremote.controller.command.CommandFactory.getCommand(Unknown S<br/>
ource)<br/>
        at org.openremote.controller.component.control.button.ButtonBuilder.buil<br/>
d(Unknown Source)<br/>
        at org.openremote.controller.component.ComponentFactory.getComponent(Unk<br/>
nown Source)<br/>
        at org.openremote.controller.service.impl.ControlCommandServiceImpl.getC<br/>
ontrol(Unknown Source)<br/>
        at org.openremote.controller.service.impl.ControlCommandServiceImpl.trig<br/>
ger(Unknown Source)<br/>
        at org.openremote.controller.rest.ControlCommandRESTServlet.handleReques<br/>
t(Unknown Source)<br/>
        at org.openremote.controller.rest.RESTAPI.doPost(Unknown Source)<br/>
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)<br/>
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)<br/>
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Appl<br/>
icationFilterChain.java:290)<br/>
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationF<br/>
ilterChain.java:206)<br/>
        at org.openremote.controller.rest.support.json.JSONCallbackFilter.doFilt<br/>
er(Unknown Source)<br/>
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Appl<br/>
icationFilterChain.java:235)<br/>
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationF<br/>
ilterChain.java:206)<br/>
        at org.springframework.web.filter.CharacterEncodingFilter.doFilterIntern<br/>
al(CharacterEncodingFilter.java:78)<br/>
        at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerR<br/>
equestFilter.java:77)<br/>
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Appl<br/>
icationFilterChain.java:235)<br/>
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationF<br/>
ilterChain.java:206)<br/>
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperV<br/>
alve.java:233)<br/>
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextV<br/>
alve.java:191)<br/>
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.j<br/>
ava:128)<br/>
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.j<br/>
ava:102)<br/>
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineVal<br/>
ve.java:109)<br/>
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.jav<br/>
a:286)<br/>
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java<br/>
:845)<br/>
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.proce<br/>
ss(Http11Protocol.java:583)<br/>
        at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoin<br/>
t.java:354)<br/>
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExec<br/>
utor.java:895)<br/>
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor<br/>
.java:918)<br/>
        at java.lang.Thread.run(Thread.java:662)</p>

<p>At the time I blamed the free version for the error. After buying the Pro version and installed it I saw that I get the same error.</p>

<p>What can I do?</p>

<p>Best regards,<br/>
Cristina Chira</p>

				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-22885836"></a>
                                    <font class="smallfont"><p>Do you see an error message like "Could not start VeraClient: ...." in the vera log (&lt;OpenRemote Controller&gt;/logs/vera/vera.log ? <br/>
Is your Vera configuration OK (OpenRemote Designer &gt; Config for Controller &gt; vera &gt; vera.address: &lt;IP Address&gt;) ?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by rhitz at Apr 11, 2014 08:42
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885837"></a>
                                    <font class="smallfont"><p>Yes I do see that error. Vera worked until few days back and has the same configurations(ip) set as it did before. I just run OP and saw that nothing was working and I got the error while pressing the button that the command is not found. I even tried from running the OR from another Pc and the same error. I have Vera 3 with UI5, no upgrade or change was performed on my side. I set the ip to: 192.168.1.164 as I use to access Vera from browser.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ckbsmart at Apr 11, 2014 10:54
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885842"></a>
                                    <font class="smallfont"><p>The Vera protocol implementation loads a configuration XML from the Vera controller at start time. You could try to load this XML manually in order to test the communication with the Vera controller. Open your web browser (e.g. Chrome) and insert the following URL:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
http:<span class="code-comment">//&lt;Vera controller IP address&gt;:3480/data_request?id=lu_sdata&amp;output_format=xml</span>
</pre>
</div></div>
<p>Does the browser load the XML ?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by rhitz at Apr 11, 2014 20:35
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885871"></a>
                                    <font class="smallfont"><p>Yes if i use <a href="http://IP:3480/data_request?id=status&amp;output_format=xml">http://IP:3480/data_request?id=status&amp;output_format=xml</a> the browser returns the XML.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ckbsmart at Apr 14, 2014 13:42
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885873"></a>
                                    <font class="smallfont"><p>I am not sure what happened now, but Vera started to communicate again with OR. I did not do anything so, I did not change anything.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ckbsmart at Apr 14, 2014 13:49
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885878"></a>
                                    <font class="smallfont"><p>As I've mentioned the Vera protocol implementation tries to load a configuration XML from the Vera controller at startup time of the controller. It tries to load the XML only once (at startup time), and if it fails the Z-Wave commands do not work. There is no polling. That means if you start the OpenRemote controller, the Vera controller should also be started. It doesn't help to start the Vera controller afterwards. Maybe the problem is gone because you've restarted the OpenRemote controller.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by rhitz at Apr 14, 2014 16:17
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887609"></a>
                                    <font class="smallfont"><p>I'm trying to setup my Vera Controller with OR but I'm getting the following error:</p>

<p>ERROR main: Could not parse Vera status file. Vera protocol is not started<br/>
java.lang.NumberFormatException: For input string: "33.0"<br/>
	at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)<br/>
	at java.lang.Integer.parseInt(Integer.java:458)<br/>
	at java.lang.Integer.parseInt(Integer.java:499)<br/>
etc etc etc</p>

<p>So I enabled debugging for veru and looked at the very log file and this what I've found:</p>

<p>DEBUG 2014-07-17 21:31:21,717 (Vera): Vera device - GenericDevice- with id: 24 and category: Unknown created.<br/>
DEBUG 2014-07-17 21:31:21,717 (Vera): Vera device - Dimmer- with id: 29 and category: DimmableLight created.<br/>
DEBUG 2014-07-17 21:31:21,718 (Vera): Vera device - TemperatureSensor- with id: 39 and category: TemperatureSensor created.<br/>
DEBUG 2014-07-17 21:31:21,718 (Vera): Vera device - GenericDevice- with id: 38 and category: Unknown created.<br/>
DEBUG 2014-07-17 21:31:21,718 (Vera): Vera device - GenericDevice- with id: 55 and category: Unknown created.<br/>
DEBUG 2014-07-17 21:31:21,718 (Vera): Vera device - GenericDevice- with id: 56 and category: Unknown created.<br/>
ERROR 2014-07-17 21:31:21,724 (Vera): Could not parse Vera status file. Vera protocol is not started<br/>
java.lang.NumberFormatException: For input string: "33.0"<br/>
	at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)<br/>
	at java.lang.Integer.parseInt(Integer.java:458)<br/>
	at java.lang.Integer.parseInt(Integer.java:499)</p>

<p>OR throws the error at same place every time I start the OR service which is at the end vera last device from the &lt;devices&gt;&lt;/devices&gt; returned by (<a href="http://xx.xx.xx.xx:3480/data_request?id=lu_sdata&amp;output_format=xml">http://xx.xx.xx.xx:3480/data_request?id=lu_sdata&amp;output_format=xml</a>)</p>

<p>Can anyone shed some light as of why this is happening and how can I correct this behavior?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ronluna at Jul 18, 2014 03:04
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23599339"></a>
                                    <font class="smallfont"><p>did u ever find answer to this problem.<br/>
I never get a single reply from OR community ever so far - its so funny not sure if anything wrong with my nick <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by gdhiraj2015 at May 28, 2015 09:57
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:39</font></td>
		    </tr>
	    </table>
    </body>
</html>