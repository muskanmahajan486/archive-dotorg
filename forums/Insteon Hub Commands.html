<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Insteon Hub Commands</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Insteon Hub Commands
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jan 04, 2014 by <font color="#0050B2">pjmm</font>.
				    </div>

				    <p>I set up the Insteon Hub using HouseLinc  which can be downloaded from Insteon web site.</p>

<p>I configured the hub and  units using this program.</p>

<p>I set a fixed IP address for the hub using a DHCP server</p>

<p>I did not set a User or Password </p>

<p>I was then able to control the devices using HTTP Protocol under Open Remote and the GET Method</p>

<p>To control Insteon Unit with address of 21.A8.A8</p>

<p>The following commands were entered into URL</p>

<p>To turn the unit On</p>

<p><a href="http://Hub">http://Hub</a> IP:25105/3?026221A8A80F11FF=I=3-</p>

<p>21A8A8 Unit Address</p>

<p>0262  Direct Command Flag</p>

<p>OF  SD Flag Standard Command</p>

<p>11 Command (11=ON)</p>

<p>FF =level   (FF=100%)</p>

<p>=I=3   Number of re transmits</p>

<p>To Turn the Unit Off</p>

<p><a href="http://Hub">http://Hub</a> IP:25105/3?026221A8A80F13FF=I=3-</p>

<p>13 Command (13=Off)</p>



<p>Getting Device Status involves having to make a couple URL calls </p>

<p><a href="http://Hub">http://Hub</a> IP:25105/3?026221A8A90F19FF=I=3-</p>

<p>19 Command (19=Status)</p>

<p><a href="http://192.168.1.30:25105/buffstatus.xml">http://192.168.1.30:25105/buffstatus.xml</a></p>

<p>This returns </p>

<p>ON </p>

<p>&lt;response&gt;&lt;BS&gt;026221A2A90F19FF06025021A2A925DC0B2F0001000000000000000000000000000000000000000000000000000000000000&lt;/BS&gt;&lt;/response&gt;</p>

<p>Off</p>

<p>&lt;response&gt;&lt;BS&gt;026221A2A90F19FF06025021A2A925DC0B2F0001000000000000000000000000000000000000000000000000000000000000&lt;/BS&gt;&lt;/response&gt;</p>


<p>It is also possible to send X10 commands</p>

<p>X10 ddressM15</p>

<p>off</p>

<p><a href="http://Hub">http://Hub</a> Ip:25105/3?02630400=I=3</p>

<p><a href="http://Hub">http://Hub</a> Ip:25105/3?02630380=I=3</p>



<p>On</p>

<p><a href="http://Hub">http://Hub</a> IP:25105/3?02630400=I=3</p>

<p><a href="http://Hub">http://Hub</a> IP:25105/3?02630280=I=3</p>


<p>The following Web Page has a lot of good information regarding controlling Insteon Devices</p>

<p><a href="http://www.leftovercode.info/">http://www.leftovercode.info/</a></p>


<p>If any one familiar with Regex could help me extracting On and Off from these 2 strings I would be grateful.</p>

<p>ON </p>

<p>&lt;response&gt;&lt;BS&gt;026221A2A90F19FF06025021A2A925DC0B2F0001000000000000000000000000000000000000000000000000000000000000&lt;/BS&gt;&lt;/response&gt;</p>

<p>Off</p>

<p>&lt;response&gt;&lt;BS&gt;026221A2A90F19FF06025021A2A925DC0B2F0001000000000000000000000000000000000000000000000000000000000000&lt;/BS&gt;&lt;/response&gt;</p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22882151/23036474.doc">Insteon-Hub.doc</a> (application/octet-stream)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22882151/23036475.pdf">Insteon-Hub.pdf</a> (application/pdf)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22882151/23036480.pdf">InsteonHub.pdf</a> (application/pdf)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-22883755"></a>
                                    <font class="smallfont"><p>This link may help you:
<a href="http://www.leftovercode.info/smartlinc.html">http://www.leftovercode.info/smartlinc.html</a><br/>
you may also investigate using a direct tcp connection and port 9761.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by 3gem at Jan 31, 2014 22:56
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22883783"></a>
                                    <font class="smallfont"><p>Many thanks for that info I have already found this page<br/>
most helpful</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pjmm at Feb 01, 2014 19:37
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22884053"></a>
                                    <font class="smallfont"><p>The first 16 characters in the response are the last command sent to the controller the 06 represents a success the rest starting with 0250 will give the current status from the last command. Just from a glance it looks like both responses are from an off command. Here are some links that will give you more help:
<a href="http://www.madreporite.com/insteon/commands.htm">http://www.madreporite.com/insteon/commands.htm</a>
<a href="https://www.smarthome.com/FORUM/topic.asp?TOPIC_ID=13762">https://www.smarthome.com/FORUM/topic.asp?TOPIC_ID=13762</a>
<a href="http://blog.automategreen.com/post/under-the-insteon-hub-hood">http://blog.automategreen.com/post/under-the-insteon-hub-hood</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by 3gem at Feb 07, 2014 05:40
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22884364"></a>
                                    <font class="smallfont"><p>Pierce,</p>

<p>Did you ever work out the correct regular expression to extract the device level from the XML? I'm not a coder so the regular expression concept is new to me.</p>

<p>I've also found the following URL to query a devices status directly without the need to use buffstatus.xml:</p>

<p><a href="http://X.X.X.X:25105/sx.xml?ABABAB=1900">http://X.X.X.X:25105/sx.xml?ABABAB=1900</a></p>

<p>See the following URL for details.
<a href="https://www.smarthome.com/FORUM/topic.asp?TOPIC_ID=13762">https://www.smarthome.com/FORUM/topic.asp?TOPIC_ID=13762</a></p>

<p>The output from the above command is included below so if anyone could assist with the regular expression to extract the device level/status it would be greatly appreciated.</p>

<p>URL for device query <a href="http://X.X.X.X:">http://X.X.X.X:</a>&lt;port&gt;/sx.xml?AABBCC=1900</p>

<p>The following output is shown in the browser.</p>

<p>&lt;Xs&gt;<br/>
&lt;X D="AABBCC2A00FF"/&gt;<br/>
&lt;/Xs&gt;</p>

<p>The regular expression needs to extract the last 2 digits of the string, FF in this case.</p>

<p>Thanks in advance.</p>


<p>EDIT: Shorty after this port I found a link to a regular expression.
<a href="http://www.openremote.org/pages/viewpage.action?pageId=22883231&amp;focusedCommentId=22883253">http://www.openremote.org/pages/viewpage.action?pageId=22883231&amp;focusedCommentId=22883253</a></p>

<p>I tested this with an online regex debugger (<a href="http://regex101.com/">http://regex101.com/</a>) and it gave me an error about the last double-quotes not being escape so I added a \ before them. The regex now looks like this.</p>


<p>(0\-9A\-F<div class="error"><span class="error">Unknown macro: {2}</span> </div>)\"/&gt;</p>

<p>Now I need to convert the HEX to decimal somehow for inclusion in the sensor level assuming the above regex is correct.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mcornhill at Feb 16, 2014 05:50
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22884384"></a>
                                    <font class="smallfont"><p>Mark</p>

<p>I have attached a document which lists my progress with the Insteon Hub<br/>
it is my working notes and they are a bit rough and ready </p>

<p>Regarding Regex I found the following link a big help</p>

<p><a href="http://www.codeproject.com/Articles/9099/The-30-Minute-Regex-Tutorial">http://www.codeproject.com/Articles/9099/The-30-Minute-Regex-Tutorial</a></p>

<p>You should download the program Espresso using the link on this page<br/>
I find the great for working out the correct Regex for Openremote.</p>



<p>Insteon hub Doc</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pjmm at Feb 16, 2014 15:13
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22884403"></a>
                                    <font class="smallfont"><p>The attachment didn't upload</p>

<p><a href="attachments/22882151/23036474.doc" title="a">a</a><a href="attachments/22882151/23036474.doc">Insteon-Hub.doc</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pjmm at Feb 16, 2014 21:22
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22884411"></a>
                                    <font class="smallfont"><p>Hi Pierce,</p>

<p>Thank you very much for the detailed document which I have used to successfully get my Insteon micro dimmer working. </p>

<p>I've updated the custom sensor details to make it easier to understand for others as it threw me off initially. I also added a screen shot of the custom sensor to clearly display the configuration.</p>



<p>The other missing functionality for Insteon is getting and setting the level of a dimmer module or a thermostat which you also mentioned. <br/>
Have you made any progress with this? If we can convert HEX to decimal we will be one step closer to having this work.</p>

<p>Again thank you for you help Pierce.</p>

<p><span class="error">!140217 - Insteon-Hub.pdf!</span> </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mcornhill at Feb 17, 2014 11:18
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22884425"></a>
                                    <font class="smallfont"><p>Mark</p>

<p>setting the levels of Dimmer Module is covered in my example</p>

<p>On</p>

<p><a href="http://192.168.1.30:25105/3?026221A9A80F11FF=I=3-">http://192.168.1.30:25105/3?026221A9A80F11FF=I=3-</a> </p>

<p>The FF = 100% </p>

<p>You can input 40 = 25% 7F = 50% BF = 75%</p>

<p>they are represented as hexadecimal values from 0 to 255. </p>

<p>Regarding Thermostats the example I gave covers </p>

<p>Heat set point 71
<a href="http://192.168.1.30:25105/3?0262XXYYZZ1F6D8E0000000000000000000000000005=I=3">http://192.168.1.30:25105/3?0262XXYYZZ1F6D8E0000000000000000000000000005=I=3</a></p>

<p>Hex 8E (71 * 2 = 142, converted to hex = 8E) <br/>
You would have to convert this using a custom rule.</p>

<p>Can you re upload the document you made the changes to</p>

</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pjmm at Feb 17, 2014 17:09
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22884443"></a>
                                    <font class="smallfont"><p>Hi Pierce,</p>

<p>I should have been more specific in my question, sorry for the confusion.</p>

<p>How can we insert the HEX variable into the HTTP GET based on the position of a slider? </p>

<p>Given the range of a slider, we would need to scale 0%-100% to the HEX range 0-255 then somehow insert this into the URL to send to the hub?</p>

<p>Regards<br/>
Mark</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mcornhill at Feb 18, 2014 03:04
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22884457"></a>
                                    <font class="smallfont"><p><a href="http://www.openremote.org/download/attachments/22882151/InsteonHub.pdf" title="Link to embedded resource">InsteonHub.pdf</a></p>

<p>Not sure what I'm doing wrong but the file will not upload sorry Pierce.</p>

<p>I made a small change to the custom sensor as follows:</p>

<p>Name   Value<br/>
On     FF<br/>
Off    00</p>

<p>The only limitation with the On value of FF is when using my Insteon 4 button mini remote as it is programmed to switch on the lights to 50% so the On value of FF is never reached, therefore the OR interface icon does not update.</p>

<p>I've tried using &lt;0 (greater than zero) for the custom sensor On value, however this does not work.</p>

<p>Can anyone provide any tips on how I can enter a value for On in my custom sensor to match any HEX number greater than zero?</p>

<p>Regards<br/>
Mark</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mcornhill at Feb 18, 2014 11:16
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22884466"></a>
                                    <font class="smallfont"><p>Looks like you tried to include it as an <em>image</em></p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">!InsteonHub.pdf align=left!</pre>
</div></div>
<p>instead of an <em>attachment</em> <br/>
Use the <b>Insert link</b> icon at the very left to attach a document.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Feb 18, 2014 13:02
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22884490"></a>
                                    <font class="smallfont"><p>Chris</p>

<p>If you are setting your dimmer to 50% then it should return 7F for 50% and 40 for 40%</p>

<p>there are several pages on the web giving the values</p>

<p>hexadecimal values from 0 to 255 this is one</p>

<p><a href="http://www.december.com/html/spec/dechex.html">http://www.december.com/html/spec/dechex.html</a></p>

<p>Pierce</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pjmm at Feb 18, 2014 21:19
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22884518"></a>
                                    <font class="smallfont"><p>Here is the file Pierce as requested. Sorry for the delay.<br/>
<a href="attachments/22882151/23036480.pdf">InsteonHub.pdf</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mcornhill at Feb 19, 2014 10:02
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885516"></a>
                                    <font class="smallfont"><p>Hey guys, have been following along to get an on/off wall switch working through OR as a test before going all out redoing all my switches.  I'm most of the way there thanks to the pdf but still have a couple of small hurdles I thought you guys might have advice on.  I'm setup pretty much exactly the same as the pdf suggests.</p>

<p>On / Off commands seem to require multiple presses in OR to get a response, the first 'on' command seems to go through first press, subsequent commands seem to need a bit of mashing - when running the addresses through a browser I get an instant response each time.</p>

<p>Custom sensor - when using it to implement a switch it only seems to work as 'on' and possibly not correctly detecting the insteon devices state, may also be something to do with the issues I'm having with the on / off commands themselves. I have used FF and 00 as the values.</p>

<p>Have you guys experienced these types of issues or should I be reviewing my setup?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by nevillebartos at Mar 26, 2014 08:35
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885520"></a>
                                    <font class="smallfont"><p>Hi Neville,</p>

<p>I burnt so much time trying to get the equivalent functionality<br/>
to Zwave with the Insteon micro dimmer that I gave up in the end.</p>

<p>Insteon offer more wireless button options here in Australia<br/>
than Zwave which was my primary driver for Insteon.</p>

<p>I hope you have better luck than I.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mcornhill at Mar 26, 2014 09:44
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885521"></a>
                                    <font class="smallfont"><p>Hows are you finding the zwave gear?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by nevillebartos at Mar 26, 2014 10:36
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885536"></a>
                                    <font class="smallfont"><p>I'm using a Vera lite with Zwave devices and its a solid solution. The only slight issue is some dimmers flicker when set to a low level. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mcornhill at Mar 26, 2014 20:44
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:37</font></td>
		    </tr>
	    </table>
    </body>
</html>