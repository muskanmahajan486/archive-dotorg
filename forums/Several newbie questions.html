<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Several newbie questions</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Several newbie questions
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jul 17, 2014 by <font color="#0050B2">druciak</font>.
				    </div>

				    <p>This is my first post so I'd like to say hello.<br/>
I am currently making design of my home automation system and I am looking for a controller. It will be based on z-wave/1-wire/http components and I would need a web based and Android client. OR at first look was a great solution, but after while I realized it has some limitations and does not seem to be mature enough.<br/>
Here are my questions anf concerns:<br/>
1. Onewire implementation seems broken, sometimes it cannot read values (displays "N/A"). I tried implementation done by Tom Kucharski and it is much better (thanks!). It would be a solution unless I need another feature from another developer, which makes controller build much harder.<br/>
2. Z-Wave limitations. I don't have any z-wave device yet to test OR with, but I read that z-wave is also not well implemented and limited to 10 devices only in free version. $150 seems pretty expensive for the software only, and for the software that does not work well.<br/>
3. I don't see any option to format sensor's value. I'd like for example format temperatures to one decimal digit, but for sure there are many other use case it would be needed.<br/>
4. Is there a way to poll more than one value for a command? For example I have a weather station that has all the sensors exposed by HTTP and JSON. To have each value from the station I needed to declare separate command and each of these command makes its own HTTP request. It does not make sense IMO. In such case it would be better to make one request and feed all the sensors with values.<br/>
5. I created a panel with a switch. This switch is for OneWire command. In general it work well in WebConsole, but in Andorid app it does not display switch state. I suspect this is due to sensor value which is 0/1 instead on/off, but on the other hand it work well on web console. Having in mind that there is no option (is there?) to convert these 0/1 to on/off I don't see a solution for that.<br/>
6. I prepared a background image for my screens, simple white dot (1x1) which is stretched to fill the screen. I works well in web console (background is white), but again not in Android app. Am I doing something wrong or there is a bug in the app?<br/>
Thanks for any response, any answers and solution are very welcome.</p>


				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22887579/23036601.png">sensor.png</a> (image/png)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-22887587"></a>
                                    <font class="smallfont"><blockquote>
<p>does not seem to be mature enough</p></blockquote>
<p>Then why bother? Move on to mature ones.</p>

<p>"Darowanemu koniowi nie zagląda się w zęby"</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Jul 16, 2014 22:11
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887591"></a>
                                    <font class="smallfont"><p>I was hoping some of my questions can be solved somehow, since I am discovering OR and likely there are things in there I am not aware of. But apperently your knowledge in this matter isn't better than mine. <br/>
I will try to domesticate OR for a while and then decide what to do.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by druciak at Jul 17, 2014 07:33
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887593"></a>
                                    <font class="smallfont"><blockquote><p>"Darowanemu koniowi nie zagląda się w zęby"</p></blockquote>
<p>What he says is not only true for the free version, but essentially also for the <b>Pro version</b> that he is considering. The <a href="http://www.openremote.com">Pro site</a> pretends to sell mature products. Imho it does not make sufficiently clear to new users that they need to have quite some technical background. So making that quote is a bit harsh I think.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Jul 17, 2014 08:33
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887594"></a>
                                    <font class="smallfont"><p>Thanks, I was going to mention this as well...</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by druciak at Jul 17, 2014 09:32
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887672"></a>
                                    <font class="smallfont"><p>I solved some of the issues (more-less):<br/>
1. Using Tom Kucharski controller.<br/>
5. Using SWITCHABLE sensor. It also has limitations, for example it does not read current value, so changing value of SWITCHABLE sensor outside the controller does not change switch state. Not sure which option is better...<br/>
6. For the first tests I installed version from Google store, which seems to be older than on SF files. Now with 2.1 it works better, but size of the panel does not reflect screen size - it is much smaller. The previous version resized panel to fill the screen. Is there a way to fix this? Or I should just prepare a custom panel with proper size?</p>

<p>The rest is not so important, maybe except for #3.</p>

<p>I have one additional question: how can I build Android console, I mean where are the sources of the latest published version (Android_Console_2_1_0_SNAPSHOT-2013-03-02.apk)?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by druciak at Jul 23, 2014 19:57
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887676"></a>
                                    <font class="smallfont"><blockquote>
<p>3. I don't see any option to format sensor's value. I'd like for example format temperatures to one decimal digit, but for sure there are many other use case it would be needed.</p>

<p>The rest is not so important, maybe except for #3.</p></blockquote>
<p>You can use rules for this. One example is available here <a href="http://mqlservice.net/openremote/2013/05/22/temperature-sensors-calibration/">http://mqlservice.net/openremote/2013/05/22/temperature-sensors-calibration/</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Jul 24, 2014 09:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887677"></a>
                                    <font class="smallfont"><p>Nice! Will try it soon. These rules are really powerful and this may be the reason to stick with OR. Already had a look at Drools docs, but haven't written any rule yet.<br/>
Thanks a lot. It should also help with #5 I guess, but I think I will fix the code once I get the info where I can pull the sources from. In WebConsole this is done in this way (<em>org.openremote.web.console.widget.SwitchComponent</em>):</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
<span class="code-keyword">if</span> (!value.equalsIgnoreCase(<span class="code-quote">"off"</span>) &amp;&amp; !value.equalsIgnoreCase(<span class="code-quote">"on"</span>)) {
	<span class="code-keyword">try</span> {
		<span class="code-object">int</span> numValue = <span class="code-object">Integer</span>.parseInt(value);
		numValue = numValue &gt; 0 ? 1 : 0;
		value = numValue == 0 ? <span class="code-quote">"off"</span> : <span class="code-quote">"on"</span>;
	} <span class="code-keyword">catch</span> (Exception e) {}
}
</pre>
</div></div>
<p>BTW: the middle line seems not necessary, anyway it works.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by druciak at Jul 24, 2014 09:51
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887690"></a>
                                    <font class="smallfont"><p>Finally I got my rule working, but it was pain in the ass, believe me. Here is the code:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
<span class="code-keyword">package</span> org.openremote.controller.model.event

global org.openremote.controller.statuscache.CommandFacade execute;

rule <span class="code-quote">"Format temperature"</span>
when
  CustomState(source matches <span class="code-quote">"Temp.+(?&lt;!_F)"</span>, $s: source, $v: value)
then
  <span class="code-object">double</span> parsed = <span class="code-object">Double</span>.parseDouble($v.toString());
  <span class="code-object">String</span> sens = <span class="code-object">String</span>.format(<span class="code-quote">"%s_F"</span>, $s.toString());
  execute.command(sens, <span class="code-object">String</span>.format(<span class="code-quote">"%.1f \u2103"</span>, parsed));
end
</pre>
</div></div>
<p>I had to define additional sensors and command for each command/sensor pair I'd to format. The convention is to add "_F" suffix to the name. It works for all sensors with name starting with "Temp".<br/>
Two questions:<br/>
1. Is there a way to check a command exists?<br/>
2. Do I need to have sensors for "raw" value? Is there a way to read the value directly from a command in rules?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by druciak at Jul 25, 2014 12:02
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887695"></a>
                                    <font class="smallfont"><blockquote>
<p>1. Is there a way to check a command exists?<br/>
2. Do I need to have sensors for "raw" value? Is there a way to read the value directly from a command in rules?</p></blockquote>
<p>1. No.<br/>
2. Yes. No.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Jul 25, 2014 14:32
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887736"></a>
                                    <font class="smallfont"><p>The Android screen size and density issues are a bit complex: <a href="http://jira.openremote.org/browse/ANDROID-91">http://jira.openremote.org/browse/ANDROID-91</a> I got as far as I could on that before needing to move on to other projects.</p>

<p>You're on the right track for what currently works well by thinking about making a custom panel of the appropriate size. Unless the code has changed significantly since I last looked at it, someone will need to continue working on the ticket above in order to make that part smooth. The older versions just used auto-scaling, but that decreases picture quality, so it was desired to find some way of allowing really high-resolution backgrounds to look good without sacrificing usability and backwards compatibility. Not so easy.</p>

<p>I was thinking about having the designer have a few more Android sizes in it. That may require some user involvement, but could at least make a better, simpler alternative to having to do a custom panel.</p>

<p>Thanks for the feedback,<br/>
Andrew</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by cortextual at Jul 27, 2014 22:00
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887741"></a>
                                    <font class="smallfont"><p>Thanks for the explanation. I think auto-scaling as an option would also make sense even though the quality decreases. This way you let users to choose. Do you know where I can get the latest code of the Android panel?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by druciak at Jul 28, 2014 08:18
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887757"></a>
                                    <font class="smallfont"><p>The person on this forum who should know everything about Android console (and web console too) is Richard Turner. You can start looking in his workspace <a href="http://svn.code.sf.net/p/openremote/code/workspace/richturner/">https://svn.code.sf.net/p/openremote/code/workspace/richturner/</a>. I would be too interested in a better Android console as right now the ones designed for iPhone are not looking good on Android devices. They were better with auto-scaling.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Jul 29, 2014 10:28
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887758"></a>
                                    <font class="smallfont"><p>I am running version 2.1.1, which I got end 2013/begin 2014 for test towards (IIRC) a new formal release in the playstore. For unknown reasons that never happened. <br/>
PS: I don't think it does auto scaling.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Jul 29, 2014 11:00
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887760"></a>
                                    <font class="smallfont"><p>Thanks for the info, I was looking for repos with 2_1_0 in the name, but it seems his "Android_Console_2_0_0_Betas" is the main repository for the console. Also I found out that there is a tag for released 2.1.0 in his "tag" directory. I am going to get familiar with this code soon, at least I hope.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by druciak at Jul 29, 2014 11:08
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22887765"></a>
                                    <font class="smallfont"><p>I solved #5 by adding custom state items:<br/>
<img src="attachments/22887579/23036601.png" align="absmiddle" border="0"/><br/>
This is better than changing Android app code or adding a rule. I think it is also better than "SWITCHABLE" command.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by druciak at Jul 29, 2014 19:19
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:38</font></td>
		    </tr>
	    </table>
    </body>
</html>