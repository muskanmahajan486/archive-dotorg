<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : BENQ W1070</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : BENQ W1070
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Nov 05, 2013 by <font color="#0050B2">spencerthomass</font>.
				    </div>

				    <p>I am trying to get my benq w1070 to work with open remote. I have vspe set up to run a tcp server to my bluetooth rs232 adapter. I have to do it this way to keep the link alive. I can send commands via tcp through open remote and they work and I can read the power status when the projector is turned off but once it is turned on it stops reading it correctly. Here is a link to the rs232 commands, <a href="ftp://supportfiles.benq.eu/projector/benq_rs232_commands.pdf">ftp://supportfiles.benq.eu/projector/benq_rs232_commands.pdf</a> Any ideas to get this thing fully functional?</p>

				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-22879471"></a>
                                    <font class="smallfont"><p>If I use the Hercules Setup Utility by HW-group.com I can get all commands to function perfectly with the projector on and off.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by spencerthomass at Nov 05, 2013 23:06
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22881114"></a>
                                    <font class="smallfont"><p>Nobody has any suggestions? I haven't given up but for some reason i can communicate with the W1070 just fine when it is shut off but the second it turns on the communication gets all crazy.  I am using Hercules Setup utility to monitor what is going on and here is what it outputs</p>


<p>&gt;*pow=?#<br/>
*POW=OFF#<br/>
&gt;*pow=?#<br/>
*POW=OFF#<br/>
&gt;*pow=on#<br/>
*POW=ON#<br/>
poßpoßpoßpoßpoßpoß*pow=?#&gt;*pow=?#<br/>
*POW=ON#<br/>
poßpoßpoßpoßpoßpoßpoßpoßpoßpoßpoßpoßpoßpoßpoßpoßpoßpoßpoßpoßpoßpoßpoß*pow=off#&gt;*pow=off#<br/>
*POW=OFF#<br/>
poßpoßpoßpoßpoß&gt;*pow=?#<br/>
*POW=OFF#<br/>
&gt;*pow=?#<br/>
*POW=OFF#<br/>
&gt;*pow=?#<br/>
*POW=OFF#<br/>
&gt;*pow=?#<br/>
*POW=OFF#</p>

<p>You can see the part where the projector is turned on and everything breaks until I shut it off.  Any ideas would be greatly appreciated. Again all commands sent in Hercules Setup Utility work flawlessly.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by spencerthomass at Dec 11, 2013 22:10
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22881138"></a>
                                    <font class="smallfont"><p>I have been messing around with eventghost and that can communicate with the benq without problem as well.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by spencerthomass at Dec 12, 2013 23:10
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22881139"></a>
                                    <font class="smallfont"><p>What does your TCP command configuration in the designer look like?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Dec 13, 2013 02:46
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22881190"></a>
                                    <font class="smallfont"><p>IP: 127.0.0.1<br/>
Port: 5555<br/>
Commnad: *pow=?# ( I have also tried "&lt;cr&gt;*pow=?#&lt;cr&gt;", "\r*pow=?#\r")<br/>
RegularExpression:<br/>
Polling Interval: 2s ( I have tried many different intervals here)</p>

<p>This is suppose to return the power status to me which works when the projector is turned off but once turned on nothing works.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by spencerthomass at Dec 13, 2013 15:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22881267"></a>
                                    <font class="smallfont"><p>You can add TCP debug logging to your OR instance by going to OR/webapps/controller/WEB-INF/classes/log4j.properties and add these lines:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
log4j.logger.OpenRemote.Controller.protocol.tcp = ALL, tcp-file
log4j.appender.tcp-file = org.apache.log4j.RollingFileAppender
log4j.appender.tcp-file.File = ../logs/tcp.log
log4j.appender.tcp-file.Threshold = DEBUG
log4j.appender.tcp-file.MaxFileSize = 500KB
log4j.appender.tcp-file.MaxBackupIndex = 1
log4j.appender.tcp-file.layout = org.apache.log4j.PatternLayout
log4j.appender.tcp-file.layout.ConversionPattern = %p %d (TCP): %m%n
</pre>
</div></div>

<p>So you will see what OR receives. We won't send anything other than what's been specified in your Designer. There's a couple of intermediates between OR and your device so something may be causing that glitch.</p>

</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Dec 16, 2013 06:37
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22881291"></a>
                                    <font class="smallfont"><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>2013-12-16 09:33:36,533 INFO [Controller Definition File Watcher for Default Deployer]: 

--------------------------------------------------------------------

  DEPLOYING NEW CONTROLLER RUNTIME...

--------------------------------------------------------------------

2013-12-16 09:33:36,539 INFO [Controller Definition File Watcher for Default Deployer]: No rule definitions found in 'C:\openremote\webapps\controller\rules'.
2013-12-16 09:33:36,540 INFO [Controller Definition File Watcher for Default Deployer]: Initialized event processor : Drools Rule Engine
2013-12-16 09:33:36,543 INFO [Controller Definition File Watcher for Default Deployer]: Initialized event processor : RRD4J Data Logger
2013-12-16 09:33:36,543 INFO [Controller Definition File Watcher for Default Deployer]: Initialized event processor : EmonCMS Data Logger
2013-12-16 09:33:36,543 INFO [Controller Definition File Watcher for Default Deployer]: Startup complete.
2013-12-16 09:33:45,724 DEBUG [HTTP-Thread-2]: Building HttGetCommand
2013-12-16 09:33:45,724 DEBUG [HTTP-Thread-2]: TCPSocketCommand: port = 5555
2013-12-16 09:33:45,724 DEBUG [HTTP-Thread-2]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:33:45,724 DEBUG [HTTP-Thread-2]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:33:46,396 DEBUG [HTTP-Thread-2]: received message: po  ß
2013-12-16 09:36:09,567 DEBUG [HTTP-Thread-6]: Building HttGetCommand
2013-12-16 09:36:09,567 DEBUG [HTTP-Thread-6]: TCPSocketCommand: port = 5555
2013-12-16 09:36:09,567 DEBUG [HTTP-Thread-6]: TCPSocketCommand: command = *pow=on#
2013-12-16 09:36:09,567 DEBUG [HTTP-Thread-6]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:36:09,887 DEBUG [HTTP-Thread-6]: received message: &gt;
2013-12-16 09:36:32,941 DEBUG [HTTP-Thread-16]: Building HttGetCommand
2013-12-16 09:36:32,941 DEBUG [HTTP-Thread-16]: TCPSocketCommand: port = 5555
2013-12-16 09:36:32,941 DEBUG [HTTP-Thread-16]: TCPSocketCommand: command = *pow=on#
2013-12-16 09:36:32,941 DEBUG [HTTP-Thread-16]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:36:33,330 DEBUG [HTTP-Thread-16]: received message: &gt;
2013-12-16 09:36:46,391 DEBUG [HTTP-Thread-17]: Building HttGetCommand
2013-12-16 09:36:46,391 DEBUG [HTTP-Thread-17]: TCPSocketCommand: port = 5555
2013-12-16 09:36:46,391 DEBUG [HTTP-Thread-17]: TCPSocketCommand: command = *pow=on#
2013-12-16 09:36:46,391 DEBUG [HTTP-Thread-17]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:36:46,670 DEBUG [HTTP-Thread-17]: received message: &gt;
2013-12-16 09:36:46,712 DEBUG [HTTP-Thread-2]: Building HttGetCommand
2013-12-16 09:36:46,712 DEBUG [HTTP-Thread-2]: TCPSocketCommand: port = 5555
2013-12-16 09:36:46,712 DEBUG [HTTP-Thread-2]: TCPSocketCommand: command = *pow=on#
2013-12-16 09:36:46,712 DEBUG [HTTP-Thread-2]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:36:47,730 DEBUG [HTTP-Thread-2]: received message: *pow=on#

*POW=ON#

2013-12-16 09:38:01,064 DEBUG [HTTP-Thread-6]: Building HttGetCommand
2013-12-16 09:38:01,064 DEBUG [HTTP-Thread-6]: TCPSocketCommand: port = 5555
2013-12-16 09:38:01,064 DEBUG [HTTP-Thread-6]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:38:01,064 DEBUG [HTTP-Thread-6]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:38:01,488 DEBUG [HTTP-Thread-16]: Building HttGetCommand
2013-12-16 09:38:01,488 DEBUG [HTTP-Thread-16]: TCPSocketCommand: port = 5555
2013-12-16 09:38:01,488 DEBUG [HTTP-Thread-16]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:38:01,488 DEBUG [HTTP-Thread-16]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:38:01,648 DEBUG [HTTP-Thread-16]: received message: po  ß
2013-12-16 09:38:01,648 DEBUG [HTTP-Thread-6]: received message: po  ß
2013-12-16 09:38:03,133 DEBUG [HTTP-Thread-17]: Building HttGetCommand
2013-12-16 09:38:03,133 DEBUG [HTTP-Thread-17]: TCPSocketCommand: port = 5555
2013-12-16 09:38:03,133 DEBUG [HTTP-Thread-17]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:38:03,133 DEBUG [HTTP-Thread-17]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:38:03,303 DEBUG [HTTP-Thread-2]: Building HttGetCommand
2013-12-16 09:38:03,303 DEBUG [HTTP-Thread-2]: TCPSocketCommand: port = 5555
2013-12-16 09:38:03,303 DEBUG [HTTP-Thread-2]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:38:03,303 DEBUG [HTTP-Thread-2]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:38:03,652 DEBUG [HTTP-Thread-18]: Building HttGetCommand
2013-12-16 09:38:03,652 DEBUG [HTTP-Thread-18]: TCPSocketCommand: port = 5555
2013-12-16 09:38:03,652 DEBUG [HTTP-Thread-18]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:38:03,652 DEBUG [HTTP-Thread-18]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:38:03,818 DEBUG [HTTP-Thread-19]: Building HttGetCommand
2013-12-16 09:38:03,818 DEBUG [HTTP-Thread-19]: TCPSocketCommand: port = 5555
2013-12-16 09:38:03,818 DEBUG [HTTP-Thread-19]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:38:03,818 DEBUG [HTTP-Thread-19]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:38:03,848 DEBUG [HTTP-Thread-17]: received message: po  ß
2013-12-16 09:38:03,848 DEBUG [HTTP-Thread-18]: received message: po  ß
2013-12-16 09:38:03,848 DEBUG [HTTP-Thread-19]: received message: po  ß
2013-12-16 09:38:03,848 DEBUG [HTTP-Thread-2]: received message: po  ß
2013-12-16 09:38:04,040 DEBUG [HTTP-Thread-20]: Building HttGetCommand
2013-12-16 09:38:04,040 DEBUG [HTTP-Thread-20]: TCPSocketCommand: port = 5555
2013-12-16 09:38:04,040 DEBUG [HTTP-Thread-20]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:38:04,040 DEBUG [HTTP-Thread-20]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:38:04,068 DEBUG [HTTP-Thread-20]: received message: po  ß
2013-12-16 09:38:04,108 DEBUG [HTTP-Thread-21]: Building HttGetCommand
2013-12-16 09:38:04,108 DEBUG [HTTP-Thread-21]: TCPSocketCommand: port = 5555
2013-12-16 09:38:04,108 DEBUG [HTTP-Thread-21]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:38:04,108 DEBUG [HTTP-Thread-21]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:38:04,268 DEBUG [HTTP-Thread-22]: Building HttGetCommand
2013-12-16 09:38:04,268 DEBUG [HTTP-Thread-22]: TCPSocketCommand: port = 5555
2013-12-16 09:38:04,268 DEBUG [HTTP-Thread-22]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:38:04,268 DEBUG [HTTP-Thread-22]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:38:04,424 DEBUG [HTTP-Thread-23]: Building HttGetCommand
2013-12-16 09:38:04,424 DEBUG [HTTP-Thread-23]: TCPSocketCommand: port = 5555
2013-12-16 09:38:04,424 DEBUG [HTTP-Thread-23]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:38:04,424 DEBUG [HTTP-Thread-23]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:38:04,531 DEBUG [HTTP-Thread-24]: Building HttGetCommand
2013-12-16 09:38:04,531 DEBUG [HTTP-Thread-24]: TCPSocketCommand: port = 5555
2013-12-16 09:38:04,531 DEBUG [HTTP-Thread-24]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:38:04,531 DEBUG [HTTP-Thread-24]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:38:04,695 DEBUG [HTTP-Thread-25]: Building HttGetCommand
2013-12-16 09:38:04,695 DEBUG [HTTP-Thread-25]: TCPSocketCommand: port = 5555
2013-12-16 09:38:04,695 DEBUG [HTTP-Thread-25]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:38:04,695 DEBUG [HTTP-Thread-25]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:38:04,825 DEBUG [HTTP-Thread-26]: Building HttGetCommand
2013-12-16 09:38:04,825 DEBUG [HTTP-Thread-26]: TCPSocketCommand: port = 5555
2013-12-16 09:38:04,825 DEBUG [HTTP-Thread-26]: TCPSocketCommand: command = *pow=off#
2013-12-16 09:38:04,825 DEBUG [HTTP-Thread-26]: TCPSocketCommand: ipAddress = 127.0.0.1
2013-12-16 09:38:05,068 DEBUG [HTTP-Thread-24]: received message: po  ß
2013-12-16 09:38:05,068 DEBUG [HTTP-Thread-23]: received message: po  ß
2013-12-16 09:38:05,068 DEBUG [HTTP-Thread-22]: received message: po  ß
2013-12-16 09:38:05,068 DEBUG [HTTP-Thread-25]: received message: po  ß
2013-12-16 09:38:05,068 DEBUG [HTTP-Thread-21]: received message: po  ß
2013-12-16 09:38:05,068 DEBUG [HTTP-Thread-26]: received message: po  ß
</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by spencerthomass at Dec 16, 2013 16:46
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22881376"></a>
                                    <font class="smallfont"><p>Well, nothing particularly unusual there &#8211; for each off command it receives some bytes, always the same sequence. It looks like its outside the ASCII byte range so it prints the strange 'po  ß' string in response. At times you see the response seems to arrive with latency, but each off is matched with that response.</p>

<p>On your send there are multiple responses, first three times character '&gt;' and fourth time a longer multiline response string</p>

<blockquote>
<p>*pow=on#</p>

<p>*POW=ON#</p>
</blockquote>

<p>I haven't looked at the serial protocol if any of that matches what is expected but there it is basically. Nothing out of the ordinary from the OR side, not sure if it is out of the ordinary with respect to the documented serial protocol, or if the intermediates are having an impact on the communication.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Dec 18, 2013 10:32
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22881377"></a>
                                    <font class="smallfont"><p>The carriage returns may be what's causing issues though, looking at the PDF link you posted. Not sure if it is expecting those to be included and if there's a way to enter them in the Designer.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Dec 18, 2013 10:36
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:40</font></td>
		    </tr>
	    </table>
    </body>
</html>