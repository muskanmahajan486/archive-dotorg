<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Zwave problem</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Zwave problem
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on May 09, 2013 by <font color="#0050B2">juha</font>.
				    </div>

				    <p>Hi,</p>

<p>I try to run openremote on my synlogy NAS and use zwave. </p>

<p>I have done:</p>
<ul class="alternate" type="square">
	<li>installed openremote pacakage 2.0.1</li>
	<li>upgraded to OpenRemote-Controller-2.0.2</li>
	<li>followed the upgrade instructions (<a href="http://www.openremote.org/display/docs/OpenRemote+2.0+How+To+-+Synology+with+Z-Wave" title="OpenRemote 2.0 How To - Synology with Z-Wave">OpenRemote 2.0 How To &#45; Synology with Z&#45;Wave</a>)</li>
</ul>


<p>Problem:<br/>
1) in the manual is stated that the DEBUG setting for zwave need to be changed in log4j.properties. If I open the file I can not find a ZWAVE section, it is missing<br/>
2) the log files are not created /log/zwave</p>

<p>Errors:</p>

<p>From the boot.log:</p>

<p>INFO 2013-05-09 00:03:57,873 : No rule definitions found in '/volume1/@appstore/OpenRemote/webapps/controller/rules'.<br/>
INFO 2013-05-09 00:03:57,874 : Initialized event processor : Drools Rule Engine<br/>
ERROR 2013-05-09 00:03:57,907 : Creating sensor failed. Error : No device protocol builders registered with protocol type 'zwave'.<br/>
 XML Element : &lt;sensor xmlns="http://www.openremote.org" id="16" name="sensor-aan" type="switch"&gt;<br/>
      &lt;include type="command" ref="15" /&gt;<br/>
      &lt;state name="on" /&gt;<br/>
      &lt;state name="off" /&gt;<br/>
    &lt;/sensor&gt;<br/>
org.openremote.controller.exception.ConfigurationException: No device protocol builders registered with protocol type 'zwave'.</p>

<p>please help.</p>

				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-22413923"></a>
                                    <font class="smallfont"><p>You will need to upgrade to the 2.1 developer snapshot with Z-Wave which is explained in the Z-Wave How to: <a href="http://www.openremote.org/display/docs/OpenRemote+2.0+How+To+-+Z-Wave" title="OpenRemote 2.0 How To - Z-Wave">OpenRemote 2.0 How To &#45; Z&#45;Wave</a>. See the 'Configuration of System' section:</p>

<blockquote>
<p>For DIY users:</p>

<p>We provide a free Z-Wave version to our community users which is limited to total of 10 devices (10 nodes in the Z-Wave mesh network):</p>

<p>Install the 2.1.0 developer snapshot of the controller: OpenRemote Controller 2.1.0 Developer Snapshot 20120920<br/>
Download and copy the zwave.jar file into the folder "OpenRemote-Controller-2.1.0/webapps/controller/WEB-INF/lib"<br/>
Create a new OpenRemote Designer Account (free) or use your existing account.</p></blockquote></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at May 09, 2013 07:01
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22413930"></a>
                                    <font class="smallfont"><p>Thanks for the answer. I see now that I have listed the wrong version in this forum, actually I have installed OpenRemote-Controller-2.1.0_SNAPSHOT-2013-04-09.</p>

<p>I also checked the source files and the log4j.properties does not contain a Zwave section.</p>

<p>Pleae advise</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dylan at May 09, 2013 08:26
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22413931"></a>
                                    <font class="smallfont"><p>In the case of Z-wave you will need the precise snapshot mentioned on the Z-wave howto page which is <a href="http://sourceforge.net/projects/openremote/files/For%20Developers/OpenRemote%202.0%20%28Developer%20Releases%29/OpenRemote-Controller-2.1.0_Developer-Snapshot-20120920.zip/download">OpenRemote-Controller-2.1.0_Developer-Snapshot-20120920.zip</a>.</p>

<p>The developer snapshots are not always equal and not all the features have been merged into a single release line yet, this is the case of Z-wave at the moment. </p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at May 09, 2013 08:49
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414107"></a>
                                    <font class="smallfont"><p>Thanks, it workes for the zwave part!</p>

<p>One problem left: no devices are shown</p>

<p>I tested with SynoZwave and I can see,connect and manage the zwave attached sensors</p>

<p>But when I start the webconsole I see a message that the ID's are invallid.</p>

<p>Catalina.out log file:</p>

<p>INFO 2013-05-11 11:28:16,641 : No rule definitions found in '/volume1/@appstore/OpenRemote/webapps/controller/rules'.<br/>
INFO 2013-05-11 11:28:16,642 : Initialized event processor : Drools Rule Engine<br/>
INFO 2013-05-11 11:28:16,692 : Initialized event processor : RRD4J Data Logger<br/>
ERROR 2013-05-11 11:28:16,707 : Creating sensor failed. Error : The node '2' is not known by the Z-Wave controller<br/>
 XML Element : &lt;sensor xmlns="http://www.openremote.org" id="16" name="sensor-aan" type="switch"&gt;<br/>
      &lt;include type="command" ref="15" /&gt;<br/>
      &lt;state name="on" /&gt;<br/>
      &lt;state name="off" /&gt;<br/>
    &lt;/sensor&gt;<br/>
org.openremote.controller.exception.NoSuchCommandException: The node '2' is not known by the Z-Wave controller</p>


<p>zwave log file, does only contain items like this:</p>

<p>DEBUG 2013-05-11 10:26:17,580 (1-WIRE): Building Z-Wave command<br/>
DEBUG 2013-05-11 10:26:17,581 (1-WIRE): Z-Wave command: nodeId = 2<br/>
DEBUG 2013-05-11 10:26:17,581 (1-WIRE): Z-Wave command: command = status<br/>
DEBUG 2013-05-11 10:26:20,181 (1-WIRE): Building Z-Wave command<br/>
DEBUG 2013-05-11 10:26:20,181 (1-WIRE): Z-Wave command: nodeId = 2<br/>
DEBUG 2013-05-11 10:26:20,182 (1-WIRE): Z-Wave command: command = status</p>


<p>I see no messages like "DEBUG (Z-WAVE): Node id: 1 discovered"</p>


<p>Please advise</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dylan at May 11, 2013 10:57
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414185"></a>
                                    <font class="smallfont"><p>Don't have Z-wave hardware so don't recognize the issue. Maybe try asking others in the forums who have installed Z-wave to see if they would have an idea.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at May 13, 2013 06:33
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414186"></a>
                                    <font class="smallfont"><p>Is SynoZwave still running on your NAS? It should be stopped, but not removed. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at May 13, 2013 07:21
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414187"></a>
                                    <font class="smallfont"><p>Yes, I have stopped SynoZwave. I stopped it via the Synology package center -&gt; actions -&gt; stop and rebooted the NAS. </p>

<p>thanks, please advise</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dylan at May 13, 2013 07:47
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414190"></a>
                                    <font class="smallfont"><p>That's correct. I do not use native Z-Wave at the moment, so can't check my own installation. Did you notice anything strange in the catalina.out log, or in yhe dev.log files?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at May 13, 2013 09:14
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414193"></a>
                                    <font class="smallfont"><p>Did you set RXTX and /dev/ttyUSB0 in server properties and sync?<br/>
Do your RXTX drivers load successfully?<br/>
It seems that the initial communication with the zwave stick is not working.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at May 13, 2013 11:47
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414213"></a>
                                    <font class="smallfont"><p>Perhaps you could add a debug output in the zwave log if the port has been successfully opened or not? I am on a similar issue (see <a href="http://openremote.wiki-neon.adaptavist.com/display/forums/Z+Wave+Problems+with+symlinks">http://openremote.wiki-neon.adaptavist.com/display/forums/Z+Wave+Problems+with+symlinks</a>) and would be glad to have that information for debugging.  </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aschwith at May 13, 2013 18:09
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414215"></a>
                                    <font class="smallfont"><p>The exception if the port is not found is printed. It should be in catalina.out.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at May 13, 2013 18:57
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414216"></a>
                                    <font class="smallfont"><p>Thanks Marcus, I just found the exeption message. But actually the port ist there, do you think you might have a look and add the proposed fix for the java rxtxlib? </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aschwith at May 13, 2013 19:09
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414218"></a>
                                    <font class="smallfont"><p>Your fix suggest to set a Java system property. This can be done during startup.<br/>
You can modify openremote.sh and after this line</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
JAVA_OPTS=<span class="code-quote">"$JAVA_OPTS -Djava.library.path=$OR_BOSS_NATIVE_LIBRARY_PATH"</span>
</pre>
</div></div>
<p>add another line like this</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
JAVA_OPTS=<span class="code-quote">"$JAVA_OPTS -Dgnu.io.rxtx.SerialPorts=/dev/ttyAMA0"</span>
</pre>
</div></div>

<p>PS: Do you have a ZWave device which is reachable via /dev/ttyAMA0?<br/>
That is the internal serial port of tha Raspberry and I don't know of any ZWave device except the Razberry.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at May 13, 2013 19:19
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22414221"></a>
                                    <font class="smallfont"><p>Thanks for the fast reply. That line did fix the issue. Sorry for the confusion. The device name was just an example. The aeon stick is assigned to /dev/ttyUSB0 which I set to /dev/zwave by udev rules. So as you suggested I added the following line in order to make that symbolic link available for the rxtx library. </p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">

JAVA_OPTS=<span class="code-quote">"$JAVA_OPTS -Dgnu.io.rxtx.SerialPorts=/dev/zwave"</span>

</pre>
</div></div>

<p>Thanks again for the help.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aschwith at May 13, 2013 20:11
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22886284"></a>
                                    <font class="smallfont"><p>I have a similar or the same problem. I don't know how to find openremote.sh (newbie)<br/>
Could you please specify where i can find the file to change exactly?</p>

<p>Catalina.out says:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
...
ERROR 2014-05-06 01:43:54,466 : Creating sensor failed. Error : The node '10' is not known by the Z-Wave controller 
 XML Element : &lt;sensor xmlns=<span class="code-quote">"http:<span class="code-comment">//www.openremote.org"</span> id=<span class="code-quote">"245"</span> name=<span class="code-quote">"Sensor10"</span> type=<span class="code-quote">"<span class="code-keyword">switch</span>"</span>&gt;
</span>      &lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"244"</span> /&gt;
      &lt;state name=<span class="code-quote">"on"</span> /&gt;
      &lt;state name=<span class="code-quote">"off"</span> /&gt;
    &lt;/sensor&gt;
...
</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by willibald17 at May 06, 2014 00:34
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22886296"></a>
                                    <font class="smallfont"><p>In the <b>bin</b> subdirectory</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at May 06, 2014 07:19
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22886308"></a>
                                    <font class="smallfont"><p>Thanks. Found it. Added the line from Alexander's post (using /dev/ttyUSB0).</p>

<p>In my controller.xml it says:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">    
&lt;property name=<span class="code-quote">"zwave.comPort"</span> value=<span class="code-quote">"/dev/ttyUSB0"</span> /&gt;
</pre>
</div></div>

<p>However it didn't work for me unfortunately.<br/>
I still get the same error in the boot.log and catalina.out, as I my previous post.</p>

<p>Does anybody could think of another hint for me how I could resolve this?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by willibald17 at May 06, 2014 21:23
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22886311"></a>
                                    <font class="smallfont"><p>Looks like you don't have a zwave device with id 10.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at May 06, 2014 21:27
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:43</font></td>
		    </tr>
	    </table>
    </body>
</html>