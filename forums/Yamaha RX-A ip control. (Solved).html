<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Yamaha RX-A ip control. (Solved)</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Yamaha RX-A ip control. (Solved)
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on May 28, 2015 by <font color="#0050B2">edito</font>.
				    </div>

				    <p>Until now i was looking information to send commands to my Yamaha receiver with no success.</p>

<p>Any of the members of the forums have the knowledge  sending commands to the Yamaha over the network. </p>

<p>Note: I have the network stand by on and port 50000 like are supposed to be but nothing</p>

<p>Suggestions please.</p>

<p>Edito </p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/23599083/23789869.png">controller xml screen.PNG</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/23599083/23789870.png">yamaha command designer screen.PNG</a> (image/png)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-23599093"></a>
                                    <font class="smallfont"><p>I have it working great, what model do you have?</p>

<p>It's a HTTP Post with XPath.</p>

<p>Here is an example</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
&lt;?xml version=<span class="code-quote">"1.0"</span> encoding=<span class="code-quote">"utf-8"</span>?&gt;
&lt;YAMAHA_AV cmd=<span class="code-quote">"GET"</span>&gt;
&lt;Zone_2&gt;
    &lt;Volume&gt;
        &lt;Lvl&gt;GetParam&lt;/Lvl&gt;
    &lt;/Volume&gt;
&lt;/Zone_2&gt;
&lt;/YAMAHA_AV&gt;
</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by glennl at May 19, 2015 11:01
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23599098"></a>
                                    <font class="smallfont"><p>Hi Glenn.  I'm happy for you.</p>

<p>I have a rx-a830</p>

<p>Actually my problem is at communication level. (java.net.MalformedURLException: no protocol :192.168.10.200)</p>

<p>but if i type the address in chrome the receiver can be ontrolled.</p>

<p>In the controller.xml i have this</p>

<p><img src="attachments/23599083/23789869.png" align="absmiddle" border="0"/></p>

<p>In designer </p>

<p><img src="attachments/23599083/23789870.png" align="absmiddle" border="0"/></p>


<p>As i can see you are getting the volume in you zone 2</p>

<p>I'll be trying to solve the java error and later review the syntax of the xpath.</p>

<p>thanks.</p>

<p>Edito</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by edito at May 19, 2015 13:27
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23599099"></a>
                                    <font class="smallfont"><p>Your URL is wrong it should be something like this <a href="http://192.168.0.12/YamahaRemoteControl/ctrl">http://192.168.0.12/YamahaRemoteControl/ctrl</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by glennl at May 19, 2015 13:29
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23599100"></a>
                                    <font class="smallfont"><p>Glenn can you show me how look you URL and xpath lines  for power on command?</p>

<p>I can't meke it work. i'm considering take the infrared road.  </p>

</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by edito at May 19, 2015 14:12
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23599126"></a>
                                    <font class="smallfont"><p>Here you go, do not just add this to your controller file you need to add it via the GUI.</p>

<p>Your mistake is you are putting the XML in the XPath, you have to put it in the workload. </p>

<p>You use the XPath for Get values eg getting the current volume</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
  &lt;command id=<span class="code-quote">"1950"</span> protocol=<span class="code-quote">"http"</span>&gt;
      &lt;property name=<span class="code-quote">"workload"</span> value=<span class="code-quote">"&lt;?xml version="</span>1.0<span class="code-quote">" encoding="</span>utf-8<span class="code-quote">"?&gt;&lt;YAMAHA_AV cmd="</span>PUT<span class="code-quote">"&gt;&lt;Main_Zone&gt;&lt;Power_Control&gt;&lt;Power&gt;On&lt;/Power&gt;&lt;/Power_Control&gt;&lt;/Main_Zone&gt;&lt;/YAMAHA_AV&gt;"</span> /&gt;
      &lt;property name=<span class="code-quote">"method"</span> value=<span class="code-quote">"POST"</span> /&gt;
      &lt;property name=<span class="code-quote">"url"</span> value=<span class="code-quote">"http:<span class="code-comment">//192.168.1.46/YamahaRemoteControl/ctrl"</span> /&gt;
</span>      &lt;property name=<span class="code-quote">"name"</span> value=<span class="code-quote">"(Office) Turn On"</span> /&gt;
    &lt;/command&gt;
</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by glennl at May 20, 2015 03:10
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23599132"></a>
                                    <font class="smallfont"><p>Now are working the power on, off, volume up and down thanks to you. Later i'll do the rest. </p>

<p>One more question, the range for the volume in the receiver is from -80 to +15  </p>

<p>in the modeler the values for the sensor should be like in the Yamaha or 0-99?</p>

<p>And Glenn Thanks.  When i finish with the ip control of the yamaha the next step will be refine the user interface.  That was one my reasons to choose openremote </p>

<p>so thanks you for you help in this finals steps.</p>

<p>Edito. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by edito at May 20, 2015 04:29
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23599135"></a>
                                    <font class="smallfont"><p>Trust me if you think that was hard you won't get the volume working, the slider control seems broken to me when it comes to the Yamaha for some reason it can't handle negatives.</p>

<p>I never found an easy way around it, I manually changed the panels.xml to be 0-99 but then kept the sensor - controller xml as -80 to 15</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
    &lt;sensor id=<span class="code-quote">"100137"</span> name=<span class="code-quote">"Amp Volume"</span> type=<span class="code-quote">"range"</span>&gt;
      &lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"1948"</span> /&gt;
      &lt;min value=<span class="code-quote">"-805"</span> /&gt;
      &lt;max value=<span class="code-quote">"100"</span> /&gt;
    &lt;/sensor&gt;
</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by glennl at May 20, 2015 07:20
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23599152"></a>
                                    <font class="smallfont"><p>Here i am again.</p>

<p>I can get the volume status from the Yamaha.  </p>

<p>the status command i created have the fallowing attributes:<br/>
Protocol: http<br/>
URL: <a href="http://receiver">http://receiver</a> ip/YamahaRemoteControl/ctrl<br/>
HTTP method: Post<br/>
Content type : text/plain<br/>
XPath expression: &lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;YAMAHA_AV cmd="GET"&gt;&lt;Main_Zone&gt;&lt;Volume&gt;&lt;Lvl&gt;GetParam&lt;/Lvl&gt;&lt;/Volume&gt;&lt;/Main_Zone&gt;&lt;/YAMAHA_AV&gt;<br/>
Polling interval: 30s</p>

<p>The sensor have the following properties<br/>
min: -805<br/>
max:100</p>

<p>The question is where is supposed to be pointed the slider<br/>
setValue <br/>
What command need to be tied to.</p>

<p>Edito</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by edito at May 20, 2015 23:30
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23599157"></a>
                                    <font class="smallfont"><p>It needs to be linked to the Get volume command</p>

<p>This is the last advise I am giving sorry, but you keep putting things in the wrong areas even after I have told you, that it is incorrect.</p>

<p>You put the information in the workload not the Xpath field, see below</p>

<p>Please look up other threads providing information on this.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
   &lt;command id=<span class="code-quote">"1948"</span> protocol=<span class="code-quote">"http"</span>&gt;
      &lt;property name=<span class="code-quote">"pollingInterval"</span> value=<span class="code-quote">"2s"</span> /&gt;
      &lt;property name=<span class="code-quote">"method"</span> value=<span class="code-quote">"GET"</span> /&gt;
      &lt;property name=<span class="code-quote">"url"</span> value=<span class="code-quote">"&lt;?xml version="</span>1.0<span class="code-quote">" encoding="</span>utf-8<span class="code-quote">"?&gt;&lt;YAMAHA_AV cmd="</span>GET<span class="code-quote">"&gt;&lt;Zone_2&gt;&lt;Volume&gt;&lt;Lvl&gt;GetParam&lt;/Lvl&gt;&lt;/Volume&gt;&lt;/Zone_2&gt;&lt;/YAMAHA_AV&gt;"</span> /&gt;
      &lt;property name=<span class="code-quote">"xpath"</span> value=<span class="code-quote">"/YAMAHA_AV[1]/Zone_2[1]/Volume[1]/Lvl[1]/Val"</span> /&gt;
      &lt;property name=<span class="code-quote">"name"</span> value=<span class="code-quote">"(Desk) Get Volume"</span> /&gt;
    &lt;/command&gt;
</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by glennl at May 21, 2015 06:02
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23599336"></a>
                                    <font class="smallfont"><p>Thanks a lot. Is working now.</p>

<p>Edito.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by edito at May 28, 2015 09:37
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:34</font></td>
		    </tr>
	    </table>
    </body>
</html>