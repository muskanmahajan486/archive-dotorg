<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Controlling OpenRemote Via VPN</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Controlling OpenRemote Via VPN
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Nov 19, 2015 by <font color="#0050B2">dmorell</font>.
				    </div>

				    <p>I am running Openremote professional on a Raspberry Pi server and have the application on my iPhone and iPad. I want the ability to control my home automation, (DSC security, lighting, thermostats, boiler control monitoring) outside of my local WIFI network via my iPhone. I am told I need to go through a VPN, which is fine, but I am having a hard time with the tutorials I am seeing online. I found one with readwrite, but it is confusing. Can anyone point me in the right direction/</p>

<p>Thanks.</p>

<p>Dev</p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/23602258/23789996.jpg">Doc2.jpg</a> (image/jpeg)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-23602266"></a>
                                    <font class="smallfont"><p>Hi Devin,</p>

<p>there are different options for setting up VPN possible. For iOS you have PPTP VPN and IPSec clients out of the box. Therefore, you will need to set-up PPTP or IPSec server on your LAN. What is the easiest way to do it depends on your infrastructure. Many routers have OpenVPN servers out of the box, which are more secure than PPTV VPN, but then you will need to configure OpenVPN client on you iOS device. Anyway, please describe your situation, especially where you want to run the server. For example, I have Synology NAS on my LAN, which comes with very easy to use VPN server and supports PPTP, IPSec and OpenVPN. Furthermore, you will need to set-up port forwarding on your router. Which ports to forward again depends of kind of VPN you are going to use.</p>

<p>If you want to start from scratch, then I would go with OpenVPN in UDP mode (default). Because it uses connectionless layer for transport (UPD) it handles all connection aspects. This way, it usually creates more robust connections that other solutions. I use it for RDP sessions, which runs for days, surviving hibernating my Mac and resuming connection without any problems when it wakes up.  </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Nov 20, 2015 11:21
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602270"></a>
                                    <font class="smallfont"><p>Hi Mike,<br/>
Thanks for the reply. My infrastructure is very simple. I have my cable modem connected to the a netgear WNR2000v2 roouter. Openremote is setup on a raspberry pi which is connected (hardwired) to the WNR2000. I am not sure if the WNR2000 has a VPN built in. The overall goal is to openremote on my ios device at work or say at dinner to turn on lights, check the security system, etc.. I have never set up a vpn so I am alittle confused as to  how it is setup.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dmorell at Nov 20, 2015 12:06
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602273"></a>
                                    <font class="smallfont"><p>Hi Devin,</p>

<p>This is the quite old router that you have and looking at its manual shows that it does not contain the VPN server. However, luckily for you, it supports DD-WRT, which in turn has VPN server. Therefore, this is what I would do in your setup. I'll install the DD-WRT firmware on your router (see <a href="https://www.youtube.com/watch?v=bOeBfLPI4WM">https://www.youtube.com/watch?v=bOeBfLPI4WM</a> ) and go from there. </p>

<p>The other option would be to use raspberry for setting up the VPN server but I would not do this, as RP does not have hardware NIC (it uses USB to emulate NIC, therefore it needs to run software to be able to use it, therefore it is less robust than the solution with the router. Moreover, setting up the VPN server on a router is the most transparent and elegant solution).</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Nov 20, 2015 13:34
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602280"></a>
                                    <font class="smallfont"><p>Hi Mike,</p>

<p>Funny you mention that. After seeing your rely this morning I checked my manual on my router and noticed there was no VPN. Google showed me DD-WRT page. Do u need to rung my pi as static or dhcp? I read a tutorial from readwrite and it mentioned to go change the configuration file in /etc/network/ configuration from dhcp to static. After that I think that is what is cold using mybfeedback sensors not to work(dsc security with envisalink) on my status page in my gui. The other commands work just not feedback. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dmorell at Nov 20, 2015 14:52
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602301"></a>
                                    <font class="smallfont"><p>Hi Devin,</p>

<p>I would not touch /etc/network/interface, unless you know what you are doing. Leaving DHCP is the best option, otherwise you can brick your device if you are not careful. The better option is to preassign a DHCP address in your router configuration so the Raspberry will always get the same IP.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Nov 21, 2015 11:55
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602312"></a>
                                    <font class="smallfont"><p>Hi Mike,</p>

<p>I setup my router with DD-wrt with success. I used the tutorial from dd-wrt on setting up a vpn using PPTP. Now I can see to setup up a vpn on my iphone but not sure where to go from here. It seems I have a connection via wifi but 3g of lte doesnt seem to have a connection. Also how would I connect to to openremote?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dmorell at Nov 23, 2015 02:33
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602318"></a>
                                    <font class="smallfont"><p>Hi Devin,</p>

<p>you are almost there. In order to log-in into your VPN server through 3g or any remote network you need to configure it to log-in through your external IP address. To check your external IP address you can go to <a href="https://www.whatismyip.com/">https://www.whatismyip.com/</a><br/>
Please check that this is the same address as your DD-WRT shows as WAN address. Now, it depends on your ISP if this address is static or dynamic (i.e. changing with every reboot of your cable modem). If it is static then you are all set. If it is dynamic, then you need to set up dynamic DNS and use it instead. How to do it with openremote you can find on my blog <a href="http://mqlservice.net/openremote/2014/05/10/no-more-free-dyndns-time-for-ordns/">http://mqlservice.net/openremote/2014/05/10/no-more-free-dyndns-time-for-ordns/</a></p>

<p>After establishing the VPN tunnel from outside you should see your local LAN devices as if you were directly connected to it through WiFi. Then you can connect to openremote controller the usual way.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Nov 23, 2015 11:05
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602324"></a>
                                    <font class="smallfont"><p>Ok,</p>

<p>Ill try and work on that tonight. Are you familiar with sensors not working in openremote? All of a sudden, my sensors and commands are not working in openremote. I changed the IP address for my commands when I rebooted my router so I know the ip address' are ok. I checked the password under the configuration file.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dmorell at Nov 23, 2015 14:27
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602368"></a>
                                    <font class="smallfont"><p>Hi Devin,</p>

<p>About a year ago I was in the same situation with the VPN configuration.</p>

<p>I document the process for my personal use, but you can use it if you want.<br/>
It's not perfect, the idea was to create a shell script to automate the process of installation and configuration of openremote and some other things that I used.</p>

<p><a href="https://docs.google.com/spreadsheets/d/15uiF5NRoppSE3xrBw9oXjb7EsdOfTf1bDhngc9P9O4s/edit?usp=sharing">CONFIGURATION</a></p>

<p>I am currently not active with my automation projects, but I hope this helps.</p>

<p>I found that the remote control through VPNs with openremote is not ideal, because you must keep the vpn connection active on your mobile device and this leads to the use more data (mobile data and data transmission through vpn), Also, if you want to disable or enable the VPN connection each time you use the openremote app, the application fails or loses the panels configuration.</p>

<p>I created a procedure through tasker so that each time the openremote app was activated the vpn connection too, I got similar results.</p>

<p>Next year I'll be active with my automation projects and I will try something different for the remote control of my environments through openremote.</p>

<p>Cheers,<br/>
EDGI</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by edgi at Nov 25, 2015 14:54
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:30</font></td>
		    </tr>
	    </table>
    </body>
</html>