<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : (solved) NTLM not working for HTTP GET</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : (solved) NTLM not working for HTTP GET
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jan 15, 2016 by <font color="#0050B2">ice3362</font>.
				    </div>

				    <p>Hi all,</p>

<p>I've been having problems connecting to an http server using NTLM authentication.  As far as I can tell, OR should be able to support authentication using NTLM, but I get the following error.</p>

<p>2016-01-13 13:47:31,571 WARN [Polling thread for sensor: sensor1]: Authentication scheme ntlm not supported<br/>
2016-01-13 13:47:31,573 WARN [Polling thread for sensor: sensor1]: Authentication error: Unable to respond to any of these challenges: {ntlm=WWW-Authenticate: NTLM, negotiate=WWW-Authenticate: Negotiate}<br/>
2016-01-13 13:47:31,575 ERROR [Polling thread for sensor: sensor1]: ClientProtocolException when executing HTTP method<br/>
org.apache.http.client.HttpResponseException: Unauthorized<br/>
        at org.apache.http.impl.client.BasicResponseHandler.handleResponse(BasicResponseHandler.java:67)<br/>
        at org.apache.http.impl.client.BasicResponseHandler.handleResponse(BasicResponseHandler.java:54)<br/>
        at org.openremote.controller.protocol.http.HttpGetCommand.requestURL(HttpGetCommand.java:238)<br/>
        at org.openremote.controller.protocol.http.HttpGetCommand.run(HttpGetCommand.java:260)<br/>
        at java.lang.Thread.run(Thread.java:745)</p>


<p>Here is the part of the log that shows the settings for the HTTP command I created in designer:</p>

<p>2016-01-13 16:38:41,163 DEBUG [main]: Building HttGetCommand<br/>
2016-01-13 16:38:41,167 DEBUG [main]: HttpGetCommand: username = COMPUTER/USER<br/>
2016-01-13 16:38:41,168 DEBUG [main]: HttpGetCommand: regex = (on|off)<br/>
2016-01-13 16:38:41,169 DEBUG [main]: HttpGetCommand: pollingInterval = 10s<br/>
2016-01-13 16:38:41,170 DEBUG [main]: HttpGetCommand: method = GET<br/>
2016-01-13 16:38:41,171 DEBUG [main]: HttpGetCommand: contentTyoe = application/text<br/>
2016-01-13 16:38:41,172 DEBUG [main]: HttpGetCommand: password = PASS<br/>
2016-01-13 16:38:41,173 DEBUG [main]: HttpGetCommand: url = <a href="http://COMPUTER:PORT/?command=power">http://COMPUTER:PORT/?command=power</a></p>


<p>curl works with NTLM authentication using the same credentials.  I get expected result every time, which is the power state of a device connected to COMPUTER.  this even works if I use it in a shell execution protocol:</p>

<p>curl -X GET "http://COMPUTER:PORT/?command=power" --ntlm -u COMPUTER/USER:PASS</p>

<p>I am using OR on a raspberry pi running raspbian 'jessie'.  Java SDK 1.8.0</p>

<p>can anyone help me determine why NTLM auth is not working with the HTTP command in OR?</p>

<p>Thanks in advance!</p>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:32</font></td>
		    </tr>
	    </table>
    </body>
</html>