<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Designer went crazy.</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Designer went crazy.
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jun 18, 2013 by <font color="#0050B2">juha</font>.
				    </div>

				    <p>I have removed this from the infrastructure thread.</p>

<p>I have added a few "lock-on-active" statements this afternoon.<br/>
I have tried to save the changes to the rules but did not get any respond. I got the impression the Designer is dead from some reason.<br/>
I have switched from Chrome to IE back and forth, tried a few times including changing attention from rules editor to some of the panels I have designed.<br/>
After a while saving was confirmed but....<br/>
From there onward, I am getting all kind of errors even when I have removed the "lock-on-active" statements like in ability to find a sensor etc.<br/>
I have no idea what is wrong. Most of the system is working but some buttons do not work. I was fine for a few months now.</p>

<p>So I did some digging.<br/>
It looks like the Designer has created wrong indexing of the sensors.</p>

<p>See the following for example: look for 187, 990 and 295 and see the error). 295 is linked to Switch 990 and to 187. There are few such error but the error is identical.<br/>
I post the controller.xml file.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-xml">
<span class="code-tag">&lt;?xml version=<span class="code-quote">"1.0"</span> encoding=<span class="code-quote">"UTF-8"</span>?&gt;</span>
&lt;openremote xmlns=<span class="code-quote">"http://www.openremote.org"</span> 
            <span class="code-keyword">xmlns:xsi</span>=<span class="code-quote">"http://www.w3.org/2001/XMLSchema-instance"</span> 
            xsi:schemaLocation="http://www.openremote.org 
            http://www.openremote.org/schemas/controller.xsd"&gt;
  <span class="code-tag">&lt;components&gt;</span>
    <span class="code-tag">&lt;switch id=<span class="code-quote">"1220"</span>&gt;</span>
      <span class="code-tag">&lt;on&gt;</span>
        <span class="code-tag">&lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"291"</span> /&gt;</span>
      <span class="code-tag">&lt;/on&gt;</span>
      <span class="code-tag">&lt;off&gt;</span>
        <span class="code-tag">&lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"289"</span> /&gt;</span>
      <span class="code-tag">&lt;/off&gt;</span>
      <span class="code-tag">&lt;include type=<span class="code-quote">"sensor"</span> ref=<span class="code-quote">"348"</span> /&gt;</span>
    <span class="code-tag">&lt;/switch&gt;</span>
    <span class="code-tag">&lt;switch id=<span class="code-quote">"274"</span>&gt;</span>
      <span class="code-tag">&lt;on&gt;</span>
        <span class="code-tag">&lt;include type=<span class="code-quote">"command"</span> ref=<span class="code-quote">"27"</span> /&gt;</span>
      <span class="code-tag">&lt;/on&gt;</span>
      <span class="code-tag">&lt;off&gt;</span>
  
   
   \[... CLIPPED A VERY LONG OUTPUT ...]


    <span class="code-tag">&lt;command id=<span class="code-quote">"293"</span> protocol=<span class="code-quote">"knx"</span>&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"command"</span> value=<span class="code-quote">"status"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"groupAddress"</span> value=<span class="code-quote">"7/1/102"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"DPT"</span> value=<span class="code-quote">"1.001"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"name"</span> value=<span class="code-quote">"Irrigation (STATUS)"</span> /&gt;</span>
    <span class="code-tag">&lt;/command&gt;</span>
    <span class="code-tag">&lt;command id=<span class="code-quote">"294"</span> protocol=<span class="code-quote">"knx"</span>&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"command"</span> value=<span class="code-quote">"off"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"groupAddress"</span> value=<span class="code-quote">"7/1/2"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"DPT"</span> value=<span class="code-quote">"1.001"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"name"</span> value=<span class="code-quote">"Irrigation (OFF)"</span> /&gt;</span>
    <span class="code-tag">&lt;/command&gt;</span>
    <span class="code-tag">&lt;command id=<span class="code-quote">"7"</span> protocol=<span class="code-quote">"shellexe"</span>&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"commandPath"</span> value=<span class="code-quote">"~/openremote-shell-commands/WT_Off.sh"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"name"</span> value=<span class="code-quote">"Send WT Off Mail"</span> /&gt;</span>
    <span class="code-tag">&lt;/command&gt;</span>
    <span class="code-tag">&lt;command id=<span class="code-quote">"282"</span> protocol=<span class="code-quote">"shellexe"</span>&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"commandPath"</span> value=<span class="code-quote">"~/openremote-shell-commands/WT_On.sh"</span> /&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"name"</span> value=<span class="code-quote">"Send WT On Mail"</span> /&gt;</span>
    <span class="code-tag">&lt;/command&gt;</span>
  <span class="code-tag">&lt;/commands&gt;</span>
  <span class="code-tag">&lt;config&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"controller.roundrobin.multicast.port"</span> value=<span class="code-quote">"10000"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"controller.roundrobin.tcpserver.port"</span> value=<span class="code-quote">"20000"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"controller.groupname"</span> value=<span class="code-quote">"floor20"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"multicast.port"</span> value=<span class="code-quote">"3333"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"controller.groupmember.autodetect.on"</span> value=<span class="code-quote">"true"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"amx_ni.port"</span> value=<span class="code-quote">"50000"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"zwave.commLayer"</span> value="" /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"copy.lircd.conf.on"</span> value=<span class="code-quote">"true"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"irsend.path"</span> value=<span class="code-quote">"/usr/local/bin/irsend"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"controller.applicationname"</span> value=<span class="code-quote">"controller"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"multicast.address"</span> value=<span class="code-quote">"224.0.23.12"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"Macro.IR.Execution.Delay"</span> value=<span class="code-quote">"500"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"controller.roundrobin.multicast.address"</span> value=<span class="code-quote">"224.0.1.200"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"zwave.comPort"</span> value="" /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"zwave.pad.port"</span> value=<span class="code-quote">"7876"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"lutron_homeworks.password"</span> value=<span class="code-quote">"openremote"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"lircd.conf.path"</span> value=<span class="code-quote">"/etc/lircd.conf"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"lutron_homeworks.port"</span> value=<span class="code-quote">"23"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"lutron_homeworks.address"</span> value=<span class="code-quote">"192.168.1.1"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"zwave.pad.host"</span> value=<span class="code-quote">"localhost"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"lutron_homeworks.username"</span> value=<span class="code-quote">"openremote"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"webapp.port"</span> value=<span class="code-quote">"8082"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"protocol.zwave.classname"</span> value=<span class="code-quote">"org.openremote.controller.protocol.zwave.ZWaveCommandBuilder"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"resource.upload.enable"</span> value=<span class="code-quote">"true"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"amx_ni.address"</span> value=<span class="code-quote">"192.168.1.1"</span> /&gt;</span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"lagarto_network.broadcast"</span> value=<span class="code-quote">"tcp://127.0.0.1:5001"</span> /&gt;</span>
  <span class="code-tag">&lt;/config&gt;</span>
<span class="code-tag">&lt;/openremote&gt;</span>
</pre>
</div></div>


<p>As far as I have seen, I am not the only one having this situation. Do not remember what was the topic and how it was resolved.</p>

<p>Need help from Admin.</p>

				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-22872990"></a>
                                    <font class="smallfont"><p>Your account panels were restored to a copy from June 17th and were again working correctly in my tests.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Jun 18, 2013 11:31
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22873028"></a>
                                    <font class="smallfont"><p>Hi Juha.</p>

<p>I will put back all my rules and see if all is OK. </p>

<p>Can you tell me what happened?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Jun 18, 2013 15:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22873071"></a>
                                    <font class="smallfont"><p>There was an index variable which for some reason wasn't restored correctly on loading your account data into designer and was reset to zero. The designer code didn't spot this error and therefore continued to save a new version of your design using a wrong index. This caused the duplicate IDs in the controller.xml which lead to the errors you saw.</p>

<p>Rolling back to a previously saved designer data restored the issue which included the correct index value and therefore saved component IDs correctly.</p>

<p>How the original index value read failed is still not clear.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Jun 19, 2013 11:19
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22873097"></a>
                                    <font class="smallfont"><p>Hi Juha.</p>

<p>1. Now all is OK.<br/>
2. As I have told you the server had some kind of lag. A very long one which efectively did not perform saving at all.<br/>
Thanks for helping.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Jun 19, 2013 15:46
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:30</font></td>
		    </tr>
	    </table>
    </body>
</html>