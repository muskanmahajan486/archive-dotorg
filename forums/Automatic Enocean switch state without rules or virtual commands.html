<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Automatic Enocean switch state without rules or virtual commands</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Automatic Enocean switch state without rules or virtual commands
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Dec 29, 2013 by <font color="#0050B2">bass</font>.
				    </div>

				    <p>Hi guys,</p>

<p>In Rainer Hitz's wonderful Enocean protocol implementation, I added an automatic state function for Enocean switches without using virtual commands or rules.</p>

<p>Most of the switches/actuators in our house are of the unidirectional Enocean type.<br/>
I did however want to display the actual switch state (on/off) whether switched by the actual hardware switch or through software (Ipad).<br/>
The only solution to keep the state in sync with the actual hardware was to use virtual commands next to the actual hardware commands and combine this with some additional rules.</p>

<p>Here's the setup you would need for a <b>single</b> switch to maintain its proper state:</p>

<p><img src="attachments/22881838/23036350.jpg" align="absmiddle" border="0"/></p>

<p>Yes, quite a hassle.. and the naming convention is very important as well as to not make the rules equally as long..</p>

<p>Anyways...</p>

<p>I can now set up a single switch <b>without</b> any additional rules like so:</p>

<p><img src="attachments/22881838/23036351.jpg" align="absmiddle" border="0"/> </p>

<p>As you can see all the virtual commands are gone and all you need to do is add the original (hardware) switch's Device ID to the send command's "Device ID" field (separated from the send ID by a pipe char):</p>

<p><img src="attachments/22881838/23036352.jpg" align="absmiddle" border="0"/></p>

<p>In this example, clicking the software switch will now send "ON_ROCKER_A" to device ID 0x01 which you linked to the actuator, but in addition it will also set the correct state (ON) for any sensor object with device ID: 0x001E42B7 and "STATUS_ROCKER_A".</p>

<p>This is the status command used by the sensor:</p>

<p><img src="attachments/22881838/23036353.jpg" align="absmiddle" border="0"/></p>


<p>I'm not sure if Rainer Hitz would've taken the same approach to implement this, but I hope he's willing to have a look at the code to see if we can merge this solution into the code. It would also be nice if we'd have a separate field for the linkID instead of having to add it to the Device ID using the pipe char.</p>

<p>Should anyone want to try it, let me know and I can send you the files.</p>

<p>Thanks again for a wonderful job on this piece of software guys!</p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22881838/23036350.jpg">OpenRemote Designer_2013-12-29_08-03-28.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22881838/23036351.jpg">OpenRemote Designer_2013-12-29_08-10-18.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22881838/23036352.jpg">OpenRemote Designer_2013-12-29_08-18-48.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22881838/23036353.jpg">OpenRemote Designer_2013-12-29_08-25-33.jpg</a> (image/jpeg)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-22881848"></a>
                                    <font class="smallfont"><p>Ugh <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> I just realized that I have lights which are controlled by multiple switches..<br/>
Hmm now i'd still have to resort to rules to have the software button indicate the correct state when switched by multiple hardware switches...</p>

<p>I'll probably look into adding this functionality to the code later today..</p>

<p>Question: as i'll probably have to add multiple ID's to the single ID field.. what is the procedure of getting a field added to the designer? (no rush, the single field will probably do for now)</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by bass at Dec 29, 2013 08:14
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:29</font></td>
		    </tr>
	    </table>
    </body>
</html>