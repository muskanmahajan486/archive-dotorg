<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : json problem</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : json problem
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Dec 28, 2015 by <font color="#0050B2">arnoldg</font>.
				    </div>

				    <p>Hello, </p>

<p>I have a small problem with a json string.</p>

<p>i made a command</p>

<p>url : huis.******.nl:8080/json.htm?type=devices&amp;rid=43<br/>
http methode :Get</p>

<p>polling: 10s<br/>
jsonpath: $.result\*.SetPoint</p>


<p>The result is like below.</p>

<p>When i use a custom sensor, the result in a label is [ "20.5" ]<br/>
How can i trim [ " and " ] from the label or is there a way to put the value in a slider, to change the setpoint. </p>


<p>HOW DO I PLACE CODE TAGS ARNOLD MY JSON QUERY IN THIS FORUM ?</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
   <span class="code-quote">"ActTime"</span> : 1451212321,
   <span class="code-quote">"ServerTime"</span> : <span class="code-quote">"2015-12-27 11:32:01"</span>,
   <span class="code-quote">"Sunrise"</span> : <span class="code-quote">"08:44"</span>,
   <span class="code-quote">"Sunset"</span> : <span class="code-quote">"16:24"</span>,
   <span class="code-quote">"result"</span> : [
      
         <span class="code-quote">"AddjMulti"</span> : 1.0,
         <span class="code-quote">"AddjMulti2"</span> : 1.0,
         <span class="code-quote">"AddjValue"</span> : 0.0,
         <span class="code-quote">"AddjValue2"</span> : 0.0,
         <span class="code-quote">"BatteryLevel"</span> : 255,
         <span class="code-quote">"CustomImage"</span> : 0,
         <span class="code-quote">"Data"</span> : <span class="code-quote">"20.5"</span>,
         <span class="code-quote">"Description"</span> : "",
         <span class="code-quote">"Favorite"</span> : 0,
         <span class="code-quote">"HardwareID"</span> : 7,
         <span class="code-quote">"HardwareName"</span> : <span class="code-quote">"Opentherm gateway"</span>,
         <span class="code-quote">"HardwareType"</span> : <span class="code-quote">"OpenTherm Gateway USB"</span>,
         <span class="code-quote">"HardwareTypeVal"</span> : 18,
         <span class="code-quote">"HaveTimeout"</span> : <span class="code-keyword">true</span>,
         <span class="code-quote">"ID"</span> : <span class="code-quote">"0000005"</span>,
         <span class="code-quote">"LastUpdate"</span> : <span class="code-quote">"2015-12-20 15:21:57"</span>,
         <span class="code-quote">"Name"</span> : <span class="code-quote">"Gewenste temperatuur"</span>,
         <span class="code-quote">"Notifications"</span> : <span class="code-quote">"<span class="code-keyword">false</span>"</span>,
         <span class="code-quote">"PlanID"</span> : <span class="code-quote">"0"</span>,
         <span class="code-quote">"PlanIDs"</span> : [ 0 ],
         <span class="code-quote">"Protected"</span> : <span class="code-keyword">false</span>,
         <span class="code-quote">"SetPoint"</span> : <span class="code-quote">"20.5"</span>,
         <span class="code-quote">"ShowNotifications"</span> : <span class="code-keyword">true</span>,
         <span class="code-quote">"SignalLevel"</span> : <span class="code-quote">"-"</span>,
         <span class="code-quote">"SubType"</span> : <span class="code-quote">"SetPoint"</span>,
         <span class="code-quote">"Timers"</span> : <span class="code-quote">"<span class="code-keyword">false</span>"</span>,
         <span class="code-quote">"Type"</span> : <span class="code-quote">"Thermostat"</span>,
         <span class="code-quote">"TypeImg"</span> : <span class="code-quote">"override_mini"</span>,
         <span class="code-quote">"Unit"</span> : 0,
         <span class="code-quote">"Used"</span> : 1,
         <span class="code-quote">"XOffset"</span> : <span class="code-quote">"0"</span>,
         <span class="code-quote">"YOffset"</span> : <span class="code-quote">"0"</span>,
         <span class="code-quote">"idx"</span> : <span class="code-quote">"43"</span>
    
   ],
   <span class="code-quote">"status"</span> : <span class="code-quote">"OK"</span>,
   <span class="code-quote">"title"</span> : <span class="code-quote">"Devices"</span>
</pre>
</div></div>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/23602812/23790023.jpg">command.jpg</a> (image/jpeg)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-23602828"></a>
                                    <font class="smallfont"><p>1) Please include you code in {code}{code} tags for better readability<br/>
2) In the past I have used <div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">[0-9]{0,}[.]{0,1}[0-9]{0,2}</pre>
</div></div> in the <em>RegEx field</em>. It limits the number to 2 decimal positions</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Dec 28, 2015 09:46
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602833"></a>
                                    <font class="smallfont"><p>After putting </p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
[0-9]{0,}[.]{0,1}[0-9]{0,2}
</pre>
</div></div>

<p>i get n/a in the label, so it seems that it isn't working <br/>
what could be wrong. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by arnoldg at Dec 28, 2015 11:01
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602834"></a>
                                    <font class="smallfont"><p>I must admit I only tried this RegEx combined with XPath Never with JSONPath. <br/>
Just a wild guess; maybe you need to put it in brackets there</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">([0-9]{0,}[.]{0,1}[0-9]{0,2})</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Dec 28, 2015 11:22
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602835"></a>
                                    <font class="smallfont"><p>This also doesn't work. </p>

<p>i think the regex is procesed before the json result is availebel. <br/>
but i don't how to check if this is thru</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by arnoldg at Dec 28, 2015 11:28
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602836"></a>
                                    <font class="smallfont"><p><a href="http://jsonlint.com/">http://jsonlint.com/</a> tells me that your JSON is not valid. So I can't do more testing</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Dec 28, 2015 12:28
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602838"></a>
                                    <font class="smallfont"><p>that is becaus i didn't know how to post it correct.<br/>
Below is the correct json string, and if tested in the above link it is a "Valid JSON"</p>

<p>what could i try next. </p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
{
   <span class="code-quote">"ActTime"</span> : 1451314497,
   <span class="code-quote">"ServerTime"</span> : <span class="code-quote">"2015-12-28 15:54:57"</span>,
   <span class="code-quote">"Sunrise"</span> : <span class="code-quote">"08:44"</span>,
   <span class="code-quote">"Sunset"</span> : <span class="code-quote">"16:25"</span>,
   <span class="code-quote">"result"</span> : [
      {
         <span class="code-quote">"AddjMulti"</span> : 1.0,
         <span class="code-quote">"AddjMulti2"</span> : 1.0,
         <span class="code-quote">"AddjValue"</span> : 0.0,
         <span class="code-quote">"AddjValue2"</span> : 0.0,
         <span class="code-quote">"BatteryLevel"</span> : 255,
         <span class="code-quote">"CustomImage"</span> : 0,
         <span class="code-quote">"Data"</span> : <span class="code-quote">"20.5"</span>,
         <span class="code-quote">"Description"</span> : "",
         <span class="code-quote">"Favorite"</span> : 0,
         <span class="code-quote">"HardwareID"</span> : 7,
         <span class="code-quote">"HardwareName"</span> : <span class="code-quote">"Opentherm gateway"</span>,
         <span class="code-quote">"HardwareType"</span> : <span class="code-quote">"OpenTherm Gateway USB"</span>,
         <span class="code-quote">"HardwareTypeVal"</span> : 18,
         <span class="code-quote">"HaveTimeout"</span> : <span class="code-keyword">true</span>,
         <span class="code-quote">"ID"</span> : <span class="code-quote">"0000005"</span>,
         <span class="code-quote">"LastUpdate"</span> : <span class="code-quote">"2015-12-20 15:21:57"</span>,
         <span class="code-quote">"Name"</span> : <span class="code-quote">"Gewenste temperatuur"</span>,
         <span class="code-quote">"Notifications"</span> : <span class="code-quote">"<span class="code-keyword">false</span>"</span>,
         <span class="code-quote">"PlanID"</span> : <span class="code-quote">"0"</span>,
         <span class="code-quote">"PlanIDs"</span> : [ 0 ],
         <span class="code-quote">"Protected"</span> : <span class="code-keyword">false</span>,
         <span class="code-quote">"SetPoint"</span> : <span class="code-quote">"20.5"</span>,
         <span class="code-quote">"ShowNotifications"</span> : <span class="code-keyword">true</span>,
         <span class="code-quote">"SignalLevel"</span> : <span class="code-quote">"-"</span>,
         <span class="code-quote">"SubType"</span> : <span class="code-quote">"SetPoint"</span>,
         <span class="code-quote">"Timers"</span> : <span class="code-quote">"<span class="code-keyword">false</span>"</span>,
         <span class="code-quote">"Type"</span> : <span class="code-quote">"Thermostat"</span>,
         <span class="code-quote">"TypeImg"</span> : <span class="code-quote">"override_mini"</span>,
         <span class="code-quote">"Unit"</span> : 0,
         <span class="code-quote">"Used"</span> : 1,
         <span class="code-quote">"XOffset"</span> : <span class="code-quote">"0"</span>,
         <span class="code-quote">"YOffset"</span> : <span class="code-quote">"0"</span>,
         <span class="code-quote">"idx"</span> : <span class="code-quote">"43"</span>
      }
   ],
   <span class="code-quote">"status"</span> : <span class="code-quote">"OK"</span>,
   <span class="code-quote">"title"</span> : <span class="code-quote">"Devices"</span>
}
</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by arnoldg at Dec 28, 2015 14:55
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602843"></a>
                                    <font class="smallfont"><p>Sorry, I can't help you any further. Pro release 1.4 has problems since almost 2 weeks on my Synology, so it won't start anymore. So I can't mimic your system here. I have to leave this to others.</p>

<p>I am waiting for a kind soul that either fixes 1.4, or provides me with a Pro 1.3 controller package ( I accidentally lost that one)</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Dec 28, 2015 20:04
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602853"></a>
                                    <font class="smallfont"><p>@PZ1</p>

<p>Drop me an email and I'll send you a link to my archive zip of OR_Pro1.3</p>

<p>Cheers</p>

<p>Stuart</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mdar at Dec 29, 2015 13:11
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602893"></a>
                                    <font class="smallfont"><p>This v1.3 works fine now. Thanks.<br/>
Getting it working properly was a pain. For some reason, I do not yet understand, a http command to TTN LoraWAN messed up my system. After removing (designer 1.4) and syncing that (controller 1.3) my OpenRemote side id working fine again.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Dec 30, 2015 11:50
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602901"></a>
                                    <font class="smallfont"><p>how did you  remove designer 1.4 ?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by yogs at Dec 30, 2015 15:31
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602904"></a>
                                    <font class="smallfont"><p>please us a own topic to discus the problem's installing/removing openremote. and stick to my problem <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>which is still not solved <img class="emoticon" src="images/icons/emoticons/sad.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by arnoldg at Dec 30, 2015 18:20
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602905"></a>
                                    <font class="smallfont"><blockquote><p>stick to my problem which is still not solved</p></blockquote> 

<p>You are right. Just tried accessing from my OR your json file. Unfortunately I get the same results as you do:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"> [ <span class="code-quote">"20.5"</span> ]</pre>
</div></div>

<p>When I try the same in this <a href="http://jsonpath.com/">JSONPath tester</a> I do get the correct "20.5"<br/>
Also with JSONPath <div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">$.result.[SetPoint]</pre>
</div></div> result is the same.</p>

<p>I tried a couple of variants of that jsonPath with no success. Looks like the JSONPath Expression in OpenRemote does not deal with arrays.<br/>
Sorry I have no solution for you. Hopefully someone more experienced with JSONPath can point us in the right direction</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Dec 30, 2015 20:06
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23603090"></a>
                                    <font class="smallfont"><p>Hi there Arnold,</p>

<p>maybe a bit off topic but i was wondering how te get the temperature data from the opentherm gateway.<br/>
Im a noob on JSON so i havent got any clue how to make the HTTP get command in the designer.<br/>
in the designer i made a command like this, probably complety wrong. can you help me out on this?<br/>
I got the opentherm gateway usb connected on the same pc as the openremote server and got the otmonitor up and running with a responding web page on port 8081.<br/>
<img src="attachments/23602812/23790023.jpg" align="absmiddle" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by bgroot at Jan 09, 2016 10:47
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23603092"></a>
                                    <font class="smallfont"><p>never go off topic, that is not respectful!<br/>
Please open new topic with more precise title. If possible also try to publish the the full json that is returned by the command using the url in a webbrowser. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Jan 09, 2016 18:05
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:33</font></td>
		    </tr>
	    </table>
    </body>
</html>