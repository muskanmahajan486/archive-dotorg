<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Emails, Text-to-Speech, Serial Port</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Emails, Text-to-Speech, Serial Port
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jul 30, 2013 by <font color="#0050B2">juha</font>.
				    </div>

				    
<p>There's a new contribution available for testing. Lawrie Griffiths has added text-to-speech capabilities, easier way to configure email sending in designer and rules, and a direct serial port access to makers who like to interacts with Arduinos and other similar serial controlled devices.</p>

<p>You will need to download a new development binary from <a href="http://sourceforge.net/projects/openremote/files/For%20Developers/OpenRemote%202.2%20%28Development%20Releases%29/OpenRemote-Controller-2.2.0_TTS-Email-Serial.zip/download">OpenRemote-Controller-2.2.0_TTS-Email-Serial.zip</a></p>

<p>The protocol configurations are currently available in <a href="https://composer.openremote.org/preview">https://composer.openremote.org/preview</a> &#8211; IMPORTANT NOTE: if you do use your existing account with 'preview' 2.14 Markab version of the Designer, do NOT go back to using 2.13 'Rosemary' afterwards. This can lead to problems with your account data since the 2.14 'preview' is not backwards compatible with 2.13 Rosemary. </p>

<p>Lawrie will be following up with more detailed information about the new protocols, how to use them, etc.</p>


				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22874213/23035991.png">ttscommand.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22874213/23035992.png">say.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22874213/23036019.png">email.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22874213/23036020.png">fanoff.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22874213/23036021.png">power.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/22874213/23036022.png">emailparam.png</a> (image/png)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-22874266"></a>
                                    <font class="smallfont"><p>Relevant issues to track towards release:</p>

<p><a href="http://jira.openremote.org/browse/ORCJAVA-387">ORCJAVA-387</a><br/>
<a href="http://jira.openremote.org/browse/ORCJAVA-386">ORCJAVA-386</a><br/>
<a href="http://jira.openremote.org/browse/ORCJAVA-385">ORCJAVA-385</a></p>

<p>And:</p>

<p><a href="http://jira.openremote.org/browse/MODELER-511">MODELER-511</a><br/>
<a href="http://jira.openremote.org/browse/MODELER-510">MODELER-510</a><br/>
<a href="http://jira.openremote.org/browse/MODELER-509">MODELER-509</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Aug 01, 2013 11:51
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874271"></a>
                                    <font class="smallfont"><p>Here is how to use Text to Speech.</p>

<h2><a name="Emails%2CText-to-Speech%2CSerialPort-HowToTexttoSpeech"></a>How To - Text to Speech</h2>

<p>The OpenRemote 2.2 Controller has the capability to convert text to speech using the FreeTTS open source Java software. All defaults are used including the default voice - a male voice called Kevin. I have only tried English. Different voices may need to be created for other languages.</p>

<h3><a name="Emails%2CText-to-Speech%2CSerialPort-Createadevice"></a>Create a device</h3>

<p>The device name and properties are not important. You can use any device.</p>

<h3><a name="Emails%2CText-to-Speech%2CSerialPort-Addacommand"></a>Add a command</h3>

<p><a href="" title="Emails, Text-to-Speech, Serial Port"><img src="attachments/22874213/23035991.png" align="absmiddle" border="0"/></a></p>

<p>You can type in any text that you want spoken, and can include ${param} if you are invoking the command from a rule, e.g.:</p>

<p><a href="" title="Emails, Text-to-Speech, Serial Port"><img src="attachments/22874213/23035992.png" align="absmiddle" border="0"/></a></p>

<h3><a name="Emails%2CText-to-Speech%2CSerialPort-Speakingtextfromarule"></a>Speaking text from a rule</h3>

<p>You can write rules that give spoken alerts, for example:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
<span class="code-keyword">package</span> org.openremote.controller.protocol

global org.openremote.controller.statuscache.CommandFacade execute;

rule <span class="code-quote">"Execute Scheduled Command"</span>

  timer (<span class="code-object">int</span>: 0s 30s)

when

  eval(<span class="code-keyword">true</span>)
  
then
  
  execute.command(<span class="code-quote">"say"</span>, <span class="code-quote">"Parameter test"</span>);

end
</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Aug 01, 2013 12:38
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874637"></a>
                                    <font class="smallfont"><p>Here is how to use the Email protocol.</p>

<h2><a name="Emails%2CText-to-Speech%2CSerialPort-HowToEmail"></a>How To - Email</h2>

<p>The OpenRemote 2.2 Controller has the capability to send emails using JavaMail API. So far it has only been tested with gmail as the sending account.</p>

<p>The configuration properties for the Email protocol are in webapps/controller/WEB-INF/classes/config.properties.</p>

<p>You need to set the username and password of the sender, for example:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
# EMAIL CONFIGURATION:
# 
# Configuration related to the <span class="code-keyword">generic</span> email protocol
##
mail.smtps.host=smtp.gmail.com
mail.smtp.socketFactory.class=javax.net.ssl.SSLSocketFactory
mail.smtp.socketFactory.fallback="<span class="code-keyword">false</span>
mail.smtp.port=465
mail.smtp.socketFactory.port=465
mail.smtps.auth=<span class="code-keyword">true</span>
mail.smtps.quitwait=<span class="code-keyword">false</span>
email.domain=gmail.com
email.username=mygmailuser
email.password=mypassword
email.protocol=smtps
email.charset=utf-8
</pre>
</div></div>

<h3><a name="Emails%2CText-to-Speech%2CSerialPort-CreateaDevice"></a>Create a Device</h3>

<p>The device name and properties are not important. You can use any device.</p>

<h3><a name="Emails%2CText-to-Speech%2CSerialPort-AddaCommand"></a>Add a Command</h3>

<p><a href="" title="Emails, Text-to-Speech, Serial Port"><img src="attachments/22874213/23036019.png" align="absmiddle" border="0"/></a></p>

<p>You can type in any text as the subject of the email in the Subject field, and any text you want to send in the Message field. You can include ${param} if you are invoking the command from a rule:</p>

<p><a href="" title="Emails, Text-to-Speech, Serial Port"><img src="attachments/22874213/23036022.png" align="absmiddle" border="0"/></a></p>

<p>The recipient should be any valid email address that you want the email to be sent to.</p>

<h3><a name="Emails%2CText-to-Speech%2CSerialPort-Sendingemailsfromarule"></a>Sending emails from a rule</h3>

<p>You can write rules that send emails, for example:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
<span class="code-keyword">package</span> org.openremote.controller.protocol

global org.openremote.controller.statuscache.CommandFacade execute;

rule <span class="code-quote">"Execute Scheduled Command"</span>

  timer (<span class="code-object">int</span>: 0s 30s)

when

  eval(<span class="code-keyword">true</span>)
  
then
  
  execute.command(<span class="code-quote">"email"</span>, <span class="code-quote">"Parameter test"</span>);

end
</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Aug 12, 2013 11:56
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874696"></a>
                                    <font class="smallfont"><p>Here is how to use the generic Serial protocol:</p>

<h2><a name="Emails%2CText-to-Speech%2CSerialPort-HowToSerial"></a>How To - Serial</h2>

<p>The generic Serial protocol allows you to communicate with serial devices, such as Arduinos. It is not limited to the Arduino, but can be used with other serial devices that use similar serial data parameters to the Arduino.</p>

<p>Devices controlled by this protocol can be connected to your host computer using USB or another type of serial connection. The Java RXTX library is used to communicate with the device.</p>

<p>You can specify the COM port name of the device and its data rate. The connection to the device, once opened, is kept open. More than one OpenRemote device and more than one OpenRemote command can share the same serial connection.</p>

<p>The protocol can be used to send control commands, and also to read values from sensors.</p>

<h3><a name="Emails%2CText-to-Speech%2CSerialPort-CreateaDevice"></a>Create a Device</h3>

<p>The device name and properties are not important. You can use any device.</p>

<h3><a name="Emails%2CText-to-Speech%2CSerialPort-AddaCommand"></a>Add a Command</h3>

<p><a href="" title="Emails, Text-to-Speech, Serial Port"><img src="attachments/22874213/23036020.png" align="absmiddle" border="0"/></a></p>

<p>The format of the device name is dependant on your host computer. On Microsoft Windows, it is COMn or COMnn.</p>

<p>You should use the com port and data rate that your Arduino or other serial device has been configured to use.</p>

<h3><a name="Emails%2CText-to-Speech%2CSerialPort-Examples"></a>Examples</h3>

<h4><a name="Emails%2CText-to-Speech%2CSerialPort-ControllingaLightwaveRFdevice"></a>Controlling a LightwaveRF device</h4>

<p>You can use the protocol to control a multitude of different devices. One example is to control LightwaveRF switches and sockets, which are popular in the UK.</p>

<p>This method does not use the LightwaveRF Wifi Link, but controls the LightwaveRF devices directly via their RF protocol. To do this you need a 434Mhz RF transmitter connected to an Arduino or compatible device. You also need a suitable Sketch downloaded to your Arduino.</p>

<p>A suitable sketch is:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
#include &lt;LightwaveRF.h&gt;
                     
<span class="code-object">byte</span> myid[] = {0x6F,0xEB,0xBE,0xED,0xB7,0x7B};

void setup() {
  lw_setup();
  Serial.begin(9600);
}

void loop() {
  <span class="code-keyword">if</span> (Serial.available()) {
    <span class="code-object">char</span> c1 = Serial.read();
    <span class="code-keyword">while</span>(!Serial.available());
    <span class="code-object">char</span> c2 = Serial.read();
   
    <span class="code-keyword">if</span> (c2 &gt;= '0' &amp;&amp; c2 &lt;= '9') { <span class="code-comment">// device number
</span>      <span class="code-object">byte</span> d = c2 - '0';
      <span class="code-keyword">if</span> (c1 =='1') {
        Serial.println(<span class="code-quote">"Switch device on"</span>);
        lw_cmd(0,d,LW_ON,myid);
      } <span class="code-keyword">else</span> <span class="code-keyword">if</span> (c1 == '0') {
        Serial.println(<span class="code-quote">"Switch device off"</span>);
        lw_cmd(0,d,LW_OFF,myid);
      }
    }
  }
}
</pre>
</div></div>

<p>This sketch uses a library available at <a href="https://github.com/lawrie/LightwaveRF">https://github.com/lawrie/LightwaveRF</a>.</p>

<p>You will to change myid to the ID of a LightWaveRF that has been paired with your LightwaveRF socket of light switch. </p>

<p>The protocol that this sketch uses is very simple. Ypu send it two bytes. 1d turnrs the device on and 0d, turns the device off, where d is the channel number on your LightwaveRF remote. The sketch only supports channels 0-9. </p>

<p>The sketch, as supplied, supports up to 10 LightwaveRF devices, but could easily be modified to support 16, or more.</p>

<h4><a name="Emails%2CText-to-Speech%2CSerialPort-ReadingpowerfromanOPenEnergyMonitoremonTx"></a>Reading power from an OPenEnergyMonitor emonTx</h4>

<p>You can also use the generic serial protocol to read data from sensors.</p>

<p>This example read electrical power readings fom an OpenEnergyMonitor emonTx.</p>

<p>The emonTx transmits data using a HopeRF RFM12B radio at 434 or 868Mhx. You can use a variety of Arduino-compatible devices to read this data including a Jeelink - see <a href="http://jeelabs.com/products/jeelink">http://jeelabs.com/products/jeelink</a>.</p>

<p>A suitable sketch for this is:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
#include &lt;JeeLib.h&gt;
#include &lt;avr/eeprom.h&gt;
#include &lt;util/crc16.h&gt;

#define SERIAL_BAUD 57600
#define COLLECT 0x20 <span class="code-comment">// collect mode, i.e. pass incoming without sending acks
</span>
#define EMONTX_NODE 10
<span class="code-comment">// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span><span class="code-comment">// RF12 configuration setup code
</span>
typedef struct {
    <span class="code-object">byte</span> nodeId;
    <span class="code-object">byte</span> group;
    <span class="code-object">char</span> msg[RF12_EEPROM_SIZE-4];
    word crc;
} RF12Config;

<span class="code-keyword">static</span> RF12Config config;
<span class="code-keyword">static</span> <span class="code-object">int</span> power;

void setup() {
    Serial.begin(SERIAL_BAUD);

    <span class="code-keyword">if</span> (rf12_config(0)) {
        config.nodeId = eeprom_read_byte(RF12_EEPROM_ADDR);
        config.group = eeprom_read_byte(RF12_EEPROM_ADDR + 1);
    } <span class="code-keyword">else</span> {
        Serial.print(<span class="code-quote">"No configuration"</span>);
    }
}

void loop() {   
    <span class="code-keyword">if</span> (Serial.available()) {
      <span class="code-keyword">if</span> (Serial.read() == 'p') { 
        Serial.println(power);
      }
    }
    
    <span class="code-keyword">if</span> (rf12_recvDone()) {
        <span class="code-object">byte</span> n = rf12_len;
        <span class="code-keyword">if</span> (rf12_crc == 0) {    
            <span class="code-object">byte</span> node = (rf12_hdr &amp; 0x1f);
            <span class="code-keyword">if</span> (node == EMONTX_NODE) { 
              power = (rf12_data[0] + (rf12_data[1] &lt;&lt; 8));;
            }
            <span class="code-keyword">if</span> (RF12_WANTS_ACK &amp;&amp; (config.nodeId &amp; COLLECT) == 0) {
                rf12_sendStart(RF12_ACK_REPLY, 0, 0);
            }
        } 
    }
}
</pre>
</div></div>

<p>The command for this looks like:</p>

<p><a href="" title="Emails, Text-to-Speech, Serial Port"><img src="attachments/22874213/23036021.png" align="absmiddle" border="0"/></a></p>

<p>If you then create a range sensor using this command, you can monitor the power reading from the emonTx.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Aug 12, 2013 14:11
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874709"></a>
                                    <font class="smallfont"><p>I assume that command <em>email</em> has to be defined first with ${param} in the message field?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Aug 12, 2013 15:16
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874712"></a>
                                    <font class="smallfont"><p>Yes, similar to the say command above. My example rule will send an email every 30 seconds, so you will ant to change that to something more sensible.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Aug 12, 2013 15:21
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874713"></a>
                                    <font class="smallfont"><p>Also should the rule action:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
execute.command(<span class="code-quote">"email"</span>, <span class="code-quote">"Parameter test"</span>);
</pre>
</div></div>

<p>use command name "email test" instead to match the command configuration shown in the edit window?</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Aug 12, 2013 15:36
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874716"></a>
                                    <font class="smallfont"><p>I'll make the description a bit clearer. I was using "email" for the rule case with a parameter, and "email test" for a test using a button, which I have not described.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Aug 12, 2013 15:59
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874718"></a>
                                    <font class="smallfont"><blockquote><p>Yes, similar to the say command above</p></blockquote>
<p>That is how I understood the examples.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Aug 12, 2013 16:17
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22875598"></a>
                                    <font class="smallfont"><p>Hi,<br/>
I want to use your serial protocol to communicate with an atmega16 microcontroller (via rs232 - the setup so far beetwen pc and atmega16 works ok --for example I can send "a" and recive "b"(char+1)).<br/>
I didn't understand what the attribute command("10" "p") means or how it is defined. All I want for start is to be able to turn on/off a led connected to a uC pin.I'm missing the big picture..<br/>
Sorry if this is the wrong place to post didn't want to make another thread.</p>

<p>Ok,now my problem just got much simple. If I send on serial char 'a' my  led from uC turns on if I send 's' turns off.How can I make a switch now in designer using serial protocol? I tried to create 2 commands power on/off with the command 'a'/'s' but didn't work.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by joorj at Aug 27, 2013 17:55
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22875667"></a>
                                    <font class="smallfont"><p>George,<br/>
First time looking at this.<br/>
A couple of assumptions, only the baud rate is being defined in both OpenRemote and the Arduino code, so -<br/>
1. The number of data bits is 8?<br/>
2. The Parity is None?<br/>
So make sure you have your Arduino set the same way.</p>

<p>Looking at the Arduino code, the Commands are the strings that OpenRemote sends to the Arduino. So where it says "10" or "p" means that is the string that is being serial transmitted.<br/>
In your case the Command should be "a" for turning ON,and Command should be "s" for turning OFF.<br/>
Note - do not include the quotes in the edit box.</p>

<p>Make sure you are using the same letter at either end ie don't put "a" at the OpenRemote end and "A" at the Arduino end.<br/>
If you are using a windows platform ,use HyperTerminal to verify what you are actual sending. I.e. in OR have the port set to say COM1 and Hyperterminal set to COM2, Connect a wire from the Tx pin of COM1 to the RX pin of COM2 and see what Hyperterminal is receiving.</p>

<p>In actual fact you could use Hyperterminal to send the "a" and "s" to verify that your Mega code is working correctly.</p>

<p>Neil.</p>

<p>P.S. I use lots of the Atmel Mega chips from Mega8's to Mega128's and XMega's.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by nwe at Aug 29, 2013 12:29
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22875669"></a>
                                    <font class="smallfont"><p>Thank you so much for the answer.<br/>
I use atmega16 chip.<br/>
Everything you mentioned seems fine.My mega code as you say it's working(if I sent "a" in hyperterm turns on led and "s" turns off)<br/>
Now the only option is to check the way you said..but my COM's are usb and I only have one usb-&gt;serial.I will buy another one..<br/>
but still why isn't working..<img class="emoticon" src="images/icons/emoticons/sad.gif" height="20" width="20" align="absmiddle" alt="" border="0"/>? </p>

<p>In designer I used the command : power on/9600/a . And I applied this command to a button.So when i press this button in webconsole it should work,right? I got this part right?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by joorj at Aug 29, 2013 13:13
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22875670"></a>
                                    <font class="smallfont"><p>George,<br/>
Not sure what you are putting into the Command field (power on/9600/a)? </p>

<p>Using the above "Edit Command" box -</p>

<p>My thinking is for turning the Mega16 output ON</p>

<p>Name = PowerOn    (Or whatever you called it)<br/>
Protocol = Serial<br/>
COM Port = COM1   (Or what ever the USB to serial port you have is set to)<br/>
Data rate (bps) = 9600<br/>
Command = a</p>


<p>My thinking is for turning the Mega16 output OFF</p>

<p>Name = PowerOFF    (Or whatever you called it)<br/>
Protocol = Serial<br/>
COM Port = COM1   (Or what ever the USB to serial port you have is set to)<br/>
Data rate (bps) = 9600<br/>
Command = s</p>


<p>I.e. Create to seperate command, one for ON the for OFF.</p>

<p>Neil.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by nwe at Aug 29, 2013 13:23
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22875671"></a>
                                    <font class="smallfont"><p>this is exactly what I did from the beggining but still not working...</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by joorj at Aug 29, 2013 13:43
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22875712"></a>
                                    <font class="smallfont"><p>Neil if you have experience with atmega chips can you help with your own version of code.I use atmega16 and have an led on pin PD6.<br/>
Maybe with your version of code will work.<br/>
Thanks.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by joorj at Aug 30, 2013 16:34
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22875780"></a>
                                    <font class="smallfont"><p>The serial parameters other than the data rate are fixed at parity NONE, data bits 8, and stop bits 1. I could make these parameters if people think this would be a good idea.</p>

<p>George, what you are doing sounds correct, so I don't know why it is not working. Do you get any error or warning messages?</p>

<p>One thing you could try it so download the Arduino IDE and see if your set up works with that, as my code works in a similar way. In the Arduino IDE you should select the COM port for your serial to USB device (from Tools&gt;Serial Port), and then open the Serial Monitor and select the correct data rate, Then try sending your a and s commands and see if you get the expected results. </p>

<p>If this works but this version of OpenRemote Controller does not, then I think I will need to produce a version with debugging in it.</p>

<p>Do your a and s commands return a result? The protocol expects to get a result terminated by a carriage return and line feed and will wait until it receives one. It works like the TCP/IP protocol. The result can be anything for commands, and is ignored. For sensors it must be valid for the type of sensor. All this is the same as for the TCP/IP protocol, as I copied the relevant code from that protocol.</p>

<p>Looking at my code again, it looks as if I should improve the handling of carriage return and line feed, but I doubt if that is anything to do with your problem.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Sep 02, 2013 09:38
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22875905"></a>
                                    <font class="smallfont"><p>Guys it worked in linux(ubuntu)!<br/>
Don't really know what I was doing wrong in windows..the only difference in linux /dev/ttyS0 (+chmod 777 /dev/ttyS0 ) instead of COM obviously...and it "magically" worked <img class="emoticon" src="images/icons/emoticons/tongue.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> I'm so happy.<br/>
Now I'm having trouble creating a switch . what command should I use for switch sensor? (buttons work)</p>


<p>Thank you very much for implementing serial protocol!Great job!</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by joorj at Sep 04, 2013 23:31
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22875918"></a>
                                    <font class="smallfont"><p>Its good to hear that it worked on Linux. I only tested it on Windows.</p>

<p>You can use any commands that you like as long as as the atmega16 (or other serial device) responds to the sensor command and returns the switch value, "on" or "off" terminated by CR and LF.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Sep 05, 2013 10:23
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876049"></a>
                                    <font class="smallfont"><p>I've just successfully got it working on my raspberry pi!</p>

<p>It took me a while though and after following the guide here, serial wasn't working. In the end it turns out that Java doesn't recognise the /dev/ttyAMA0 serial port on the pi, see: <a href="http://www.openremote.org/display/forums/Zwave+problem?focusedCommentId=22414218#comment-22414218">http://www.openremote.org/display/forums/Zwave+problem?focusedCommentId=22414218#comment-22414218</a> </p>

<p>so I entered:</p>

<p>export JAVA_OPTS="$JAVA_OPTS -Dgnu.io.rxtx.SerialPorts=/dev/ttyAMA0"</p>

<p>before ./openremote.sh run</p>

<p>and it worked!! I wasn't sure where to put it in the openremote.sh script so didn't, if anybody could give me a pointer that would be great.</p>

<p>I hope this helps anybody else trying to get serial to work on a raspberry pi.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by westy8563 at Sep 06, 2013 21:36
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876050"></a>
                                    <font class="smallfont"><p>You could add it in the following part of the openremote.sh, should work:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
# Set juli LogManager <span class="code-keyword">if</span> it is present
<span class="code-keyword">if</span> [ -r <span class="code-quote">"$CATALINA_BASE"</span>/conf/logging.properties ]; then
  JAVA_OPTS=<span class="code-quote">"$JAVA_OPTS -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager"</span>
  LOGGING_CONFIG=<span class="code-quote">"-Djava.util.logging.config.file=$CATALINA_BASE/conf/logging.properties"</span>
fi



# ===== OPENREMOTE SETUP ==============================================================

# Set up RXTX Serial library properties
JAVA_OPTS=<span class="code-quote">"$JAVA_OPTS -Dgnu.io.rxtx.SerialPorts=/dev/ttyAMA0"</span>

# Set up the directory that contains <span class="code-keyword">native</span> libraries <span class="code-keyword">for</span> the OpenRemote Controller
LD_LIBRARY_PATH=<span class="code-quote">"$LD_LIBRARY_PATH:$CATALINA_BASE/webapps/controller/WEB-INF/lib/<span class="code-keyword">native</span>"</span>

</pre>
</div></div>

<p>HTH</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Sep 06, 2013 21:48
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876364"></a>
                                    <font class="smallfont"><p>I need quick help!Please!<br/>
I have some kind of a bug in designer.<br/>
I tried to make 2 swithces each for an LED.I created different commands,different devices(in modeler) different everything...<br/>
and when I put these 2 switches on a starting panel my LEDs just blink once when I press the switch...the switches are not switching...what might be the problem? <br/>
With one switch everything works fine...in a serial terminal everything is fine with both LEDs...</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by joorj at Sep 14, 2013 20:46
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876366"></a>
                                    <font class="smallfont"><p>What do your switches do? Does the on command switch, switch the LED on, and the off command switch it off?</p>

<p>With a single switch, does everything work OK, and does the switch change between on and off status on your screen?</p>

<p>With two switches, you say the LED blinks. Does that mean it receives an on command and an off command, or does just one of those commands make it blink? Do both the LEDs work and keep working? Is the problem just that the switches on the screen do not change status?</p>

<p>I will see if I can reproduce the behaviour using an Arduino device, but I do not fully understand you set-up and any more information you can give me will help.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Sep 14, 2013 21:23
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876367"></a>
                                    <font class="smallfont"><p>thank you for this fast reply.<br/>
So:<br/>
I created 2 devices LED1:<br/>
Name = PowerOn <br/>
Protocol = Serial<br/>
COM Port = /dev/ttyS0 <br/>
Data rate (bps) = 9600<br/>
Command = a (returns "ON" string)</p>

<p>Name = PowerOFF <br/>
Protocol = Serial<br/>
COM Port = COM1 <br/>
Data rate (bps) = 9600<br/>
Command = s (returns "OFF" string)</p>

<p>Name = Status <br/>
Protocol = Serial<br/>
COM Port = /dev/ttyS0<br/>
Data rate (bps) = 9600<br/>
Command = X (My controller returns(printf) "on" string if led is on and "off" if off.)</p>

<p>And for LED2 identical just a=b | s=z | X=Y</p>

<p>With one switch it works(switch changes state on screen according to LED on/off)</p>

<p>With 2 switches: If I press a switch,either one,it makes my LED blink one time/pressing and on screen changes to On state then Off state as fast as the LED turns on/off(blinks) so it knows the led state but it doesn't stay on..it's like sending "a" then "s" instantly...so this happens everytime I press the switch.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by joorj at Sep 14, 2013 21:40
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876371"></a>
                                    <font class="smallfont"><p>I tried all the ways possible..same thing happens...<br/>
But maybe here is something relevant for you:</p>

<p>With a device with just one switch created for one LED + plus another device with just the On command for other led: if i place a button on starting screen with the ON command for the 2nd LED it makes my LED blinks like I said above but the switch for first led works OK.How can that be possible?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by joorj at Sep 14, 2013 22:03
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876391"></a>
                                    <font class="smallfont"><p>I tried to reproduce this, but it works for me.</p>

<p>Could you post or send me your controller.xml file and the code from your serial device. My email is lawrie.griffiths@ntlworld.com.</p>

<p>The details you posted above have the Windows (not Linux) device (COM1) for PowerOFF. Is this what you have in the designer or is it just a typo in the information you posted?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Sep 15, 2013 12:34
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876398"></a>
                                    <font class="smallfont"><p>I'm using the Ciseco XRF wireless range of transmitters using their LLAP protocol which doesn't finish commands with a CRLN (as far as I can see). As such I am able to send commands, but unfortunately not able to receive commands for use in a sensor. You've mentioned improving handling of line feed, is this something you plan on implementing? </p>

<p>Unfortunately I'm not much of a programmer so don't know where to start otherwise I'd try have a look myself. I'd be more than happy to test any changes for you if this would be of any help?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by westy8563 at Sep 15, 2013 17:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876405"></a>
                                    <font class="smallfont"><p>Yes, I was planning to improve it. It does really need some sort of terminator, as the connection is reused, so there is no good way of telling when the data has ended without a terminator. I could do what the TCP/IP protocol now does and let you specify whether a LF or CRLF terminator is used. Would that solve your problem?</p>

<p>I actually meant to use LF as the terminator and ignore any CR if it occurs (which is does on Windows but not Linux, for example). But currently I am using CR and the terminator and effectively ignoring the LF. That was a mistake. Arduino does use CRLF as the terminator, so the current code worked for me. Would just correcting this bug, help you?</p>

<p>I seem to get a lot of end of file responses when reading from serial connections. I currently ignore them when I am expecting data, so I cannot use that as the terminator. </p>

<p>I could let you specify a terminator character other than CRLF or LF. Would that be better for you?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Sep 15, 2013 19:54
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876406"></a>
                                    <font class="smallfont"><p>Hi George, The code you sent me looks wrong for the X and Y commands:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"><span class="code-keyword">if</span>((key_press == 'Y') &amp;&amp; (PORTD &amp;= (1&lt;&lt;PD4)))
		printf(<span class="code-quote">"on\n"</span>);
	<span class="code-keyword">else</span> <span class="code-keyword">if</span>((key_press == 'Y') &amp;&amp; (!(PORTD &amp;= (1&lt;&lt;PD4))))
		printf(<span class="code-quote">"off \n"</span>);
</pre>
</div></div>

<p>You should no be using &amp;= as that is changing the LED status. You probably just want &amp;.</p>

<p>Also, I would remove the space at the end of "off". </p>

<p>Finally, you might need to change all the \n characters to \r\n, as a CRLF terminator is currently needed, but perhaps your code is adding that already.</p>

<p>Let me know if those changes fix your problem.</p>

<p>I think the &amp;= explains the led flashing and the fact that the switch does not work, as the sensor is polled continuously and every time you poll the sensor, you are turning off the LED. I do not know why a single switch would have worked.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Sep 15, 2013 20:59
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876414"></a>
                                    <font class="smallfont"><p>I'm not sure if just using LN would make a difference for me unfortunately, I think it just continues a feed of commands. I understand why a terminator is needed though. </p>

<p>The protocol is always in the format aXXXXXXXXXXX so a 12 character string, would it be possible to use the number of characters as a way of knowing when the data has ended? Alternatively every command starts with an 'a' so perhaps I could use that as a terminator and set up a couple of sensors so that they would terminate each other? If that makes sense?</p>

<p>EDIT: ignore the 'a' terminator thought, I've just realised nothing would actually ever get through because the first 'a' would terminate the data before anything else came through! (It's late!).</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by westy8563 at Sep 16, 2013 00:00
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876436"></a>
                                    <font class="smallfont"><p>What type of sensor do you plan to use with those values? Is the 12-character string numeric? Is so you might be able to define a level or range sensor. I'm not sure how you could use a switch sensor. You might have to use a custom sensor.</p>

<p>I could define optional start and length parameters to extract a number or string from a reply. I'm not sure how generally useful that would be. There are lots of serial devices out there, that work in different ways. It might take a lot of optional parameters to cover them all.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Sep 16, 2013 08:49
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876443"></a>
                                    <font class="smallfont"><p>I have a wireless dual relay which sends aXYRELAYAON- and aXYRELAYBOFF type commands and a wireless thermometer that sends aXYTEMP+22.0 commands. More info <a href="http://openmicros.org/index.php/articles/85-llap-lightweight-local-automation-protocol/297-llap-reference">here</a></p>

<p>A start and length parameter would probably work for me, although agree that it wouldn't be too much use in general terms. I think LLAP lends itself to its own protocol in OR really to take full advantage of it as there are quite a few 'personalities' and commands that can be sent/received. Unfortunately I don't think my programming is anywhere near up to scratch, but it might be something for me to work towards!</p>

<p>I had a look at your blog and it looks like the ciseco wireless devices might be something you're interested in so I'd recomend taking a look if you haven't already.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by westy8563 at Sep 16, 2013 10:30
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876445"></a>
                                    <font class="smallfont"><p>Just to add my 2 cents worth.<br/>
I have done numerous serial string decodes in my time (primarily from weigh scales). Everyone of them had some kind of identifier ie a STX character at the beginning and or ETX character at the end or maybe just a STX or a ETX. And by STX or ETX character I do not necessarily mean a $02 &amp; $03 it could be any characters ie a LF at the end.<br/>
As an example [STX]The quick brown[ETX] or The Quick Brown[CR][LF} or [STX]The quick Brown.<br/>
Most serial communications have some kind of a reasonably fixed string length ie the above are approximately 16 characters in length and are typically transmitted in a continuous fashion. But not always <img class="emoticon" src="images/icons/emoticons/sad.gif" height="20" width="20" align="absmiddle" alt="" border="0"/><br/>
So in my decodes, I look for a) A STX and/or ETX character and the 16 characters of the message. To be a valid message, I must have this string received within a certain period of time.<br/>
So say the Baud rate is 9600, this is approximately 1ms per character, so if I receive a string "the quick brown[CR][LF]" within 20ms I have a reasonable idea that the message is complete and that I don't have a part of a message from 3 seconds ago combined with a message coming in right now.<br/>
This means I need a timer that gets cleared after the [LF] is received, when the first character of the new message starts coming in, I start the timer and if I have not received the next [LF] within 20ms, I known the message has been corrupted and through it out. <br/>
Personally in my serial communications, I packet them in this fashion</p>

<p>STX $02<br/>
LEN (packet Length) Ie 5 + data size.<br/>
Addr (Destination Addr) <br/>
Data 1<br/>
Data 2<br/>
Data 3<br/>
CHKSUM Summed Byte of prior bytes in message<br/>
ETX $03</p>

<p>This way I know exactly how big each packet should be (good for error checking) and also a checksum byte (more error checking) and then I through in the timer and I have a very robust message.<br/>
Send these Polls every 100ms or less and I know exactly what my hardware is doing.</p>

<p>But for OR you could just go with a Terminator ie ETX/CR/LF and I timer.</p>

<p>Neil.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by nwe at Sep 16, 2013 12:55
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876474"></a>
                                    <font class="smallfont"><p>Hi there,<br/>
I am about a week old in openremote and am loving the platform. X10 with mochad working great, about to put together my VLC controls.</p>

<p>I'm attempting a similar implementation using the arduino to get temperatures from a few DS18B20 sensors. I am running linux and was finally able to get openremote to stop giving me errors in the boot.log regarding my installation of RXTXcomm-2.2-pre2.jar and now openremote seems to start correctly. when I was still seeing no temp on my displays I went looking for other logs and found this: "Implementation error in protocol handler org.openremote.controller.protocol.serial.SerialCommand@xxxxxxxx : nulljava.lang.NullPointerException" repeating over and over again which makes me think that openremote is trying to poll my sensor.</p>

<p>I am able to monitor my serial port using both the arduino IDE and GTKTerm and the commands work as expected in both.</p>

<p>any thoughts on where to go from here?</p>

<p>Thanks</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by bigcspecv at Sep 17, 2013 00:51
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876480"></a>
                                    <font class="smallfont"><p>I think your serial port must be failing to open. There should be an error near the start of the log: Serial: Error opening port: &lt;details&gt;.</p>

<p>I would check that your serial port is correct and look at the replies above about problems opening serial ports on Linux.</p>

<p>The error handling after failing to open the port needs improving. It should not be giving you all those null pointer exceptions. I will fix that when I fix other problems reported in this post. Note that this serial protocol is very new and just being tested, and has only had a few users. Also, it is the first OpenRemote development that I have done.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Sep 17, 2013 08:29
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876542"></a>
                                    <font class="smallfont"><p>Thanks for the quick reply, I didn't have a chance to post yesterday. I was able to get it working by reinstalling rxtx through ubuntu and copying the files installed into the correct directories within /usr/lib/jvm... (If anyone needs more detail let me know.)</p>

<p>That said, I know this is a new protocol and I am anxious to help in any way I can with it's development. I don't know many languages outside of (pretty basic) web design, but I'd be happy to run tests on my platform and submit test data or write how to's. I write work instructions at my job so I have a bit of experience there. </p>

<p>Also, someday soon I'd like to talk to someone about using this platform commercially with the basic setup I've described thus far (Arduino - OpenRemote). I don't know who to talk to or really where to begin as far as legalities and such. If anyone can point me in the direction of whom I'd need to talk to (or show me something I don't know as to why I couldn't) I'm up for collaborating and getting my design ideas shared with the right people.</p>

<p>Again, Thank you so much for your assistance. It pointed me in the right direction. Let me know if/how I can help.</p>

<p>Craig</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by bigcspecv at Sep 19, 2013 00:07
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877145"></a>
                                    <font class="smallfont"><p>Hi, I'm having an issue with a rule and a serial command. My rule is as follows:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">rule <span class="code-quote">"30min Advance"</span> when

  Event(source == <span class="code-quote">"Advance Sensor"</span>, value == <span class="code-quote">"on"</span>)

then

  execute.command(<span class="code-quote">"HEATING ON"</span>);

end
</pre>
</div></div>
<p>The HEATING ON command is a serial command to a relay that works fine with a seperate button. When the rule triggers it turns the relay on but then crashes any switches I have on my panel. When I substitute the serial command for another command everything works as expected. Nothing shows up in the console or the logs I've checked.</p>

<p>I'm not sure if this might be a serial issue or rules issue? Does anybody have any ideas?<br/>
Thanks.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by westy8563 at Sep 29, 2013 17:58
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877678"></a>
                                    <font class="smallfont"><p>It would be very nice if it would be possible to enter the serial port command as hex value. (My device needs STX and EOT at the begin and end of the message) I think for the moment I will be able to set this directly in the command.xml.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by thenetstriker at Oct 07, 2013 11:20
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877681"></a>
                                    <font class="smallfont"><p>I believe you can use hex commands as I copied the command parsing from the TCP/IP protocol. Just start the command 0x.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Oct 07, 2013 11:35
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877736"></a>
                                    <font class="smallfont"><p>I've just tried this on my BeagleBone Black (ngstrm Linux), but I get the following error when entering commands in this format:<br/>
ERROR HTTP\-Thread\-1: Serial: Error sending command to port: /dev/ttyUSB0<br/>
java.lang.StringIndexOutOfBoundsException: String index out of range: 13<br/>
	at java.lang.String.charAt(String.java:658)<br/>
	at org.openremote.controller.protocol.serial.SerialCommand.hexStringToByteArray(SerialCommand.java:139)<br/>
	at org.openremote.controller.protocol.serial.SerialCommand.requestData(SerialCommand.java:99)<br/>
	at org.openremote.controller.protocol.serial.SerialCommand.send(SerialCommand.java:82)<br/>
	at org.openremote.controller.service.impl.ControlCommandServiceImpl.trigger(ControlCommandServiceImpl.java:95)<br/>
	at org.openremote.controller.rest.ControlCommandRESTServlet.handleRequest(ControlCommandRESTServlet.java:77)<br/>
	at org.openremote.controller.rest.RESTAPI.doPost(RESTAPI.java:159)<br/>
	at org.openremote.controller.rest.RESTAPI.doGet(RESTAPI.java:112)<br/>
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)<br/>
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)<br/>
	at org.openremote.controller.rest.support.json.JSONCallbackFilter.doFilter(JSONCallbackFilter.java:63)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)<br/>
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:78)<br/>
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:77)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)<br/>
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)<br/>
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)<br/>
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)<br/>
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)<br/>
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)<br/>
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)<br/>
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)<br/>
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)<br/>
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:354)<br/>
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)<br/>
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)<br/>
	at java.lang.Thread.run(Thread.java:724)</p>

<p>When I remove the 0x characters the command can be sent. (I've attached my computer to the other end and listened to the port) But it seams that only the first command is sent, when I click the button a second and third time no command is sent. I've also one time got a warning because of the rxtx version, but I don't think that this could be the problem:<br/>
WARNING:  RXTX Version mismatch<br/>
	Jar version = RXTX-2.2pre1<br/>
	native lib Version = RXTX-2.2pre2</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by thenetstriker at Oct 07, 2013 20:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877738"></a>
                                    <font class="smallfont"><p>Can you tell me what data you sent exactly, and I will try to reproduce the problem. I don't think I tested sending hex strings but I thought it would work as I copied the code directly from the TCP/IP protocol.</p>

<p>Having a quick look at the code, it looks as of it would fail if there are an odd number of hex digits. Could that have been the problem?</p>

<p>I am about to fix another problem with the error handling in the code and can build a new version if your problem cannot be circumvented.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Oct 07, 2013 20:49
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877740"></a>
                                    <font class="smallfont"><p>I've tried to send the following commands. (These are commands for opening the relay on my door transponder system: <a href="http://www.produktinfo.conrad.com/datenblaetter/750000-774999/750782-an-01-de-Transponder_Zutrittkontrolle.pdf">http://www.produktinfo.conrad.com/datenblaetter/750000-774999/750782-an-01-de-Transponder_Zutrittkontrolle.pdf</a>)</p>

<p>0x02FFCR1520x04<br/>
0x02FFCR0510x04</p>

<p>I've also created an sh file which sends these commands, using this file it works every time:<br/>
#!/bin/sh<br/>
/bin/stty -F /dev/ttyUSB0 57600<br/>
/bin/echo -e "\x02FFCR152\x04" &gt; /dev/ttyUSB0</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by thenetstriker at Oct 07, 2013 21:12
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877746"></a>
                                    <font class="smallfont"><p>The problem is that you can either send the command as character data, or hex data, but not a mixture of both. The java hex literal  format is supported, not the shell script string literal format with hex escape characters.</p>

<p>So if the literal starts 0x, it must have an even number of hex digits and consist entirely of hex digits. </p>

<p>To send the data you require, you will need to convert the ascii characters to hex. Something like:</p>

<p>0x024646435231353204</p>

<p>I could make the serial protocol use any format we like, but it seems sensible to follow the conventions of other protocols like TCP/IP.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Oct 07, 2013 22:16
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877749"></a>
                                    <font class="smallfont"><p>Thanks, this command worked! But it still seams that only the first time I press the button a command is sent. I've now mapped the open relay command to one button and the relay close command to another. With this configuration I am able to once open the relay and close it once. If I press the open button again nothing happens. (And no error on console) What am I doing wrong? (The same configuration with my shell commands is working every time I hit the button)</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by thenetstriker at Oct 07, 2013 23:12
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877752"></a>
                                    <font class="smallfont"><p>The problem could be that there is no reply from these commands. Again the code works like the TCP/IP protocol and waits for a reply from commands. Currently, it has no timeout and waits forever. Also as discussed earlier in this thread, it expects CRLF as the terminator of the reply. I plan to make this more flexible and add a timeout, but it might be hard to cope with the varied responses that different devices give. Do these commands have any reply?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Oct 07, 2013 23:28
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877753"></a>
                                    <font class="smallfont"><p>Yes they have a reply, as described in the pdf the reply has this format: &lt;STX&gt;&lt;ADR&gt;&lt;COMMAND&gt;&lt;SUBCOMMAND&gt;&lt;ACK&gt;&lt;CRC&gt;&lt;EOT&gt;<br/>
Will there be a setting in the final version where I can set that EOT marks the end of a transmission instead of CRLF?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by thenetstriker at Oct 08, 2013 00:00
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877757"></a>
                                    <font class="smallfont"><p>Yes, I could be a lot more flexible about the terminator and let you specify it in hex, so 0x04 for EOT. For commands from buttons this is not a problem as the reply is effectively ignored For sensors it is more difficult as it will be necessary to extract information from the reply. Regular expressions might be needed for that. </p>

<p>Perhaps I will do an interim version that just gives more flexibility with the terminator and see if that fixes your problem.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Oct 08, 2013 07:21
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22878328"></a>
                                    <font class="smallfont"><p>Is the sourcecode of this version already published? I found nothing in the sourceforge repository.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by thenetstriker at Oct 16, 2013 12:12
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22878329"></a>
                                    <font class="smallfont"><p>It is in workspace/lgriffiths/Controller_2_1_0_FM_SerialFixes</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Oct 16, 2013 12:26
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22878354"></a>
                                    <font class="smallfont"><p>Thanks for the link. I've compiled my own version and replaced the carriage return with 0x04 and that seams to work fine with my device.<br/>
Another question, I'm experiencing a lot of problems with my onewire devices with this version. (I get a lot of "N/A" readings, problems with events) Is this a known issue of this release or a problem of my device?</p>

<p>Edit: Maybe I just found the error. My rules had an error.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by thenetstriker at Oct 16, 2013 21:00
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22878810"></a>
                                    <font class="smallfont"><p>I think I found an error in this version. I've added a custom Sensor with custom state items "0" = "0" and "1" = "1", configured an image and with custom images for the two custom states, but the image does not change in the webcontroller. (On my iPad on the same screen the image change works) I've also tried to add a label with two custom strings for the two custom states. With this settings I get even an "Unknown controller exception" on the webinterface. (On the iPad I get no error and the values are displayed correctly)</p>

<p>The same configuration but with the custom states set to "0" = "off" and "1" = "on" works perfectly, but I cannot use this configuration because I want to log the states using rrd. Can you please fix this problem in the next release?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by thenetstriker at Oct 24, 2013 19:51
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879277"></a>
                                    <font class="smallfont"><p>hi,<br/>
need some help with serial</p>

<p>I did a bunch of digging around on my own and have gotten further.</p>

<p>1) I had encountered an error to the effect of a " Word Length Mismatch error " with RxTx<br/>
I did some hunting around and found it was due to my running on a 64 bit system</p>

<p>I found some 64 bit RxTx files here <a href="http://mfizz.com/oss/rxtx-for-java">http://mfizz.com/oss/rxtx-for-java</a></p>

<p>I than unziped the package and copied 3 files into openremote</p>

<p>RXTXcomm.jar went in controller/WEB-INF/lib<br/>
librxtxSerial.so went in lib/native<br/>
libParallel.so also went in native</p>

<p>after restarting and launching the webconsole I used the button I had given the command to and IT WORKED once and than crashed the controller.</p>

<p>As I said I have gotten further than I had before, any next steps or better ways would be appreciated<br/>
-Peter</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by phreak at Nov 03, 2013 02:37
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879353"></a>
                                    <font class="smallfont"><p>Hi David, </p>

<p>I'm just wondering whether you are using this for LightwaveRF control, or some other serial connected device ? </p>

<p>FYI, I'm hoping to use OpenEnergyMonitor's RFM12PiV2 to control a number of LightwaveRF devices, and I'm assuming (Lawrie might be able to comment here) that I just load his lwrelay sketch into my RFM12Pi (hopefully directly from the Pi, using avrdude), install this latest version of OpenRemoteController code with Lawrie's serial capability, and then it should all work ?</p>

<p>Any hints, tips or advice gratefully received.</p>

<p>Hugh</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by scohrab at Nov 04, 2013 11:46
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879355"></a>
                                    <font class="smallfont"><p>Hi Hugh,</p>

<p>My LightWaveRF library does not currently work with RFM12B radios, like the one in the RFM12Pi. It only works with the simpler RF 434Mhz transmitters and receivers that are available from Sparkfun/Cool Components or on ebay.</p>

<p>I have an RFM12Pi (probably version 1) but it is 868Mhz and I have only used it with the original sketch. </p>

<p>I have run OpenRemote on a Raspberry Pi, but I mainly run it on Windows. </p>

<p>It should be possible to make my library work with the RFM12B, particularly a 434Mhz version, by modifying one of the existing On-Off keying (OOK) solutions available for Jeenodes, but I have not attempted that.</p>

<p>You should be able to run my lwrelay sketch on an Arduino with RF434Mhz transmitters and receivers, attached by USB to the Raspberry Pi. </p>

<p>Lawrie</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by lawrie at Nov 04, 2013 12:26
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879448"></a>
                                    <font class="smallfont"><p>Hi Lawrie,<br/>
Thanks very much for this info. Have you got any idea how much coding I would have to do ? My programming skills are very rusty, and I never learnt any C.<br/>
Alternatively, could you tell me the model of Arduino board I would be looking for. I'm able to get the OpenRemote stuff running with a 1wire board with OWFS OK, so I'm hoping to be able to just Plug-and-play.<br/>
Hugh</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by scohrab at Nov 05, 2013 18:12
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22883405"></a>
                                    <font class="smallfont"><p>Hi,</p>

<p>First of all many thanks for the serial module.<br/>
I don't have an issue getting the commands to work (ie sending commands to the device), I'm just having a very hard time getting the sensors working (ie reading back from the serial device).<br/>
I'm new with OpenRemote, so I don't know if this version 2.2 is buggy or if I'm doing something wrong (probably the latter)</p>

<p>Let me explain.<br/>
A very simple serial device that receives few commands, and responds to few of those.</p>

<p>001 sets the LED on the device off and responds with Serial.println("off");<br/>
002 sets the LED on the device on and responds with Serial.println("on");<br/>
003 does the same as 002 but no response is returned<br/>
004 does the same as 001 but no response is returned<br/>
009 increments a counter on the device no return, blinks led once<br/>
005 blinks the led and return the counter value.</p>

<p>In the designer, if I add only commands, and test each of them, they all work as expected, LEDs act as expected<br/>
I did use a serial monitor to check the serial traffic and everything is in order.</p>

<p>Problem starts if I want to add label(s) to display the returned values.<br/>
I added a sensor (type level) that sends the command 005<br/>
Then added a label associated to that senser<br/>
I expected that the sensor would start display 0 until I hit the Counter increment button (009)<br/>
at which point I would expect to see 1 displayed.</p>

<p>The results varied at best,<br/>
Mind you I was monitoring the serial communication so I was able to tell what was going on.<br/>
at first I saw that the sensor was being polled, ie command 005 sent to the device (perhaps at less than one per second)<br/>
but that eventually stopped, no idea why<br/>
regardless, the device was doing everything as expected, in fact, all the commands were received from an android ui as I was pressing them<br/>
The label display though, was very iffy<br/>
at times it display N/A<br/>
other times, it would display the counter value, but not consistently, quite often it would not refresh, in fact it is really hard to get it refreshed, just very rarely<br/>
Quite bizare.</p>

<p>I also tried to test it from the webcontroller<br/>
that one is quite flaky as well, not all commands (buttons) pressed on the Web UI were received by the device<br/>
This was never an issue from Android<br/>
I'm not sure if the controller was receiving the commands or not (any way to debug the controller to see what it is receiving)<br/>
I suspect it wasn't receiving all the commands, and think it is a webcontroller bug.<br/>
But I honestly don't care much about the webcontroller, was just merely testing it to see if it would behave differently<br/>
Android to device all commands work as expect<br/>
device to android not so much.</p>

<p>Any ideas on where I'm going wrong?</p>

<p>I even tried switches, I had zero success there reading back states.</p>

<p>Many thanks in advance</p>

</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by hrant at Jan 25, 2014 23:03
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22884264"></a>
                                    <font class="smallfont"><p>Hi!</p>

<p>I have been trying to get serial to work with OR on a Raspberry Pi and an Arduino, but I'm stuck with the same problem. Buttons work as they should but with switches and sliders the sensors only works sometimes.</p>

<p>Has anyone figured out how to get this to work properly? </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mattiasl at Feb 12, 2014 08:28
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23596120"></a>
                                    <font class="smallfont"><p>Hello,</p>

<p>is the designer updated? i had some email commands and now they are gone, i cannot choose for email and serial protocol in a new command.<br/>
sending email via a command worked perfect before.<br/>
something changed?</p>

<p>greetz Rob</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by robnas at Jan 30, 2015 18:04
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23596871"></a>
                                    <font class="smallfont"><p>I see the serial protocol is in both staging and preview, i am a pro user, is there any ETA for when the serial protocol will make it to the Pro platform?</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by michaeltschmidt at Mar 01, 2015 18:58
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23600870"></a>
                                    <font class="smallfont"><p>Hi!<br/>
Does anyone know how to deploy polling interval for serial protocol? </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by rayon02 at Aug 29, 2015 18:35
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:30</font></td>
		    </tr>
	    </table>
    </body>
</html>