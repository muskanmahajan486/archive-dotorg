<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : sunrise and sunset actions</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : sunrise and sunset actions
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Oct 30, 2013 by <font color="#0050B2">dwaun</font>.
				    </div>

				    <p>I was wondering if anyone has an example of causing an action to occur at either sunrise or sunset.  There appears to be some support of day versus night in openremote with the isDay and isNight command within the date/time protocol, but I'm not exactly sure how I would tie that to causing an action when a transition occurs.  Can this be done within a rule?  If anyone has suggestions, I'd appreciate it.</p>

				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-22879138"></a>
                                    <font class="smallfont"><p>See my <a href="http://www.openremote.org/display/docs/OpenRemote+2.0+How+To+-+Control+Sunshades+-+Somfy+with+Raspberry+Pi#OpenRemote2.0HowTo-ControlSunshades-SomfywithRaspberryPi-Automation">rule example</a> where I use this to automatically raise my sunshades. In the Rules documentation on this site there are some other examples. Just use the search function on the main page with keywords <b>rule isNight</b></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Oct 31, 2013 07:48
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879145"></a>
                                    <font class="smallfont"><p>I have a rule which turns lights beside my TV when there is a night and the TV is on.</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
rule <span class="code-quote">"Turn TV light scene on1"</span>
when
  Event(source==<span class="code-quote">"isNight"</span>, value==<span class="code-quote">"<span class="code-keyword">true</span>"</span>)
  Event(source==<span class="code-quote">"VTVON"</span>, value==<span class="code-quote">"1"</span>)
then
  execute.command(<span class="code-quote">"sndRockerOFFB_01"</span>);
end
</pre>
</div></div>
<p>However, for me the official sunset is too early (too light) so I've changed the code a little to the civil sunset.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Oct 31, 2013 09:45
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879151"></a>
                                    <font class="smallfont"><p>Thanks for your examples.  Those are very helpful.</p>

<p>Maybe the thing that I'm most confused about when rules get executed.</p>

<p>To me it seems like isNight would be true all night long, so the rule would get executed all night long.  Is there something that prevents the command from getting executed more than once?</p>

<p>Thanks for the help!</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dwaun at Oct 31, 2013 12:57
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22879152"></a>
                                    <font class="smallfont"><p>In my exemple both conditions must be true therefore it is executed only when isNight and VTVON are true. It is executed only once when both conditions become true. Next time it is executed when either of conditions have been false in the meantime and become true again.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Oct 31, 2013 13:27
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:43</font></td>
		    </tr>
	    </table>
    </body>
</html>