<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : HTTP switch</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : HTTP switch
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Apr 18, 2012 by <font color="#0050B2">dberenguer</font>.
				    </div>

				    <p>Hi, I'm now trying to make a switch work on my panel. My switch is attached to a sensor and I know that this sensor works because I've placed a label attached to this sensor and it's showing the correct value. However, the panel switch always displays "OFF". What is this switch expecting to get as a value? I've tried with "ON", "on", "1" but nothing works. As result, each time I press the switch an ON command is sent.</p>

<p>Thanks again!!</p>

<p>Daniel.</p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/19440245/23035944.png">HTTP1.png</a> (image/png)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-19440255"></a>
                                    <font class="smallfont"><p>In general for a switch you need a "on" command to turn device on, a "off" command to turn device off and a "status" command which returns the active states as string "on" or "off". The status command has to be used for the switch sensor.</p>

<p>If you can only turn the switch on and it does not reflect the new state, the device does not update the sensor. You will probably have to configure your status command with a fast polling interval (mayve 1 second) to have a quick feedback.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 19, 2012 09:55
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19440256"></a>
                                    <font class="smallfont"><p>Thanks Marcus.</p>

<p>That's exactly what I've done but the switch sensor never displays the correct value. On the other hand, I have a label that reflects the value correctly. I'm using a "custom" sensor for both the switch and the label. No mapping.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dberenguer at Apr 19, 2012 11:40
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19440259"></a>
                                    <font class="smallfont"><p>For the switch to work properly you have to use a "switch" sensor.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 19, 2012 12:14
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19440277"></a>
                                    <font class="smallfont"><p>I tried that too... without success.</p>

<p>A label attached to a custom sensor is displaying ON/OFF values correctly. However, a switch sensor (switch or custom) always displays OFF... I've tried with sending on/off in both lower case and upper case... just in case <img class="emoticon" src="images/icons/emoticons/wink.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>I've also tried to bind an image to each state of the button but same result. The off image stays forever there, regardless of the value returned by the HTTP request.</p>

<p>Thanks again.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dberenguer at Apr 20, 2012 09:49
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19440279"></a>
                                    <font class="smallfont"><p>If your status command returns "on" or "off" and you use that inside a switch sensor it should work.<br/>
No custom sensor needed at all. Also for a label you can use switch sensor.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 20, 2012 10:40
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19440280"></a>
                                    <font class="smallfont"><p>... Also for a label you can use switch sensor...</p>

<p>Tested that too but "N/A" is always displayed. The following are my settings:</p>

<p>Switch Sensor:<br/>
Name: SWITCH_SENSOR<br/>
Command: Get_state<br/>
Type: switch</p>

<p>Custom Sensor:<br/>
Name: CUSTOM_SENSOR<br/>
Command: Get_state<br/>
Type: custom</p>

<p>Command:<br/>
Name: Get_state<br/>
Protocol: HTTP<br/>
URL: <a href="http://localhost:8001/state.txt">http://localhost:8001/state.txt</a><br/>
Polling interval: 1s</p>

<p>Attaching CUSTOM_SENSOR to a label works well. However, attaching SWITCH_SENSOR makes the label display "N/A" all the time.</p>

<p>Sorry to bother you again <img class="emoticon" src="images/icons/emoticons/sad.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dberenguer at Apr 20, 2012 11:06
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19440281"></a>
                                    <font class="smallfont"><p>When you assign a switch sensor to a label you have to define text for "on" and "off".<br/>
Did you do that?<br/>
Also try to only have switch sensor and remove custom sensor completely.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 20, 2012 11:11
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19440282"></a>
                                    <font class="smallfont"><p>Yes, I've assigned a text for each state. I've also deleted the custom sensor as you suggest but the problem persists.</p>

<p>FYI, I have a screen displaying temperatures and humidities, using custom sensors attached to labels. Should I remove them too?</p>

<p>Thanks again for the great support!!</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dberenguer at Apr 20, 2012 11:31
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19440284"></a>
                                    <font class="smallfont"><p>Hmm, weird, it should work.<br/>
You can try with a new configuration and only the command and sensor that has the problem.<br/>
You can also email me your openremote.zip file. marcus (at) openremote (dot) org</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 20, 2012 12:37
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19440299"></a>
                                    <font class="smallfont"><p>Thanks a lot Marcus.</p>

<p>Noob question: how can I create a new config without loosing my current one? I know I can save it in form of zip file but then, how can I reopen it from the online designer?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dberenguer at Apr 21, 2012 15:57
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19440301"></a>
                                    <font class="smallfont"><p>We don't have a re-import yet, but it's on the todo list <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/><br/>
The easiest way would be to create yourself a new account and just add the on/off/status commands and the switch sensor and the switch.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 21, 2012 18:46
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19440359"></a>
                                    <font class="smallfont"><p>Problem solved.</p>

<p>My first tries were sending "1" and "0" instead of "on" and "off" so that could never work. Then, I used a static file to supply on/off strings but, for some reason, that doesn't work for switches (it works for labels though). I've modified my application to reply with "on"/"off" strings instead and it works.</p>

<p>Thank you very much Marcus!</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dberenguer at Apr 24, 2012 12:12
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22873201"></a>
                                    <font class="smallfont"><p>I am trying to operate an Advantech ADAM-6050 using ASCII and HTTP commands.<br/>
I am new to this issue.<br/>
I am missing somethigs.<br/>
I have created On and Off (POST) &amp; Status (GET) HTTP commands that uses:</p>

<p>Off &amp; On Commands:<br/>
URL: <a href="http://10.0.0.55">http://10.0.0.55</a><br/>
HTTP Method: Post<br/>
Off Command - Workload: #011000 <br/>
On Command - Workload: #011001<br/>
Password: 00000000</p>

<p>Read Status:<br/>
URL: <a href="http://10.0.0.55">http://10.0.0.55</a><br/>
HTTP Method: get<br/>
Workload: $016<br/>
Password: 00000000</p>


<p>They carry the proper ASCII string to perform the job as I have tested it with Advantech's tools.<br/>
I have created a Sensor (Custom State) and a Switch.<br/>
I get lots of errors (Error polling thread for ADAM Get. Client Protocol exception when executing HTTP method). The switch status is stuck and does no do anything.<br/>
The labe I have set to the sensor does not show anything (the respond should be !0100FFF or so).<br/>
I am probably missing something here.<br/>
Need help.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Jun 20, 2013 19:08
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22873205"></a>
                                    <font class="smallfont"><p>A GET command cannot have a workload. That is only for POST. GET usually encodes all paramter into the URL.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jun 20, 2013 20:27
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22873206"></a>
                                    <font class="smallfont"><p>Thanks. <br/>
Do not know the syntax.<br/>
I will check it out since it is new to me.<br/>
BTW I have upgraded to the June 17 snapshot so GET and POST should work fine.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Jun 20, 2013 20:56
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 10:43</font></td>
		    </tr>
	    </table>
    </body>
</html>