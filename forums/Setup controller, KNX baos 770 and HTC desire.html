<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Setup controller, KNX baos 770 and HTC desire</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Setup controller, KNX baos 770 and HTC desire
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Dec 27, 2010 by <font color="#0050B2">nivis</font>.
				    </div>

				    <p>I've today installed OpenRemote-2.0.0_DeveloperRelease11.zip together with Java(TM) SE Runtime Environment (build 1.6.0_22-b04). I then followed "http://www.openremote.org/display/docs/OpenRemote+2.0+How+To+-+KNX+Switches" to create a test panel and after that I synced my controller.</p>

<p>My HTC starts the Openremote app and connects to my controller but all I get is a N/A under the image of my lightbulb in the panel.</p>


<p>I'm not sure if the KNX IP gateway I use are supported?&nbsp; I've got a KNX IP BAOS 770 ( <a href="http://www.weinzierl.de/en/products/770.html">http://www.weinzierl.de/en/products/770.html</a> ) I've read that you only support KNX IP Interface 730 and Router 750. Could you please add support for my device i necessary. I've tried to use "Weinzierl" for Vendor and "KNX IP Router 750" for Model when creating the GW device in the Modeler but without any luck.</p>

<p>Do I need to configure the IP I use for my KNX IP gateway?</p>

<p>Please advice,</p>

<p>Per</p>

				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-13697581"></a>
                                    <font class="smallfont"><p>Here are&nbsp; a sample from when I start the app on my HTC:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"> [Controller]2010-12-28 09:42:30,258 INFO [HTTP-<span class="code-object">Thread</span>-23] org.openremote.controller.<span class="code-keyword">rest</span>.RoundRobinRESTServlet.doPost(61) | Start RoundRobin group member REST service. at 2010-12-28 09:42:30
[Controller]2010-12-28 09:42:30,280 INFO [<span class="code-object">Thread</span>-24] org.openremote.controller.net.RoundRobinUDPServer$UDPServerDealThread.run(132) | UDP Server : Received the controller multicast request from the same group floor20
[Controller]2010-12-28 09:42:30,281 INFO [<span class="code-object">Thread</span>-7] org.openremote.controller.net.RoundRobinTCPServer.run(53) | TCP Server : a <span class="code-keyword">new</span> groupmember socket established...
[Controller]2010-12-28 09:42:30,282 INFO [<span class="code-object">Thread</span>-25] org.openremote.controller.net.RoundRobinTCPServer$AppendGroupMemberThread.run(80) | TCP Server deal thread : Ready <span class="code-keyword">for</span> receiving groupmember url ...
[Controller]2010-12-28 09:42:30,283 INFO [<span class="code-object">Thread</span>-25] org.openremote.controller.net.RoundRobinTCPServer$AppendGroupMemberThread.run(84) | TCP Server deal thread : received a groupmember url : http:<span class="code-comment">//172.16.2.17:8080/controller
</span>[Controller]2010-12-28 09:42:30,560 INFO [HTTP-<span class="code-object">Thread</span>-24] org.openremote.controller.<span class="code-keyword">rest</span>.StatusPollingRESTServlet.doPost(76) | Started polling at 2010-12-28 09:42:30
[Controller]2010-12-28 09:42:30,561 INFO [HTTP-<span class="code-object">Thread</span>-24] org.openremote.controller.service.impl.StatusPollingServiceImpl.queryChangedState(74) | Querying changed state from ChangedStatus table...
[Controller]2010-12-28 09:42:30,563 INFO [HTTP-<span class="code-object">Thread</span>-24] org.openremote.controller.service.impl.StatusPollingServiceImpl.queryChangedState(89) | Found: [device =&gt; 353833049792275, sensorIDs =&gt; 41] in ChangedStatus table.
[Controller]2010-12-28 09:42:30,564 INFO [HTTP-<span class="code-object">Thread</span>-24] org.openremote.controller.service.impl.StatusPollingServiceImpl.queryChangedState(107) | DEVICEID:353833049792275     sensorID:[41]statusChangedSensorID:[]Waiting...
[Controller]2010-12-28 09:42:30,780 INFO [HTTP-<span class="code-object">Thread</span>-23] org.openremote.controller.<span class="code-keyword">rest</span>.RoundRobinRESTServlet.doPost(73) | Finished RoundRobin group member REST service.  at 2010-12-28 09:42:30
</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by nivis at Dec 28, 2010 08:49
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-14254088"></a>
                                    <font class="smallfont"><p>I reply myself in this matter.</p>

<p>First off, the BAOS  770 seems not to be supported. In fact it seems that this device don't  have the functionality as the 730/750 has.</p>

<p>Second. It looks like  the setup I had done on the composer had some bug in it. The  controller.xml I downloaded and synced with did not have any command  tags. I really don't know why but I tried to make a new device and  defined a button with similar functions as the old one, and this one  generated the command tags. Sorry to say I started to get a massive  amount of this log entry instead:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">\[Controller\]2010-12-29 22:11:37,350 INFO \[<span class="code-object">Thread</span>-8\] org.openremote.controller.statuscache.StatusCache.saveOrUpdateStatus(68) \| Status is <span class="code-keyword">null</span> or "" <span class="code-keyword">while</span> calling saveOrUpdateStatus in statusCache.
\[Controller\]2010-12-29 22:11:37,852 ERROR \[<span class="code-object">Thread</span>-8\] org.openremote.controller.protocol.knx.KNXCommand.read(340) \| Unable to send \[FRAME\] L_Data.req 0.0.0 \-&gt; 1/1/31 Data: 0x00 : KNX IP Gateway was not found.
org.openremote.controller.protocol.knx.ConnectionException: KNX IP Gateway was not found.
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at org.openremote.controller.protocol.knx.KNXConnectionManager.waitForDiscovery(KNXConnectionManager.java:821)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at org.openremote.controller.protocol.knx.KNXConnectionManager.getConnection(KNXConnectionManager.java:469)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at org.openremote.controller.protocol.knx.KNXCommand.read(KNXCommand.java:335)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at org.openremote.controller.protocol.knx.GroupValueRead.read(GroupValueRead.java:132)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at org.openremote.controller.component.Sensor.readStatus(Sensor.java:124)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; at org.openremote.controller.statuscache.PollingMachineThread.run(PollingMachineThread.java:61)
</pre>
</div></div>
<p>Doing a "tcpdump multicast" show me the following:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">root@fitpc2:~# tcpdump multicast
tcpdump: verbose output suppressed, use \-v or \-vv <span class="code-keyword">for</span> full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 96 bytes
09:18:10.254869 IP 172.16.2.17.56177 &gt; 224.0.23.12.3671: UDP, length 14
09:18:10.272332 ARP, Request who-has 172.16.2.17 tell 172.16.2.9, length 46
09:18:10.815794 IP 172.16.2.17.36712 &gt; 224.0.23.12.3671: UDP, length 14
09:18:11.701940 IP 172.16.2.17 &gt; IGMP.MCAST.NET: igmp v3 report, 1 group record(s)
09:18:11.820941 IP 172.16.2.17 &gt; IGMP.MCAST.NET: igmp v3 report, 2 group record(s)
09:18:16.381118 IP 172.16.2.17 &gt; IGMP.MCAST.NET: igmp v3 report, 1 group record(s)
09:18:20.001433 IP 172.16.2.17.3483 &gt; 255.255.255.255.3483: UDP, length 16
09:18:27.753117 IP 172.16.2.17 &gt; IGMP.MCAST.NET: igmp v3 report, 2 group record(s)
</pre>
</div></div>
<p>No answer from the BAOS 770 at all.</p>

<p>It seems that I'll have to invest in another gateway...</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by nivis at Dec 30, 2010 08:20
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15138822"></a>
                                    <font class="smallfont"><p>Took a quick look at their datasheet and they do say they support KNX/IP protocol, so from that perspective it should indeed work.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by admin at Jan 13, 2011 10:57
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15138823"></a>
                                    <font class="smallfont"><p>So yeah from the logs looks like the IP gateway is not found &#8211; do note that whether its OR controller or tcpdump you usually need to have your PC connected to the same LAN subnet with the  gateway &#8211; multicast is often configured so that it won't get past the LAN switches.</p>

<p>I'm not familiar with tcpdump otherwise, but the KNX gateway should respond at mcast address 224.0.23.12 port 3671, IIRC.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by admin at Jan 13, 2011 11:04
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15138824"></a>
                                    <font class="smallfont"><p>I've been in contact with Weinzierl and this is what I got from them:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"> Regarding Open Remote and BAOS. The discovery multicast address is fixed, so
the 730, 750 and 770 should all answer. You can verify <span class="code-keyword">this</span> with Wireshark. The
only difference I can think of is that the BAOS adds extra information to the
response, which Open Remote may not accept. I'd suggest performing a search
with Open Remote and capturing the telegrams with Wireshark to verify whether
the 770 is responding or not.
</pre>
</div></div>
<p>Could you please take a look at this and see if it's an easy fix <img class="emoticon" src="images/icons/emoticons/wink.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> ?</p>

<p>( BTW, I did the tcpdump on the OR controller. )</p>


<p>Per</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by nivis at Jan 13, 2011 13:22
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532036"></a>
                                    <font class="smallfont"><p>Hmm, not much to go with without the actual gateway to test. Other than at some point put together tooling to debug the telegram level issues. Unless you can get something together with the wireshark to give some clues but even then we're still currently using 3rd party lib for KNX discovery which makes fixing things a bit of a hit-and-miss.</p>

<p>Both getting a fully supported KNX stack and tooling are items I'd like to address but right now am unable to say when. However, there might be a much easier workaround to this but I do need something more to work with &#8211; any chance of Wireshark output on the discovery datagrams? Do you have access to the other models, 730 or 750?</p>


</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Jan 17, 2011 13:09
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 11:01</font></td>
		    </tr>
	    </table>
    </body>
</html>