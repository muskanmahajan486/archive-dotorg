<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Zwave</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Zwave
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Sep 04, 2013 by <font color="#0050B2">java</font>.
				    </div>

				    <p>Hallo!<br/>
I'm trying to get openremote going on my synology DS209. I've got DSM 4.2 installed on it. I've followed the instruction on "Openremote 2.0 how to-Synology with Z-wave...". I have an Aeon-labs Z-stick series2 in the USB0, but i can't get it to work with my Aeon-labs micro switch. The controller sync with the designer. The webconsole just keeps loading until i hit the right mouse key for 2s, then i can see and manage the on and off button and the staus for the switch. But nothing happens with the switch when i hit the buttons.<br/>
In catalina.out i get the Error:<br/>
Error in handling REST API response: org.openremote.controller.protocol.zwave.model.Controller cannot be cast to org.openremote.controller.protocol.zwave.model.Switch<br/>
java.lang.ClassCastException: org.openremote.controller.protocol.zwave.model.Controller cannot be cast to org.openremote.controller.protocol.zwave.model.Switch.</p>

<p>The hole catalina.out log file:</p>

<p>Sep 4, 2013 4:59:55 PM org.openremote.controller.bootstrap.Startup redirectJULtoLog4j<br/>
INFO: Initialized JUL to LOG4J Redirector.<br/>
INFO 2013-09-04 17:00:06,626 : </p>

<p>--------------------------------------------------------------------</p>

<p>  DEPLOYING NEW CONTROLLER RUNTIME...</p>

<p>--------------------------------------------------------------------</p>

<p>WARNING:  RXTX Version mismatch<br/>
	Jar version = RXTX-2.2pre1<br/>
	native lib Version = RXTX-2.1-7<br/>
RXTX Warning:  Removing stale lock file. /var/lock/LCK..ttyUSB0<br/>
INFO 2013-09-04 17:00:18,214 : No rule definitions found in '/volume1/@appstore/OpenRemote/webapps/controller/rules'.<br/>
INFO 2013-09-04 17:00:18,215 : Initialized event processor : Drools Rule Engine<br/>
INFO 2013-09-04 17:00:18,798 : Initialized event processor : RRD4J Data Logger<br/>
INFO 2013-09-04 17:00:19,790 : Registered sensor : Switch Sensor (Name = 'Light Status', ID = '52')<br/>
INFO 2013-09-04 17:00:19,862 : Registered sensor : Switch Sensor (Name = 'switch_sensor', ID = '46')<br/>
INFO 2013-09-04 17:00:20,383 : Startup complete.<br/>
INFO 2013-09-04 17:00:20,408 : Controller Definition File Watcher for Default Deployer started.<br/>
Sep 4, 2013 5:00:22 PM org.apache.coyote.http11.Http11Protocol start<br/>
INFO: Starting Coyote HTTP/1.1 on http-18581<br/>
Sep 4, 2013 5:00:22 PM org.apache.catalina.startup.Catalina start<br/>
INFO: Server startup in 37777 ms<br/>
INFO 2013-09-04 18:24:55,718 : </p>

<p>--------------------------------------------------------------------</p>

<p>  UNDEPLOYING CURRENT CONTROLLER RUNTIME...</p>

<p>--------------------------------------------------------------------</p>

<p>INFO 2013-09-04 18:24:55,721 : Stopped event processor : Drools Rule Engine<br/>
INFO 2013-09-04 18:24:55,723 : Stopped event processor : RRD4J Data Logger<br/>
INFO 2013-09-04 18:24:55,758 : Shutdown complete.<br/>
INFO 2013-09-04 18:24:55,759 : </p>

<p>--------------------------------------------------------------------</p>

<p>  DEPLOYING NEW CONTROLLER RUNTIME...</p>

<p>--------------------------------------------------------------------</p>

<p>INFO 2013-09-04 18:24:55,910 : No rule definitions found in '/volume1/@appstore/OpenRemote/webapps/controller/rules'.<br/>
INFO 2013-09-04 18:24:55,910 : Initialized event processor : Drools Rule Engine<br/>
INFO 2013-09-04 18:24:55,964 : Initialized event processor : RRD4J Data Logger<br/>
INFO 2013-09-04 18:24:56,111 : Registered sensor : Switch Sensor (Name = 'Light Status', ID = '52')<br/>
INFO 2013-09-04 18:24:56,112 : Registered sensor : Switch Sensor (Name = 'switch_sensor', ID = '46')<br/>
INFO 2013-09-04 18:24:56,624 : Startup complete.<br/>
ERROR HTTP\-Thread\-3: Error in handling REST API response: org.openremote.controller.protocol.zwave.model.Controller cannot be cast to org.openremote.controller.protocol.zwave.model.Switch<br/>
java.lang.ClassCastException: org.openremote.controller.protocol.zwave.model.Controller cannot be cast to org.openremote.controller.protocol.zwave.model.Switch<br/>
	at org.openremote.controller.protocol.zwave.ZWaveCommand.send(ZWaveCommand.java:57)<br/>
	at org.openremote.controller.service.impl.ControlCommandServiceImpl.trigger(ControlCommandServiceImpl.java:95)<br/>
	at org.openremote.controller.rest.ControlCommandRESTServlet.handleRequest(ControlCommandRESTServlet.java:77)<br/>
	at org.openremote.controller.rest.RESTAPI.doPost(RESTAPI.java:125)<br/>
	at org.openremote.controller.rest.RESTAPI.doGet(RESTAPI.java:81)<br/>
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)<br/>
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)<br/>
	at org.openremote.controller.rest.support.json.JSONCallbackFilter.doFilter(JSONCallbackFilter.java:58)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)<br/>
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:78)<br/>
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:77)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)<br/>
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)<br/>
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)<br/>
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)<br/>
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)<br/>
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)<br/>
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)<br/>
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)<br/>
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)<br/>
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:354)<br/>
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)<br/>
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)<br/>
	at java.lang.Thread.run(Thread.java:662)</p>


<p>My Z-Wave.log file:</p>

<p>INFO 2013-09-04 17:00:08,565 (Z-WAVE): Reader thread asked to start<br/>
INFO 2013-09-04 17:00:08,598 (Z-WAVE): Writer thread asked to start<br/>
INFO 2013-09-04 17:00:08,600 (Z-WAVE): Writer thread starting<br/>
DEBUG 2013-09-04 17:00:08,604 (Z-WAVE): sending: 01 08 00 54 00 01 01 01 01 a3 <br/>
DEBUG 2013-09-04 17:00:08,606 (Z-WAVE): Message lock exists. Frame waiting: 01 03 00 02 fe <br/>
DEBUG 2013-09-04 17:00:08,624 (Z-WAVE): received: 06 01 04 01 54 00 ae <br/>
DEBUG 2013-09-04 17:00:08,629 (Z-WAVE): Controller registered as SUC/SIS<br/>
DEBUG 2013-09-04 17:00:08,664 (Z-WAVE): sending: 06 <br/>
DEBUG 2013-09-04 17:00:08,664 (Z-WAVE): sending: 01 03 00 02 fe <br/>
DEBUG 2013-09-04 17:00:08,683 (Z-WAVE): received: 06 <br/>
DEBUG 2013-09-04 17:00:08,734 (Z-WAVE): received: 01 25 01 02 05 00 1d 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 01 c2 <br/>
DEBUG 2013-09-04 17:00:08,735 (Z-WAVE): Node id: 1 discovered<br/>
DEBUG 2013-09-04 17:00:08,739 (Z-WAVE): sending: 06 <br/>
DEBUG 2013-09-04 17:00:08,740 (Z-WAVE): sending: 01 04 00 41 01 bb <br/>
DEBUG 2013-09-04 17:00:08,756 (Z-WAVE): received: 06 01 09 01 41 92 16 00 02 02 01 33 <br/>
DEBUG 2013-09-04 17:00:08,757 (Z-WAVE): sending: 06 <br/>
DEBUG 2013-09-04 17:00:18,927 (Z-WAVE): Building Z-Wave command<br/>
DEBUG 2013-09-04 17:00:18,928 (Z-WAVE): Z-Wave command: nodeId = 1<br/>
DEBUG 2013-09-04 17:00:18,928 (Z-WAVE): Z-Wave command: command = on/off<br/>
DEBUG 2013-09-04 17:00:18,929 (Z-WAVE): Z-Wave command: paramValue = null<br/>
DEBUG 2013-09-04 17:00:18,929 (Z-WAVE): Z-Wave command created successfully<br/>
DEBUG 2013-09-04 17:00:19,869 (Z-WAVE): *** setSensor called as part of EventListener init *** sensor is: Switch Sensor (Name = 'switch_sensor', ID = '46')<br/>
DEBUG 2013-09-04 18:24:56,029 (Z-WAVE): Building Z-Wave command<br/>
DEBUG 2013-09-04 18:24:56,030 (Z-WAVE): Z-Wave command: nodeId = 1<br/>
DEBUG 2013-09-04 18:24:56,030 (Z-WAVE): Z-Wave command: command = on/off<br/>
DEBUG 2013-09-04 18:24:56,030 (Z-WAVE): Z-Wave command: paramValue = null<br/>
DEBUG 2013-09-04 18:24:56,030 (Z-WAVE): Z-Wave command created successfully<br/>
DEBUG 2013-09-04 18:24:56,113 (Z-WAVE): *** setSensor called as part of EventListener init *** sensor is: Switch Sensor (Name = 'switch_sensor', ID = '46')<br/>
DEBUG 2013-09-04 18:25:37,971 (Z-WAVE): Building Z-Wave command<br/>
DEBUG 2013-09-04 18:25:37,971 (Z-WAVE): Z-Wave command: nodeId = 1<br/>
DEBUG 2013-09-04 18:25:37,972 (Z-WAVE): Z-Wave command: command = on<br/>
DEBUG 2013-09-04 18:25:37,972 (Z-WAVE): Z-Wave command: paramValue = null<br/>
DEBUG 2013-09-04 18:25:37,972 (Z-WAVE): Z-Wave command created successfully</p>

<p>Does anyone see what i've missed?<br/>
I've being looking in the forum but couldn't find any answers.<br/>
(Don't judge me to hard i'm a newbie)</p>

<p>Many thanks<br/>
Java.</p>



				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-22876051"></a>
                                    <font class="smallfont"><p>That's an ugly looking error.</p>

<p>1) we should handle the error better &#8211; there seems to be an unchecked cast somewhere in the code (I will have to look later)</p>

<p>2) it's possible that the unchecked cast is happening because of some funky configuration mistakes (which if true we should also be more careful about)</p>

<p>Are you still stuck with this issue or have you found any configuration errors that got rid of the message?</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Sep 06, 2013 22:15
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876104"></a>
                                    <font class="smallfont"><p>I'm still stuck. I haven't found any config errors yet.<br/>
Looking forward to here from you.</p>

<p>Many thanks for your answer.<br/>
Stefan</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by java at Sep 07, 2013 10:59
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876105"></a>
                                    <font class="smallfont"><p>The error handling there is definitely poor and we need to improve it. Without additional logging it looks like you are attempting to send an "ON" command which the Z-Wave implementation only allows for Switch type of devices. Apparently whatever is discovered as your "node 1" doesn't translate to a Z-wave Switch device type.</p>

<p>What kind of Z-wave device are you attempting to control with the 'ON' command?</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Sep 07, 2013 11:12
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876106"></a>
                                    <font class="smallfont"><blockquote><p>Apparently whatever is discovered as your "node 1" doesn't translate to a Z-wave Switch device type.</p></blockquote>
<p>Afaik node 1 is by default used for the controller (Aeon stick). Does your setup function in <a href="http://en.z-wave.me/content/how-start-using-z-cloud"><em>Z-Cloud</em></a>? If not you can try there to exclude and (re)include your devices there for free.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Sep 07, 2013 12:01
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876132"></a>
                                    <font class="smallfont"><p>Looks like your switch is not included do the zwave network. Only one node is discovered and that is the controller with id 1.<br/>
You need to include your switch and  then use the id of  the switch inside the command.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Sep 08, 2013 00:01
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22876172"></a>
                                    <font class="smallfont"><p>Hello <br/>
I think i'm the happiest man on earth. I god it working. Something had happend with my switch. I broke the power to it and connected it again. Excluded it from my net and then included it again. Put it in my synology again and started it up. Looked in zwave.log and there it was. Changed the nod id in the Designer, started up the Controller and syncted it with the Designer,started up the Webconsole, hit the ON-button and the light was on.</p>

<p>Many thanks for the help<br/>
Stefan</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by java at Sep 09, 2013 18:54
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:43</font></td>
		    </tr>
	    </table>
    </body>
</html>