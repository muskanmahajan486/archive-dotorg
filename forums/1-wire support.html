<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : 1-wire support</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : 1-wire support
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Feb 05, 2010 by <font color="#0050B2">mredeker</font>.
				    </div>

				    <p>Hi guys,</p>

<p>I am currently looking into supporting 1-wire sensors to measure temperature and humidity in my rooms.<br/>
You can get a 1-wire USB connector for around $13 and a temperature sensors is a dollar <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>I use the owfs project for linux to access the 1-wire bus using the "owserver" program.<br/>
That provides a socket which can be accessed by the java library "jowfsclient".<br/>
It took me 5 minutes and 5 lines of code to have my room temperature read by the controller.<br/>
It would be really nice if we could display the result on the iPhone.</p>

<p>&#45;-Marcus</p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/9601028/15663130.png">Command.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/9601028/15663131.png">Sensor.png</a> (image/png)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-9601029"></a>
                                    <font class="smallfont"><p>To support this really nicely, I would like to see the following functionality:</p>
<ul>
	<li>Assign a name to a 1-wire sensor using our composer or through a web page on the controller (controller could display all found sensors)</li>
	<li>Display the configured sensors within the iPhone app (temperature and humidity)</li>
	<li>Overlay the temperature/humidity on the floorplan within the iPhone app</li>
	<li>Configure a timer that reads the sensor data in a given interval and writes the result into a database (statistics with rdd)</li>
	<li>Configure KNX group addresses to write the sensor data on the KNX bus</li>
	<li>Use the rule engine to perform certain tasks once a configured temperature is reached</li>
</ul>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Feb 06, 2010 00:16
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601068"></a>
                                    <font class="smallfont"><p>Good list. I will get the 2.0 online and we can start looking into this.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Feb 10, 2010 11:06
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-13697381"></a>
                                    <font class="smallfont"><p>Hi Marcus,</p>

<p>Have you ever committed the 1-wire code somewhere ?</p>

<p>Thanks,<br/>
Eric</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Dec 13, 2010 17:57
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-13697383"></a>
                                    <font class="smallfont"><p>No yet. Just started to look into it actually because of the new house.</p>

<p>I have about 20 temp sensors and 5 humidity sensors installed and would like to see this stuff in openremote.</p>

<p>Hopefully&nbsp; I find some time in the coming weeks.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 13, 2010 22:21
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-13697582"></a>
                                    <font class="smallfont"><p>I've got my 1wire up and running again yesterday ( after a diskfailure ) so I can help you in testing things out. I have a 2.0.0-devel11 controller running on the same hardware.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by nivis at Dec 28, 2010 11:38
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-13697586"></a>
                                    <font class="smallfont"><p>Great. I finished the 1-wire network over the X-mas days and have all sensors up and running now.<br/>
Everything is accessed through <a href="http://owfs.org/">http://owfs.org/</a> and I will look into cleaning up my code now and commit some stuff.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 28, 2010 19:31
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-14254124"></a>
                                    <font class="smallfont"><p>Juha,<br/>
I am ready to dig into this now and was wondering how we want to save the temperature data? For historical charting we will need some kind of database. We could use rddtool and do system calls (not nice), implement something on our own (save sensor data in mysql?) or maybe use JRobin (rddtool port to java). I will probably give JRobin a try, what do you think? I think we already have periodical sensor reading in 2.0, how can I get my 1wire sensor(s) to be read every 5 minutes?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jan 02, 2011 20:20
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532656"></a>
                                    <font class="smallfont"><p>Hi,</p>

<p>is there anything new regarding 1-wire support in OpenRemote? I'd like to help either with implementation if necessary/possible. I have 1-wire network that includes switch, temperature, humidity sensors and barometer at the moment. Is there anything I can help beta test, or should I try to implement 1-wire support from scratch?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by jmisura at Feb 20, 2011 12:05
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532666"></a>
                                    <font class="smallfont"><p>Nothing new yet. I am currently trying to add RRD support using JRobin and would like to send 1-wire reading onto the KNX bus.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Feb 20, 2011 19:45
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532673"></a>
                                    <font class="smallfont"><p>Could we please have a sneak peek? <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>Eager to get going...</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by nivis at Feb 21, 2011 08:47
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532676"></a>
                                    <font class="smallfont"><p>Can you please describe your plans, how do you want to implement this? </p>

<p>I did some proof of concept "the simple way":</p>

<p>I created trivial web application that is accessible via specific URL and provide response from 1-wire. Then I used http protocol for sensor to access values that I need.</p>

<p>for example,</p>

<p><a href="http://myhost:8080/WireNet/sensor/OW2_Kitchen/temperature">http://myhost:8080/WireNet/sensor/OW2_Kitchen/temperature</a> </p>

<p><a href="http://myhost:8080/WireNet/sensor/OW2_Kitchen/humidity">http://myhost:8080/WireNet/sensor/OW2_Kitchen/humidity</a></p>

<p><a href="http://myhost:8080/WireNet/sensor/OW1_Office/temperature">http://myhost:8080/WireNet/sensor/OW1_Office/temperature</a></p>

<p>provides access to owserver value of "temperature" of 1-wire device "/1F.E9E803000000/main/28.25E9E3010000" that has alias "OW2_Kitchen". <br/>
This URL format .../sensor/device_alias/filename can be then used for any kind of 1-wire device that provides readable values.</p>

<p>I needed to assign aliases to devices, because my 1-wire network uses switch + plenty of devices and this keeps it nice and tidy <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>I preferred this translation layer, since it reuses existing sensor already present in OpenRemote, it is very easy to implement and provides ability to easily do some advanced things like virtual devices (for example, virtual device may be "AvgHouseTemperature" that will return weighted average temperature of specific group of thermometers, etc) in the future. <br/>
My initial plan was to do some data logging and rules in this layer, but I didn't start any implementation of this part yet. I wonder if OpenRemote would be better place for this, or if it is better to use OpenRemote as "user interface" part only and keep logging away from it.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by jmisura at Feb 21, 2011 14:36
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532680"></a>
                                    <font class="smallfont"><p>Hi all,</p>

<p>I also have 1-wire controller implemented. I was just surprised, that value is read in a loop with very short delay. Is this behaviour normal, or is it my mistake? <br/>
If anybody is interested, I can provide it for some more testing. I believe locally running Designer is necessary for this, since online version (of course) does not contain protocol xml file.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by jmisura at Feb 21, 2011 20:09
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532682"></a>
                                    <font class="smallfont"><p>Jaroslav,</p>

<p>did you only implement the StatusCommand interface or already did some kind of interface to display all attached sensors? I would like to provide a page within the controller to display the sensors and create a file which can be uploaded to the modeller to configure the devices.</p>

<p>The read loop indeed is polling really often in the moment. We have to create some kind of interface so that a StatusCommand can tell that it only wants to be read every so and so second.</p>

<p>Maybe you can share your code already?</p>

<p>&#45;-Marcus</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Feb 21, 2011 20:26
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532685"></a>
                                    <font class="smallfont"><p>I just implemented StatusCommand interface + added protocol xml to Designer, so you can configure your sensors in UI:</p>

<p><img src="attachments/9601028/15663130.png" align="left" border="0"/></p>

<p><img src="attachments/9601028/15663131.png" align="absmiddle" border="0"/>|align=left!</p>

<p>Then you can use these values in Modeler, which is what I was looking for <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/>. </p>

<p>Regarding code, sure I can. I wonder what would be the best way to do it? There are some new files in both Controller and Modeler (UIDesigner). I, just like you, used jowfsclient, which uses BSD license. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by jmisura at Feb 21, 2011 21:24
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532686"></a>
                                    <font class="smallfont"><p>Sorry haven't been paying attention to this thread before.</p>

<p>Jaroslav, please send me an email at juha at openremote org, and let's get your additions into the project release branch.</p>

<p>Thanks,</p>

<p>&#8211; Juha</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by admin at Feb 21, 2011 21:37
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532687"></a>
                                    <font class="smallfont"><p>Oh and btw, <b>EXCELLENT</b> work!!! <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by admin at Feb 21, 2011 21:39
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532688"></a>
                                    <font class="smallfont"><p>This looks great. Please contact Juha.</p>

<p>The hostname and port to contact owserver should probably only once be configured in the controller properties and not on a per sensor basis.</p>

<p>What is the "Filename" used for?</p>

<p>I am currently adding JRobin to store the collected sensor data in a round robin database.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Feb 21, 2011 21:54
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532690"></a>
                                    <font class="smallfont"><p>This would be nice for most common use case, but in general, somebody may need to access more owservers for some reason. If you click "Submit and continue", values are preserved, so it is really quick to enter more sensors in a row even without this global configuration. </p>

<p>I wasn't sure how to call the field that is now called Filename. It is the name of file in 1-wire device directory that holds value we want to use. For thermometer reading, it is "temperature" (but also "temperature9" ... "temperature12", depending on the device family), for humidity sensor it is "humidity"... this way I can use any readable value from 1-wire network as a source of openremote sensor data. I do not really check value of this field, which gives me some flexibility at the moment, but it may theoretically be a security issue. I will find possible useful names and do some extra validation on this field. If anyone has a good idea how to call the field, let me know <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/>. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by jmisura at Feb 21, 2011 22:06
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532692"></a>
                                    <font class="smallfont"><p>More then one server might be a rare situation, but you have a point.</p>

<p>I&nbsp; called the field "SensorAttribute" <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Feb 21, 2011 22:12
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532695"></a>
                                    <font class="smallfont"><p>Hi All</p>

<p>I am new to 1-wire but it looks to be a very cost effective way to capture data.</p>

<p>Would it be possable to give an overview and parts list so we could better understand how to build and</p>

<p>impliment souch a 1-wire system. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pjmm at Feb 21, 2011 23:44
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532696"></a>
                                    <font class="smallfont"><p>It is really cheap. All you need is a USB busmaster, some twisted-pair cable and a few sensors.</p>

<p>Here you find some general infos <a href="http://en.wikipedia.org/wiki/1-Wire">Wiki 1-Wire</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Feb 21, 2011 23:52
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532878"></a>
                                    <font class="smallfont"><p>Hi all,</p>

<p>if somebody is interested, 1-wire support is in trunk now and also available in online designer. I tested both and it works for me. If you have any questions, suggestions or improvements, let me know (or let's do it<img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/>). </p>

<p>In online designer, you can assign any "type" to sensor, because this field is not taken into account at the moment. In general, both temperature and humidity should probably be range, so if you set it now, you won't need to change it later on if/when it will be implemented. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by jmisura at Mar 07, 2011 17:32
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532884"></a>
                                    <font class="smallfont"><p>There's a binary snapshot of the current controller available for download with 1-wire support included : <a href="http://sourceforge.net/projects/openremote/files/For%20Developers/OpenRemote-2.0.0-SNAPSHOT-20110307.zip/download">http://sourceforge.net/projects/openremote/files/For%20Developers/OpenRemote-2.0.0-SNAPSHOT-20110307.zip/download</a></p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Mar 08, 2011 05:51
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532951"></a>
                                    <font class="smallfont"><p>I added documentation for 1-Wire protocol here:</p>

<p><a href="http://www.openremote.org/display/docs/OpenRemote+2.0+How+To+-+1-Wire+Sensors">http://www.openremote.org/display/docs/OpenRemote+2.0+How+To+-+1-Wire+Sensors</a></p>

<p>Can somebody please review it and let me know if there are any issues? </p>

<p>Thanks <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>jaro</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by jmisura at Mar 13, 2011 21:24
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532954"></a>
                                    <font class="smallfont"><p>I like it <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/><br/>
No issues from my side. Thanks&#33;<br/>
When I find some time I will look into putting the collected data into RDD and I also want these to be sent onto the KNX bus to control my heating.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Mar 13, 2011 22:48
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532955"></a>
                                    <font class="smallfont"><p>Excellent work Jaro! I am very happy with the professional look.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Mar 14, 2011 05:36
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:29</font></td>
		    </tr>
	    </table>
    </body>
</html>