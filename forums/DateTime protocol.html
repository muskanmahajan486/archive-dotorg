<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : DateTime protocol</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : DateTime protocol
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Oct 11, 2011 by <font color="#0050B2">mredeker</font>.
				    </div>

				    <p>Based on the discussion <a href="http://www.openremote.org/display/forums/Actual+list+of+supported+KNX+DPT%27s">here</a> I started to implement a DateTime protocol. I am thinking about the following:</p>

<p>DateTime commands can be used to display date or time on the console or use certain DateTime events to trigger rules.<br/>
To calculate sunrise and sunset the location has to be given as longitude, latidude and timezone.<br/>
Timezone is the string identifier which is available in Java eg. Europe/Berlin</p>

<p>The following commands will be available:</p>
<ul class="alternate" type="square">
	<li>date (returns a date/time as string depending on the given formatter)</li>
	<li>sunrise (returns the sunrise time as string depending on the given formatter)</li>
	<li>sunset (returns the sunset time as string depending on the given formatter)</li>
	<li>minutesUntilSunrise (returns an integer with the minutes until sunrise)</li>
	<li>minutesUntilSunset (returns an integer with the minutes until sunset)</li>
	<li>isDay (returns a boolean string)</li>
	<li>isNight (returns a boolean string)</li>
</ul>


<p>Other DateTime based information (something like isWeekend, isWeekday, isHoliday) could be added.</p>

<p>To create a command which display the time you would design it with these parameters:</p>

<p>command = date<br/>
timezone = Europe/Berlin<br/>
format = HH:mm:ss</p>

<p>Or if you want to display date and time you would use:</p>

<p>command = date<br/>
timezone = Europe/Berlin<br/>
format = dd.MM.yyyy HH:mm:ss</p>

<p>Any ideas and comments are appreciated.</p>

				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-19432879"></a>
                                    <font class="smallfont"><p>Marcus,</p>

<p>Fits perfectly my needs. Nothing to add.</p>

<p>Rick</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by rickcn at Oct 11, 2011 14:30
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19432881"></a>
                                    <font class="smallfont"><p>Hallo Marcus,</p>

<p>you are talking about KNX, and nothing but KNX, right? In a world with NTP I cannot really make sense of it otherwise.</p>

<p>Please allow me to recommend the <a href="http://mikereedell.github.com/sunrisesunsetlib-java/">Sunrise-Sunset Library in Java</a> by Mike Reedell. It does everything you want, including sunrise/sunset for arbitrary declinations (not just the official ones), it is written in Java, is free ("open source") software under the Apache License. (I have even submitted a patch to it once), It lowers my external blinds every evening when the sun is exactly 3Â° under the horizon. Since years..,</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by barf at Oct 11, 2011 17:14
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19432882"></a>
                                    <font class="smallfont"><p>That is exectlay the library I am using <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> </p>

<p>And no, I am not talking about KNX. It's based on the time the controller has (which would probably be NTP) and to use that to either fill label fields on console our use it as events for the rule engine eg. if movement and isNight then turn light on.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Oct 11, 2011 17:29
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19432923"></a>
                                    <font class="smallfont"><p>A first version is checked-in under my SVN workspace directory in a subdirectory called "Controller_EP_SNAP_DateTime_WOL".<br/>
This will probably make it into the 2.0 release.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Oct 13, 2011 16:33
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22873415"></a>
                                    <font class="smallfont"><p>Is there a way to use DateTime Protocol to start a counter?  For example, when a user pushes a button on the GUI (to turn on a light), a counter starts to display how long that light has been on.  Then when the light is turned off, the counter stops.  </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by brandoncreel at Jun 27, 2013 16:34
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22873417"></a>
                                    <font class="smallfont"><p>Sounds more like a rule</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jun 27, 2013 20:01
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:30</font></td>
		    </tr>
	    </table>
    </body>
</html>