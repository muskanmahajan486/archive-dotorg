<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Button press hold time</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Button press hold time
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Feb 26, 2013 by <font color="#0050B2">aktur</font>.
				    </div>

				    <p>Hello,</p>

<p>is it possible to code different commands based on time duration a button is pressed. For example to remake Apple TV remote which executes different commands depending if a button is hold for a short or a long time period?</p>

<p>Another question I have if there is possible to have confirmation dialog to some buttons? I have the following problem, one of my buttons is used to switch off all A/V (TV+home cin+sat+etc) It works pretty cool when I indeed want to switch all off, a real time saver which is very difficult to achieve with other solutions than OR. However, I have a problem when I hit this button by mistake which is very possible. Then everything is going off and I can do nothing about it now.</p>

<p>Ons solution would be a confirmation dialog for such critical buttons, the other solution would be to press these critical buttons really long, for few seconds, before they fire their action.</p>

				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-21858063"></a>
                                    <font class="smallfont"><p>Hi Michal,</p>

<p>We did implement the "long press feature" a long time ago but it never got merged into the mainstream release because of backwards compatibility issue. This allowed to have actions for press, short release and long release.</p>

<p>You should be able to find the branches (mostly in my workspace I think), but this wouldn't be a very useful solution as you would need to maintain your own setup with this feature.</p>

<p>The path to bring that in is to have a mechanism to support backwards compatibility (in panel, controller and potentially designer). Some work has been done for that but it's not finished yet.</p>

<p>For the confirmation dialog, you can have the button navigate to a separate page, with only 2 buttons, the all off that does the direct action and a back button (in the navigation option in the designer, there is a back command that will navigate back the stack, just like the back button in a browser). </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Feb 26, 2013 17:23
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21858091"></a>
                                    <font class="smallfont"><p>Hi Eric,</p>

<p>thanks for the tip about the confirmation dialog.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Feb 27, 2013 15:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21858197"></a>
                                    <font class="smallfont"><p>There is one problem with the confirmation dialog on a separate page. As I've made it on different group (don't want to swipe into it), it happens sometimes when I reenter openremote on iOS then it open on this confirmation page but the cancel button does not navigate me back to anything. I must to kill the app and restart it. Then it starts again with the first group. It happens intermittently. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Mar 03, 2013 16:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21858205"></a>
                                    <font class="smallfont"><p>I did notice something similar, this is because the "navigation stack" is not persisted between application launch, only the last visited page.</p>

<p>So on application relaunch, it will go to the last page you were on (confirmation dialog), but the back button will do nothing as this is the first page displayed (in this run of the application).</p>

<p>I will fix this in iOS 2.2 console by persisting the whole navigation stack.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Mar 04, 2013 10:03
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874387"></a>
                                    <font class="smallfont"><p>Hi Eric,</p>

<p>I am very interested in trying a project which would incorporate press-release buttons (one command when button is pressed, followed by another command on release).</p>

<p>Having read the above and your thread <a href="http://openremote.org/pages/viewpage.action?pageId=16024273">http://openremote.org/pages/viewpage.action?pageId=16024273</a>, I built a controller from your workspace <a href="http://openremote.svn.sourceforge.net/viewvc/openremote/workspace/ebariaux/Controller_2_0_0_Alphas_ButtonEnhancement/,but">http://openremote.svn.sourceforge.net/viewvc/openremote/workspace/ebariaux/Controller_2_0_0_Alphas_ButtonEnhancement/,but</a> of course it does not work this way. You do mention above, that it isn't a very good solution, as I would have to maintain my own setup. What exactly do you mean by this, and do you think I could somehow move forward in order to try and test it someway?</p>

<p>Thank in advance</p>

<p>Gabor</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by czruska at Aug 04, 2013 16:44
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874422"></a>
                                    <font class="smallfont"><p>Not sure from your message above what does not work, but at least the XML required/generated for this feature is different from the one generated from the current on-line designer.</p>

<p>This means that to use the controller you're pointing to, you would either need to manually edit the controller.xml file for the supported syntax or you need to install a local designer (and beehive) on your machine, that does support the long press feature.</p>

<p>And even if it worked, you would need to do that in order to be able to define the actions for short release, long press, ...</p>

<p>When I said you would have to maintain your own setup, I meant that<br/>
1) you would need, as I just said, to use a local designer<br/>
2) you will not get any of the new features/fixes developed after these long press branches. To get them, you would need to branch from an up to date branch (one for controller, one for designer) and merge back the changes that were done in the long press branches. This way you get an up to date version with the long press feature. You would need to do that on regular basis if there are anything that you'd like to use in the newer releases to we do.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Aug 05, 2013 11:52
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874431"></a>
                                    <font class="smallfont"><p>Thanks for your quick response, I also thought of something familiar. I'll try playing with the controller.xml file and see how I get along and later maybe even build an own setup - although that seems quite complicating to me.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by czruska at Aug 05, 2013 15:28
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874635"></a>
                                    <font class="smallfont"><p>To test the button enhancement controller I set up a simple panel with a single button and command, manually adjusted the controller and panel xml files according to the guides in controller-2.0-M7.xsd and panel.2.0.M7.xsd files.<br/>
My controller.xml is now as below:</p>

<p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>
&lt;openremote xmlns="http://www.openremote.org" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openremote.org <a href="http://www.openremote.org/schemas/controller.xsd">http://www.openremote.org/schemas/controller.xsd</a>"&gt;<br/>
  &lt;components&gt;<br/>
    &lt;button id="9"&gt;<br/>
    &lt;macro commandParam="press"&gt;     <br/>
    &lt;include type="command" ref="10" /&gt;             <br/>
    &lt;/macro&gt;<br/>
    &lt;/button&gt;<br/>
    &lt;/components&gt;<br/>
  &lt;sensors /&gt;<br/>
  &lt;commands&gt;<br/>
  &lt;command id="10" protocol="socket"&gt;<br/>
      &lt;property name="port" value="4998" /&gt;<br/>
      &lt;property name="command" value="sendir,1:3,1,36764,1,1,63,129,16,16,16,48,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,48,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,48,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,48,16,16,16,16,16,48,16,48,16,16,16,16,16,16,16,48,16,16,16,16,16,48,16,48,16,16,16,48,16,3676" /&gt;<br/>
      &lt;property name="ipAddress" value="192.168.1.70" /&gt;<br/>
      &lt;property name="name" value="Mute" /&gt;<br/>
      &lt;/command&gt;<br/>
  &lt;/commands&gt;<br/>
  &lt;config&gt;<br/>
    &lt;property name="controller.roundrobin.multicast.port" value="10000" /&gt;<br/>
    &lt;property name="controller.roundrobin.tcpserver.port" value="20000" /&gt;<br/>
    &lt;property name="controller.groupname" value="floor20" /&gt;<br/>
    &lt;property name="multicast.port" value="3333" /&gt;<br/>
    &lt;property name="controller.groupmember.autodetect.on" value="true" /&gt;<br/>
    &lt;property name="amx_ni.port" value="50000" /&gt;<br/>
    &lt;property name="zwave.commLayer" value="" /&gt;<br/>
    &lt;property name="copy.lircd.conf.on" value="true" /&gt;<br/>
    &lt;property name="irsend.path" value="/usr/local/bin/irsend" /&gt;<br/>
    &lt;property name="controller.applicationname" value="controller" /&gt;<br/>
    &lt;property name="multicast.address" value="224.0.1.100" /&gt;<br/>
    &lt;property name="Macro.IR.Execution.Delay" value="500" /&gt;<br/>
    &lt;property name="controller.roundrobin.multicast.address" value="224.0.1.200" /&gt;<br/>
    &lt;property name="zwave.comPort" value="" /&gt;<br/>
    &lt;property name="zwave.pad.port" value="7876" /&gt;<br/>
    &lt;property name="lutron_homeworks.password" value="openremote" /&gt;<br/>
    &lt;property name="lagarto_network.broadcast" value="tcp://127.0.0.1:5001" /&gt;<br/>
    &lt;property name="lircd.conf.path" value="/etc/lircd.conf" /&gt;<br/>
    &lt;property name="lutron_homeworks.port" value="23" /&gt;<br/>
    &lt;property name="lutron_homeworks.address" value="192.168.1.1" /&gt;<br/>
    &lt;property name="zwave.pad.host" value="localhost" /&gt;<br/>
    &lt;property name="lutron_homeworks.username" value="openremote" /&gt;<br/>
    &lt;property name="webapp.port" value="8080" /&gt;<br/>
    &lt;property name="protocol.zwave.classname" value="org.openremote.controller.protocol.zwave.ZWaveCommandBuilder" /&gt;<br/>
    &lt;property name="resource.upload.enable" value="true" /&gt;<br/>
    &lt;property name="amx_ni.address" value="192.168.1.1" /&gt;<br/>
  &lt;/config&gt;<br/>
&lt;/openremote&gt;</p>

<p>Panel.xml as below:</p>

<p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>
&lt;openremote xmlns="http://www.openremote.org" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.openremote.org <a href="http://www.openremote.org/schemas/panel.xsd">http://www.openremote.org/schemas/panel.xsd</a>"&gt;<br/>
  &lt;panels&gt;<br/>
    &lt;panel id="1" name="Teszt"&gt;<br/>
      &lt;include type="group" ref="2" /&gt;<br/>
    &lt;/panel&gt;<br/>
  &lt;/panels&gt;<br/>
  &lt;screens&gt;<br/>
    &lt;screen id="5" name="Starting Screen" landscape="true"&gt;<br/>
      &lt;absolute left="279" top="203" width="210" height="226"&gt;<br/>
      &lt;button id="9" name="xxx" hasPressCommand="true"/&gt;<br/>
      &lt;/absolute&gt;<br/>
    &lt;/screen&gt;<br/>
  &lt;/screens&gt;<br/>
  &lt;groups&gt;<br/>
    &lt;group id="2" name="Default Group"&gt;<br/>
      &lt;include type="screen" ref="5" /&gt;<br/>
    &lt;/group&gt;<br/>
  &lt;/groups&gt;<br/>
&lt;/openremote&gt;</p>

<p>Running controller shows no problems, however the command does not go through</p>

<p>I tried all versions (press,shortRelease,longPress,longRelease), but the command is never executed</p>

<p>Probably I am doing something wrong, are my adjusted xml files correct?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by czruska at Aug 12, 2013 11:00
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874636"></a>
                                    <font class="smallfont"><p>From very quick glance, it looks OK to me.</p>

<p>What client are you using ? I think there is something to do there too (sorry, it's been a long time since I implemented that feature).</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Aug 12, 2013 11:06
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874714"></a>
                                    <font class="smallfont"><p>I am using iOS (Ipad), but tried Android (2.1.0 beta) also. Web Console is not available with this controller (Console error is the response).<br/>
I know its been a long time and I really wouldn't like to bother you with this, I was just curious to see how the buttons react to these enhanced features, since a possible press-release function sound exciting.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by czruska at Aug 12, 2013 15:37
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22874719"></a>
                                    <font class="smallfont"><p>So yes, the console should also use updating parsing code to pickup the new attributes.<br/>
This is already foreseen in iOS code but switch is not automatic, so you need to use a flag when compiling the console for it to use the correct parser.</p>

<p>If you want to go forward with this, just send me an e-mail eric <a href="at.html" title="at">at</a> openremote dot org and I'll send you an invite for a beta version of the iOS console with this feature.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Aug 12, 2013 16:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22878687"></a>
                                    <font class="smallfont"><p>I'd love this on Android also (although as mentioned in another thread, I have to use 2.0.0 beta 2 due to screen issues on my Nexus 7.<br/>
My UK VirginMedia Tivo has some keys on the IR remote which behave differently if held, as opposed to press.  I believe (STC) that there are TCP specific commands to replicate that, so short press/long press (or hold) would be good to differentiate.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ptruman at Oct 22, 2013 23:15
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:44</font></td>
		    </tr>
	    </table>
    </body>
</html>