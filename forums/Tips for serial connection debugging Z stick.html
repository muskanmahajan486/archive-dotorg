<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Tips for serial connection debugging Z stick</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Tips for serial connection debugging Z stick
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on May 11, 2015 by <font color="#0050B2">kcwired</font>.
				    </div>

				    <p>I had a run in with getting the Z-wave USB stick working.  (obviously this is for windows users) </p>

<p>My USB bridge port came up on COM5 and I spun my wheels for a whole day.  I was learning openremote for the first time as well, so i couldn't tell a hardware problem from a learning curve.  <br/>
Problems eventually led me to turning on debug,  but i couldn't get the debug logs to log anything.  So,  I had to sleep on it and worked it out the next morning.  </p>

<p>Long story short:  COM5 wasn't being seen by Open remote. (neither was COM1) </p>

<p>Step 1: <br/>
Where ever your USB bridge COM# may land.  <br/>
In your cmd shell, Do a "MODE" command and make sure your shell can see the COM port.  (I ended up on COM2) </p>

<p>Step 2: <br/>
Use COM# in your z-wave protocol.  If open remote doesn't light up with happy console responses, or logs, contemplate a different COM port.  (windows system devices advanced setting) </p>

<p>If you have hyper-terminal or like application that lets you send hex or whatnot to a serial port.  you can fish around and test them for responses from the USB z stick com bridge. you can copy con to a port as well and send stuff, in a pinch, but you cant get responses back on console, so you have to send something that gives feed back in another way (really a modem trouble shooting hack).  </p>

<p>Well,  that was easy, in the end. </p>


				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-23598783"></a>
                                    <font class="smallfont"><p>I only wish things were as simple as this....</p>

<p>I have been trying and trying to get an Aeon Z stick 2 working without ever succeeding. I can get it to work with other programs (Domoticz and In Control) but I never with openremote. I never get any z-wave logs within openremote except for the INFO, timestamp, version startup line. Debug settings turned on or off. It just doesn't want to work with openremote.</p>

<p>One thing to add to your note: Sysinternal's (sysinternals.com - which is owned by M.S.) portmon.exe is also a good tool to monitor your serial port. It can show you if you have any traffic to and from your serial port. When I use the other two programs, I see traffic to the Z stick. When I use openremote... NOTHING. I've tried the mode command and can see it. I've even changed the port to different com ports, but all with no luck. I have tried on two different systems, one 32 bit, one 64 bit. Both work with the other programs, but never with openremote. I would love to get it working so I can move into my next step in programming within openremote. I'd love to only have to use one program to control everything.</p>

<p>I have been through the forums again and again, trying different advice from many different people. Still no luck. I have created, deleted and re-created switches again and again. </p>

<p>My question to anyone with more experience with serial, java and openremote... Is Jave 1.6 really required to get this to work? I have tried 1.8, 1.7 and 1.6 all with the same results.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by kslate at May 12, 2015 03:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23598855"></a>
                                    <font class="smallfont"><p>I'm having a similar problem with a Linux install, seeing only start up lines in the log file.</p>

<p>I'm planning to debug from the OS layer so was wondering if you can you tell me what baud rate the USB Z-wave stick uses and a simple HEX string I can send to get a response?</p>

<p>Thanks</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by dpstockdale at May 13, 2015 23:36
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:34</font></td>
		    </tr>
	    </table>
    </body>
</html>