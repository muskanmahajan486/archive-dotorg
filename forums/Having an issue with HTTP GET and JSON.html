<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Having an issue with HTTP GET and JSON</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Having an issue with HTTP GET and JSON
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Dec 19, 2012 by <font color="#0050B2">datahead</font>.
				    </div>

				    <p>I am having an issue with the HTTP Command GET using a JSON data string. I cant seem to get the JSON expression right. I keep getting a N/A, or when I use custom HTTP command I get the entire string in the label. I have used a JSON parser and the string is correct so I am assuming it is in the JSONPath expression. Any help would be greatly appreciated.</p>

<p>Ron  </p>

<p>______________________<em>COMMAND:</em>___________________________________</p>

<p>Name:			GET_Light_1_Status<br/>
Protocol:		HTTP</p>

<p>			HTTP attributes<br/>
URL:			<a href="http://xxx-xxx-xxx-xxx:PORT/api/object/Light%201">http://xxx-xxx-xxx-xxx:PORT/api/object/Light%201</a>		<br/>
HTTP Method:		GET<br/>
Workload:	<br/>
Username:	<br/>
Password:	<br/>
XPath Expression:<br/>
RegularExpression:	<br/>
Polling interval 	3s<br/>
JSONPath Expression:	$.State</p>

<p>_______________________<em>SENSOR:</em>_____________________________________</p>

<p>Name:		Light_1_Sensor<br/>
Command:	GET_Light_1_Status</p>

<p>Type:		Switch</p>

<p>______________________<em>JAON Paser String</em>______________________________</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">{
<span class="code-quote">"Address"</span>: <span class="code-quote">"L1"</span>,
<span class="code-quote">"BaseType"</span>: <span class="code-quote">"BINARY SWITCH"</span>,
<span class="code-quote">"Container"</span>: <span class="code-quote">"Bedroom 1"</span>,
<span class="code-quote">"Description"</span>: <span class="code-quote">"Light 1"</span>,
<span class="code-quote">"Enabled"</span>: 1,
<span class="code-quote">"Methods"</span>: [
<span class="code-quote">"OFF"</span>,
<span class="code-quote">"ON"</span>
],
<span class="code-quote">"Name"</span>: <span class="code-quote">"Light 1"</span>,
<span class="code-quote">"Properties"</span>: [
{
<span class="code-quote">"DataType"</span>: <span class="code-quote">"<span class="code-object">Integer</span>"</span>,
<span class="code-quote">"Id"</span>: <span class="code-quote">"2913"</span>,
<span class="code-quote">"LastUpdated"</span>: "",
<span class="code-quote">"Name"</span>: <span class="code-quote">"Off Timer"</span>,
<span class="code-quote">"Value"</span>: ""
}
],
<span class="code-quote">"State"</span>: <span class="code-quote">"On"</span>,
<span class="code-quote">"Type"</span>: <span class="code-quote">"X10 RELAY"</span>
}</pre>
</div></div>

<p>_</p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038801/21659657.png">test.png</a> (image/png)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-21038802"></a>
                                    <font class="smallfont"><p>Okay so the string didn't post very well on this forum, but you get the idea, I hope...</p>

<p>Ron</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by datahead at Dec 19, 2012 03:31
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038808"></a>
                                    <font class="smallfont"><p> Thank you PE ZANSTRA for the advice of Posting code. I modified the first post wth the JSON parser String. If anyone else need more info on this issue please let me know.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by datahead at Dec 19, 2012 07:38
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038809"></a>
                                    <font class="smallfont"><p>Ron,<br/>
Do include your code inside the tags {code}  {code}. That makes it look better.<br/>
Pieter</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Dec 19, 2012 07:42
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21039404"></a>
                                    <font class="smallfont"><p>I have the same problem, have you found any solution?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by maze at Jan 06, 2013 20:55
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21528582"></a>
                                    <font class="smallfont"><p>If you use a CustomSensor and the JSONPath Expression "$.State" and you display the custom sensor in a label, do you see something?<br/>
When trying your dara and your expresseion with a Tester, I receive </p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
[
  <span class="code-quote">"On"</span>
]
</pre>
</div></div>
<p>If that is really displayed then the "[" and line breaks could cause a problem if you want to use a switch sensor.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jan 07, 2013 10:18
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21528594"></a>
                                    <font class="smallfont"><p>I receive the complete JSON string. I use CustomSensor and JSONPath Expression "$.State" and display my sensor in a label. Whoever, i don't have any line breaks in the received JSON string. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by maze at Jan 07, 2013 11:48
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21528595"></a>
                                    <font class="smallfont"><p>Ok, so it looks like the expression is not evaluated at all.<br/>
I will have to take a look at the code.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jan 07, 2013 11:57
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21528621"></a>
                                    <font class="smallfont"><p>Best I get is the entire JSON String also. Thank you guy for looking at this issue as the automation system I am using (Open Source Automation) can give OR a lot of information, but if it is the entire JSON string it is pretty much useless, Other than a glorified remote control. If we can resolve this these two applications are made for each other. Thanks again...</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by datahead at Jan 07, 2013 19:12
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21528630"></a>
                                    <font class="smallfont"><p>I just tested this and it works fine. Only "On" is displayed with my label and a custom sensor.<br/>
Could it be that your are not using the latest version?<br/>
I think you have to use the 2.1-DeveloperSnapshot.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jan 07, 2013 22:37
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21528632"></a>
                                    <font class="smallfont"><p>Thanks for the quick response. I am using the standard. 2.0.1 controller from the download page. Should I be using another version? If so, where can I get it and what is the cost?</p>

<p>Ron</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by datahead at Jan 07, 2013 23:04
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21528633"></a>
                                    <font class="smallfont"><p>The 2.1-DeveloperSnapshot is freely available on sourceforge:</p>

<p><a href="http://sourceforge.net/projects/openremote/files/For%20Developers/OpenRemote%202.0%20%28Developer%20Releases%29/OpenRemote-Controller-2.1.0_Developer-Snapshot-20120920.zip/download">http://sourceforge.net/projects/openremote/files/For%20Developers/OpenRemote%202.0%20%28Developer%20Releases%29/OpenRemote-Controller-2.1.0_Developer-Snapshot-20120920.zip/download</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jan 07, 2013 23:08
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21528635"></a>
                                    <font class="smallfont"><p>I will give that a go and let you know what happens. Also, I am using the free version of OR designer. Should I or do I need to purchase the Installer version. I most likely will in the future, however as this project is still in the design phase in my own home I am trying to keep the cost down.</p>

<p>Ron</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by datahead at Jan 07, 2013 23:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21528638"></a>
                                    <font class="smallfont"><p>I reloaded the controller with the OR Controller 2.1.0 Developer-Snapshot and synced up the controller and still getting the same results. Here is a part of the dev.log file:</p>

<p>2013-01-07 16:26:38,672 ERROR <span class="error">&#91;Polling thread for sensor: Status\_Light\_1&#93;</span>: Could not perform jsonpath evaluation<br/>
com.jayway.jsonpath.InvalidPathException: invalid path<br/>
	at com.jayway.jsonpath.internal.filter.FieldFilter.filter(FieldFilter.java:59)<br/>
	at com.jayway.jsonpath.JsonPath.read(JsonPath.java:182)<br/>
	at com.jayway.jsonpath.JsonPath.read(JsonPath.java:202)<br/>
	at com.jayway.jsonpath.JsonPath.read(JsonPath.java:307)<br/>
	at org.openremote.controller.protocol.http.HttpGetCommand.run(HttpGetCommand.java:275)<br/>
	at java.lang.Thread.run(Thread.java:662)</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by datahead at Jan 08, 2013 00:34
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21528739"></a>
                                    <font class="smallfont"><p>I just tested it with the download link I provided. No problems!<br/>
<a class="confluence-thumbnail-link 430x495" href='http://www.openremote.org/download/attachments/21038801/test.png'><img src="attachments/thumbnails/21038801/21659657" align="absmiddle" border="0"/></a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jan 08, 2013 21:16
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21528740"></a>
                                    <font class="smallfont"><p>I deleted the OR directory and re-reloaded the OR Controller 2.1.0 Developer-Snapshot and it seems to be working now. Thank you very much for all the help.</p>

<p>Ron</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by datahead at Jan 08, 2013 23:34
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:45</font></td>
		    </tr>
	    </table>
    </body>
</html>