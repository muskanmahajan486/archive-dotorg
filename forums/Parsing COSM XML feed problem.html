<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Parsing COSM XML feed problem</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Parsing COSM XML feed problem
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jun 30, 2012 by <font color="#0050B2">salesguy</font>.
				    </div>

				    <p>Hi.  I have a problem parsing a cosm XML data response, and I can't sort out why openremote won't parse the response using XPATH while another application - thinkspeak will parse the exact same response using the same XPATH.</p>

<p>Openremote is successfully requesting the data, and the response is below.  My XPATH expression is:</p>

<p>//data<span class="error">&#91;@id=&#39;Arduino_Temperature&#39;&#93;</span>/current_value</p>

<p>And the data response is below.  </p>

<p>Does anything jump out as being out of sorts?  I've been looking at this too long to see any error myself.</p>

<p>thanks!</p>


<p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>
&lt;eeml xmlns="http://www.eeml.org/xsd/0.5.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="0.5.1" xsi:schemaLocation="http://www.eeml.org/xsd/0.5.1 <a href="http://www.eeml.org/xsd/0.5.1/0.5.1.xsd">http://www.eeml.org/xsd/0.5.1/0.5.1.xsd</a>"&gt;<br/>
  &lt;environment updated="2012-06-30T13:40:07.325773Z" created="2012-06-29T20:49:27.296784Z" id="65354" creator="https://cosm.com/users/pcannell"&gt;<br/>
    &lt;title&gt;Sam Snead&lt;/title&gt;<br/>
    &lt;feed&gt;<a href="https://api.cosm.com/v2/feeds/65354.xml">https://api.cosm.com/v2/feeds/65354.xml</a>&lt;/feed&gt;<br/>
    &lt;status&gt;live&lt;/status&gt;<br/>
    &lt;private&gt;false&lt;/private&gt;<br/>
    &lt;tag&gt;arduino&lt;/tag&gt;<br/>
    &lt;location domain="physical" exposure="" disposition=""/&gt;<br/>
    &lt;data id="Arduino_Temperature"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:06.955395Z"&gt;111.87&lt;/current_value&gt;<br/>
      &lt;max_value&gt;118.17&lt;/max_value&gt;<br/>
      &lt;min_value&gt;105.01&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Attic_Humidity"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:07.231170Z"&gt;43.30&lt;/current_value&gt;<br/>
      &lt;max_value&gt;50.0&lt;/max_value&gt;<br/>
      &lt;min_value&gt;0.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Attic_Humidity_2nd_Floor"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:07.231170Z"&gt;39.60&lt;/current_value&gt;<br/>
      &lt;max_value&gt;39.9&lt;/max_value&gt;<br/>
      &lt;min_value&gt;0.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Attic_Temp_1-wire"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:06.955395Z"&gt;96.80&lt;/current_value&gt;<br/>
      &lt;max_value&gt;134.04&lt;/max_value&gt;<br/>
      &lt;min_value&gt;73.06&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Attic_Temp_2nd_Floor"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:07.231170Z"&gt;87.98&lt;/current_value&gt;<br/>
      &lt;max_value&gt;122.18&lt;/max_value&gt;<br/>
      &lt;min_value&gt;32.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Attic_Temp_by_DHT"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:07.231170Z"&gt;89.06&lt;/current_value&gt;<br/>
      &lt;max_value&gt;131.54&lt;/max_value&gt;<br/>
      &lt;min_value&gt;32.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Crawlspace_Humidity"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:07.231170Z"&gt;49.00&lt;/current_value&gt;<br/>
      &lt;max_value&gt;50.2&lt;/max_value&gt;<br/>
      &lt;min_value&gt;0.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Crawlspace_Temperature"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:07.231170Z"&gt;78.62&lt;/current_value&gt;<br/>
      &lt;max_value&gt;78.8&lt;/max_value&gt;<br/>
      &lt;min_value&gt;0.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Garage_Humidity"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:07.231170Z"&gt;47.60&lt;/current_value&gt;<br/>
      &lt;max_value&gt;52.7&lt;/max_value&gt;<br/>
      &lt;min_value&gt;0.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Garage_Temperature"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:07.231170Z"&gt;83.30&lt;/current_value&gt;<br/>
      &lt;max_value&gt;95.0&lt;/max_value&gt;<br/>
      &lt;min_value&gt;32.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="HVAC_Exhaust_humidity_1st"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:06.955395Z"&gt;75.20&lt;/current_value&gt;<br/>
      &lt;max_value&gt;75.74&lt;/max_value&gt;<br/>
      &lt;min_value&gt;32.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="HVAC_Exhaust_Second_Floor_1-wire"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:06.955395Z"&gt;84.99&lt;/current_value&gt;<br/>
      &lt;max_value&gt;112.66&lt;/max_value&gt;<br/>
      &lt;min_value&gt;59.34&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="HVAC_Exhaust_Temperature_1st"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:06.955395Z"&gt;59.80&lt;/current_value&gt;<br/>
      &lt;max_value&gt;75.2&lt;/max_value&gt;<br/>
      &lt;min_value&gt;0.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="HVAC_Intake_Humidity_1st"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:06.955395Z"&gt;70.16&lt;/current_value&gt;<br/>
      &lt;max_value&gt;72.32&lt;/max_value&gt;<br/>
      &lt;min_value&gt;32.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="HVAC_Intake_Temperature_1st"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:06.955395Z"&gt;76.50&lt;/current_value&gt;<br/>
      &lt;max_value&gt;99.9&lt;/max_value&gt;<br/>
      &lt;min_value&gt;0.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Livingroom_Humidity"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:07.231170Z"&gt;52.50&lt;/current_value&gt;<br/>
      &lt;max_value&gt;53.8&lt;/max_value&gt;<br/>
      &lt;min_value&gt;0.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Livingroom_Temperature"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:07.231170Z"&gt;72.14&lt;/current_value&gt;<br/>
      &lt;max_value&gt;73.76&lt;/max_value&gt;<br/>
      &lt;min_value&gt;0.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Outside_Humidity"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:07.231170Z"&gt;37.50&lt;/current_value&gt;<br/>
      &lt;max_value&gt;81.2&lt;/max_value&gt;<br/>
      &lt;min_value&gt;0.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Outside_Temperature"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:07.231170Z"&gt;97.34&lt;/current_value&gt;<br/>
      &lt;max_value&gt;102.02&lt;/max_value&gt;<br/>
      &lt;min_value&gt;32.0&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
    &lt;data id="Router_Temperature"&gt;<br/>
      &lt;current_value at="2012-06-30T13:40:06.955395Z"&gt;109.62&lt;/current_value&gt;<br/>
      &lt;max_value&gt;122.56&lt;/max_value&gt;<br/>
      &lt;min_value&gt;98.04&lt;/min_value&gt;<br/>
    &lt;/data&gt;<br/>
  &lt;/environment&gt;<br/>
&lt;/eeml&gt;</p>

				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-20447293"></a>
                                    <font class="smallfont"><p>It looked like the HTTPGetCommand had a bug.<br/>
The DocumentBuilderFactory was set to use namespaces but later the namespace for the XPath evaluation was not defined.<br/>
I created a version where the DocumentBuilderFactory should not use namespaces and it seems to work.<br/>
You can try my controller from here: <a href="http://www.redeker-consulting.de/openremote/OpenRemote-Controller-2.0.0.zip">http://www.redeker-consulting.de/openremote/OpenRemote-Controller-2.0.0.zip</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jul 01, 2012 20:41
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-20447312"></a>
                                    <font class="smallfont"><p>Thanks - I will give this a try ASAP.  </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by salesguy at Jul 01, 2012 23:01
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-20448068"></a>
                                    <font class="smallfont"><p>Sorry for the delay.</p>

<p>I used your controller files, and I now get this error when trying to log into my controller:</p>

<p>Downloading account configuration failed : sisko</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by salesguy at Jul 05, 2012 13:46
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-20449061"></a>
                                    <font class="smallfont"><p>Sorry, about my late answer. Vacation time in Europe <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/><br/>
I forgot a local configuration in a property file and that's why you have that error.<br/>
I uploaded a new version which should not have the "sisko" problem anymore when syncing.</p>

<p>You could also just edit the file controller-2.0.0/webapps/controller/WEB-INF/classes/config.properties.<br/>
All the way to the end is the line with "sisko" and a commented out line with the real version. Just switch the comments.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jul 20, 2012 22:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-20451409"></a>
                                    <font class="smallfont"><p>Salesguy? is this working for you now? I am trying to get some information from cosm XML/JSON but my log's give me this error</p>

<p>2012-10-05 12:53:39,653 TRACE <span class="error">&#91;Polling thread for sensor: verbruik&#93;</span>: Processed , received <br/>
2012-10-05 12:53:50,222 ERROR <span class="error">&#91;Polling thread for sensor: verbruik&#93;</span>: HttpGetCommand could not execute<br/>
org.apache.http.client.HttpResponseException: Unauthorized<br/>
at org.apache.http.impl.client.BasicResponseHandler.handleResponse(BasicResponseHandler.java:67)<br/>
at org.apache.http.impl.client.BasicResponseHandler.handleResponse(BasicResponseHandler.java:54)<br/>
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:735)<br/>
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:709)<br/>
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:700)<br/>
at org.openremote.controller.protocol.http.HttpGetCommand.requestURL(HttpGetCommand.java:176)<br/>
at org.openremote.controller.protocol.http.HttpGetCommand.run(HttpGetCommand.java:190)<br/>
at java.lang.Thread.run(Thread.java:662)</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by daferra at Oct 06, 2012 08:17
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:31</font></td>
		    </tr>
	    </table>
    </body>
</html>