<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Modbus TCP</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Modbus TCP
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jan 02, 2013 by <font color="#0050B2">domog</font>.
				    </div>

				    <p>I try connect with modbus plc with tcp\ip command:<br/>
i send this command: 0x000000000006010600100001 but don't work.<br/>
I try this command ( 000000000006010600100001 ) with modbus master tester and it work.<br/>
Can sameone help me?</p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21039276/23789884.png">Screenshot from 2015-06-21 18:58:57.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21039276/23789885.png">Screenshot from 2015-06-21 19:43:50.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21039276/23789886.png">DI_Screen_shot.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21039276/23789887.png">DO_Scree_shot.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21039276/23789889.png">Screenshot from 2015-06-27 18:53:37.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21039276/23789890.png">Screenshot from 2015-06-27 18:54:04.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21039276/23789891.png">Screenshot_DO_2015-06-27_18:53:37.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21039276/23789892.png">Screenshot_DI_2015-06-27 18:54:04.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21039276/23789893.png">Screenshot_DI.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21039276/23789894.png">Screenshot_DO.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21039276/23789961.png">Screenshot from 2015-09-02 19:58:19.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21039276/23789962.jpg">Screenshot from 2015-09-02 19:58:19.jpg</a> (image/jpeg)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21039276/23789963.jpg">shell_command_modbus.jpg</a> (image/jpeg)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-21856334"></a>
                                    <font class="smallfont"><p>Hi, </p>

<p>I did not try it before but I am interest in this topic too.</p>

<p>Can you give me more information ?</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by miumiu2013 at Jan 23, 2013 15:12
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21856349"></a>
                                    <font class="smallfont"><p>Which version of the controller did you use?<br/>
I think the hex support is only in the 2.1-DeveloperSnpashot: <a href="http://sourceforge.net/projects/openremote/files/For%20Developers/OpenRemote%202.0%20%28Developer%20Releases%29/OpenRemote-Controller-2.1.0_Developer-Snapshot-20120920.zip/download">http://sourceforge.net/projects/openremote/files/For%20Developers/OpenRemote%202.0%20%28Developer%20Releases%29/OpenRemote-Controller-2.1.0_Developer-Snapshot-20120920.zip/download</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jan 24, 2013 08:03
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22872233"></a>
                                    <font class="smallfont"><p>Can I understand that the 2.0.2 version currently under Controller download does not support Hex HTTP commands?<br/>
If so what is the difference between the two versions?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Jun 03, 2013 05:42
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22872239"></a>
                                    <font class="smallfont"><p>You can download the latest development snapshot here: <a href="http://download.openremote.org/2.1-DeveloperRelease">http://download.openremote.org/2.1-DeveloperRelease</a></p>

<p>The change notes are here: <a href="http://svn.code.sf.net/p/openremote/code/tags/snapshot/Controller_2_1_0_FM_SNAPSHOT-20130511/CHANGES.txt">CHANGES.txt</a></p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>Controller 2.1.0 (2013-XX-XX Twin Galaxies)
===========================================

New Features:

  - WebConsole upgraded to version 2.1.1, fixes issues with stuck
    loading screen (Richard Turner, ORCJAVA-345)
  - Added DSC-IT 100 Security System integration - IP to serial (Greg Rapp)
  - Lagarto server (panStamps) integration (Daniel Berenguer)
  - Support 'custom' sensor types with virtual commands (ORCJAVA-217)
  - KNX: added distinct levels for 'DIM' and 'SCALE' commands that allow
    set values to be configured for buttons, e.g. 'DIM 50' to dim directly
    to 50% (Eric Bariaux, ORCJAVA-71).
  - HTTP protocol: methods GET, POST, PUT and DELETE are now supported.
    For HTTP/JSON return documents, a JSON Path expression is supported.
    For outgoing HTTP request, a user agent header is included which
    contains 'OpenRemoteController' as agent value which HTTP applications
    can use to identify requests originating from the controller.
    Internally, the implementation has been converted to use URIs instead 
    of URLs which resolves an issue with lack of encoding of HTTP parameters 
    which contain which contain white spaces or other special characters 
    (Marcus Redeker)
  - One Wire: Added possibility to specify temperature values in
    either Celsius (default), Kelvin, Fahrenheit or Rankine scales, data
    property added for sending values to switches (Marcus Redeker)
  - Shell Command Execution: polling interval and regular expression
    filtering on return values supported, including regexp groups to 
    read in multiple sensor values at once. Support for using shell
    commands with sliders added (Marcus Redeker, Ivan Martinez)
  - Telnet: polling interval property added (Marcus Redeker), dedicated
    telnet log directory and telnet debug logs added (Juha Lindfors, ORCJAVA-328)
  - Date/Time : values updated once per minute instead of once per second
    (Marcus Redeker)
  - UDP : send hex values by prefixing command data with '0x' string.
    Receiving of UDP packets added (Marcus Redeker)
  - TCP : send hex values by prefixing command data with '0x' string
    (Marcus Redeker)
  - Samsung SmartTV : support control of multiple Samsung devices in single
    installation (Ivan Martinez)
  - Touch panel gestures can now be bound to macros in addition to individual
    commands (Eric Bariaux, ORCJAVA-231)
  - Color selection widget is now supported by the controller (Eric Bariaux,
    ORCJAVA-235)
  - Direct Tomcat container logging to /logs/container/tomcat-server.log 
    (Tomcat server logging) and /logs/container/appcontext.log (Controller
    web application logging) files, and output directed to standard output
    and error streams to /logs/container/stderrout.log -- catalina.out is
    no longer created (Juha Lindfors, ORCJAVA-273)
  - Adjusted 'start' and 'run' targets of openremote.sh to configure default
    standard output console logging differently -- 'run' target will still
    output logs to console where as 'start' target will redirect all logging
    to files (Juha Lindfors, ORCJAVA-273)


Bug Fixes:

  - Performance fix to sensor state cache queries (Marcus Redeker)
  - Runtime performance optimization to avoid unnecessary XML 
    parsing/XPath use (ORCJAVA-190)
  - Fix for JSON REST request return values (Richard Turner, ORCJAVA-254)
  - Rework logout requests and added CORS headers (Richard Turner, ORCJAVA-255)
  - Internal API : concurrency and call control on Deployer start 
    controller calls (Juha Lindfors, ORCJAVA-179)  
  - Range and Level sensors trim the incoming values from protocol implementation
    before attempting to convert values to numbers (Eric Bariaux, ORCJAVA-261)  
  - Fix issues with installing Controller to a file system location that contained
    white spaces in path names - commonly 'Program Files' on Windows environments
    (Juha Lindfors ORCJAVA-280, ORCJAVA-263, ORCJAVA-286, Eric Bariaux ORCJAVA-311)
  - Fix a false warning in ISY-99 protocol implementation 
    (Juha Lindfors, ORCJAVA-308)
  - State sensor is more tolerant to device input trimming non-printable 
    characters -- CF, RF, zero bytes, etc.  (Juha Lindfors, ORCJAVA-324) 
  - Use locale independent string case conversions in the controller, KNX and telnet
    protocols (Juha Lindfors, ORCJAVA-332, ORCJAVA-334, ORCJAVA-335)
  - Fix a bug in telnet switch sensor handling where untrimmed return value was
    never correctly parsed to 'on' state (Juha Lindfors, ORCJAVA-326)


Internal:

  - Enforce UTF-8 encoding on Java source files with javac to prevent build issues
    on systems with differing default character encoding configurations
    (Juha Lindfors, ORCJAVA-329)

</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Jun 03, 2013 11:58
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22872242"></a>
                                    <font class="smallfont"><p>I think HEX is not supported with HTTP only TCP.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jun 03, 2013 13:04
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22872259"></a>
                                    <font class="smallfont"><p>What about documentaion of some sort?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Jun 03, 2013 20:29
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22873324"></a>
                                    <font class="smallfont"><p>Hi again.</p>

<p>I have been investigating the ModBus issue. I have used the Advantech tools for the ADAM-6050 along with Wireshark to understand the actual TCP activity. The results under OR are (to my opinion):<br/>
1. The HTTP is useless since:</p>
<ul class="alternate" type="square">
	<li>One needs to send the ModBus Head which is non ASCII and have a running transaction number (new binding number each new command for TX and RX)</li>
	<li>At least currently with Advantech, the HTTP is stated as supported but there is no documentation of the way to perform HTTP get.</li>
	<li>It is not clear wether the HTTP is an internal support or using a translating library.<br/>
2. The TCP is useless since you can only send hex data but the ModBus needs handshake.</li>
</ul>


<p>I guess a Java ModBus is the only solution and since my Java skills are low I will have to wait or dig deeper.<br/>
If someone has a different idea / opinion I would like get it.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Jun 24, 2013 16:09
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22882113"></a>
                                    <font class="smallfont"><p>Nir Aviry</p>

<p>Were you ever able to get your Advantech working with Openremote? I just picked up an Adam-6052 and am trying to experiment with it. </p>

<p>If you have any more findings can you pass them on</p>

<p>Thanks<br/>
Scott</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by drewscm at Jan 04, 2014 04:51
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23597513"></a>
                                    <font class="smallfont"><p>Back to Modbus after a long time.<br/>
I am no expert in HTTP but I am on the way to understand the method after running some activity with Wireshark.<br/>
The new ADAM devices can be loaded with HTTP version instead of JAVA. That means available protocol for OR.<br/>
I got the structure of the POST and GET which implemet plain text method in commands:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
http:<span class="code-comment">//10.0.0.41/digitaloutput/all/value
</span>http:<span class="code-comment">//10.0.0.41/digitalinput/all/value</span>
</pre>
</div></div>
<p>The GET is for both while the POST is for the Digitaloutput.</p>

<p>Along with that is a plain text workload:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
DO0=0&amp;DO1=0&amp;DO2=0&amp;DO3=0&amp;DO4=0&amp;DO5=0
</pre>
</div></div>
<p>The ADAM-6050 is an Ethernet ModBus/TCP based device with 6 Relay and 12 Digital inputs.<br/>
The ACK seems to be a XML structure which is constant if all is OK:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
&lt;?xml version=\<span class="code-quote">"1.0\"</span> ?&gt;
&lt;ADAM-6050 status=<span class="code-quote">"OK"</span>&gt;
&lt;/ADAM-6050&gt;
</pre>
</div></div>
<p>This is a fairly good starting point.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Apr 10, 2015 17:57
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23597618"></a>
                                    <font class="smallfont"><p>Thats great....I am in the middle of programming my system, I will have to pull my ADAM I/O out and do some testing </p>

<p>Keep posting any results you get</p>

<p>Thanks</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by drewscm at Apr 14, 2015 17:18
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23597619"></a>
                                    <font class="smallfont"><p>I did some XPath using a web tester. The responce is XML but from some reason the query of the XPath tester does not function as I have expected. I will use it after the XP shell be understood.<br/>
In general  the HTTP has two type of GET fron DI and DO and one POST for DO setting.<br/>
The responce XML starts with &lt;ADAM-6050 status="OK"&gt; and ends with &lt;/ADAM-6050&gt; which XPathtester does not cope with that.<br/>
Even if I remove the status stuff still I have not managed to set a working query. Once it will work it can be used in the HTTP command and sensors.<br/>
As you may know if the device implements Modbus using hTTP server it will work about the same way for othe manufacturers devices.<br/>
Please update me with your findings.<br/>
fYI, ADAM devices with version CE has the option for HTTP server application. The older ones (BE) can not be used for that.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Apr 14, 2015 20:13
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23599710"></a>
                                    <font class="smallfont"><p>Good news (Update - not there yet but close).</p>

<p>As I have posted, when loading the ADAM CE series units with HTTP firmware the ADAM units responce to XML through HTTP POST and GET.</p>

<p>The GET functionality using XPATH should look like this (Read status request and responce):</p>

<p><img src="attachments/21039276/23789893.png" align="absmiddle" border="0"/></p>

<p>The corresponding Controller.XML code looks like this:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
&lt;command id=<span class="code-quote">"3122"</span> protocol=<span class="code-quote">"http"</span>&gt;
      &lt;property name=<span class="code-quote">"username"</span> value=<span class="code-quote">"root"</span> /&gt;
      &lt;property name=<span class="code-quote">"pollingInterval"</span> value=<span class="code-quote">"500m"</span> /&gt;
      &lt;property name=<span class="code-quote">"method"</span> value=<span class="code-quote">"GET"</span> /&gt;
      &lt;property name=<span class="code-quote">"contentType"</span> value=<span class="code-quote">"text/xml"</span> /&gt;
      &lt;property name=<span class="code-quote">"password"</span> value=<span class="code-quote">"00000000"</span> /&gt;
      &lt;property name=<span class="code-quote">"url"</span> value=<span class="code-quote">"http:<span class="code-comment">//10.0.0.41/digitaloutput/all/value"</span> /&gt;
</span>      &lt;property name=<span class="code-quote">"xpath"</span> value=<span class="code-quote">"<span class="code-comment">//DO[1]/VALUE[1]='1'"</span> /&gt;
</span>      &lt;property name=<span class="code-quote">"name"</span> value=<span class="code-quote">"ADAM 1 DO0 STATUS REQ"</span> /&gt;
    &lt;/command&gt;
</pre>
</div></div>

<p>The result is binary (true / false) as tested using a web tester called XPATH Tester.</p>

<p>The Relay Control contains 7 commands: 6 for setting each of the 6 Relays and one for Ressting them all. The reason is that my control<br/>
is a pulse so I can use a Macro to set and reset each relay which is connectoed to my aircondition units accross my house.</p>

<p>The Designer (July 2013 snapshot) looksline this:</p>

<p><img src="attachments/21039276/23789894.png" align="absmiddle" border="0"/></p>

<p>But the corresponding XML code looks like this:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
&lt;command id=<span class="code-quote">"3124"</span> protocol=<span class="code-quote">"http"</span>&gt;
      &lt;property name=<span class="code-quote">"workload"</span> value=<span class="code-quote">"DO0=0&amp;amp;DO1=1&amp;amp;DO2=0&amp;amp;DO3=0&amp;amp;DO4=0&amp;amp;DO5=0"</span> /&gt;
      &lt;property name=<span class="code-quote">"username"</span> value=<span class="code-quote">"root"</span> /&gt;
      &lt;property name=<span class="code-quote">"pollingInterval"</span> value=<span class="code-quote">"500m"</span> /&gt;
      &lt;property name=<span class="code-quote">"method"</span> value=<span class="code-quote">"POST"</span> /&gt;
      &lt;property name=<span class="code-quote">"contentType"</span> value=<span class="code-quote">"text/plain;charset=UTF-8"</span> /&gt;
      &lt;property name=<span class="code-quote">"password"</span> value=<span class="code-quote">"00000000"</span> /&gt;
      &lt;property name=<span class="code-quote">"url"</span> value=<span class="code-quote">"http:<span class="code-comment">//10.0.0.41/digitaloutput/all/value"</span> /&gt;
</span>      &lt;property name=<span class="code-quote">"xpath"</span> value=<span class="code-quote">"/ADAM-6050"</span> /&gt;
      &lt;property name=<span class="code-quote">"name"</span> value=<span class="code-quote">"ADAM_Living_Aircon_set"</span> /&gt;
    &lt;/command&gt;
</pre>
</div></div>

<p>As you can see &amp;amp instead of &amp; (the workload string is: DO0=0&amp;DO1=0&amp;DO2=0&amp;DO3=0&amp;DO4=0&amp;DO5=0). I am not shure it is correct as this is a plain text.</p>


<p>I used only one sensor to test the setup which checks the Relay status. WhatI get is the following error:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">

ERROR [Polling thread <span class="code-keyword">for</span> sensor: Test]: ClientProtocolException when executing HTTP method
org.apache.http.client.HttpResponseException: Forbidden
	at org.apache.http.impl.client.BasicResponseHandler.handleResponse(BasicResponseHandler.java:67)
	at org.apache.http.impl.client.BasicResponseHandler.handleResponse(BasicResponseHandler.java:54)
	at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:735)
	at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:709)
	at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:700)
	at org.openremote.controller.protocol.http.HttpGetCommand.requestURL(HttpGetCommand.java:231)
	at org.openremote.controller.protocol.http.HttpGetCommand.run(HttpGetCommand.java:245)
	at java.lang.<span class="code-object">Thread</span>.run(<span class="code-object">Thread</span>.java:662)
INFO 2015-06-27 18:29:40,991 : Registered sensor : Switch Sensor (Name = 'Study Desk Light Panel Status', ID = '100057353')
[Fatal Error] :1:1: Premature end of file.
ERROR [Polling thread <span class="code-keyword">for</span> sensor: Test]: Could not perform xpath evaluation
org.xml.sax.SAXParseException: Premature end of file.
	at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:246)
	at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:284)
	at javax.xml.parsers.DocumentBuilder.parse(DocumentBuilder.java:124)
	at org.openremote.controller.protocol.http.HttpGetCommand.run(HttpGetCommand.java:267)
	at java.lang.<span class="code-object">Thread</span>.run(<span class="code-object">Thread</span>.java:662)
</pre>
</div></div>

<p>This error appears both in HTTP GET for DI which seems to be OK from the Controller.XML code and the GET DO which looks suspicious.</p>

<p>I have also noticed that the Wireshark URI appears like this:</p>

<p>"10.0.0.41/digitaloutput/all/value HTTP/1.1" (" are not part of the URI). The request version does not appear in any place in the HTTP command.</p>

<p>Also the referer looks like this:</p>

<p>"http://10.0.0.41/login.cgi\r\n"</p>

<p>The \r\n - (CR) (LF) appears in many of the fields in the messages I see in the Wireshark and I am also not sure I need to add them in the Designer or not.</p>

<p>There are posts about (CR) &amp; (LF) regarding the TCP and UDP but not HTTP.</p>

<p>BTW, removing the user and password does not change any of the above.</p>

<p>This is why I am not sure the URL in the designer is OK.</p>


<p>Can anyone help.</p>

<p>Thanks</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Jun 21, 2015 17:40
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23600860"></a>
                                    <font class="smallfont"><p>As I had no time to try and investigate why the HTTP version does not work, I left it aside till few days back. I found a command line application running on most platforms -modpoll. Using this utility I was able to sense and control my Modbus devices.<br/>
So I have created bash (linux) sh files to do all tasks I need. The result is equal, not equal my value and communication error.<br/>
It works great.<br/>
Now I am in the middle of putting it all in the Designer. I expect no problem.<br/>
Will update once I will have time to do that.<br/>
Using Modbus one can use very chip voltage and power meters and many inexpensive devices as the modpoll is very generic.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Aug 29, 2015 07:32
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23600913"></a>
                                    <font class="smallfont"><p>After integrating most of my devices it looks like it is working great.<br/>
The modpoll is working smoothly.<br/>
End of my air condition project. <br/>
Now I am heading towards Modbus power meters. These are about 50 to $90 in Aliexpress.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Sep 01, 2015 20:14
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23600923"></a>
                                    <font class="smallfont"><p>Hi Nir, did you indeed get modbus to work? It would be great if we can create some documentation on that...</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pierre kil at Sep 02, 2015 08:43
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23600974"></a>
                                    <font class="smallfont"><p>Well i need to do some more tweaking since the sensors return values do not function properly under OR but I am optimistic.<br/>
The idea is to use the free modpoll for whatever OS you need. Mine is Ubuntu.<br/>
Play with a terminal to get the proper command syntax you need.<br/>
Then, generate a script to be used as shell command protocol on the OR.<br/>
Keep in mind that if you add a vlue at the end, it is a write coil if relevant and if not it is a read status of a coil or discrete.<br/>
The coil commands are working well. I have created 3: On, Off and Toggle.<br/>
I pass IP and coil number to the script and exit the shell with or without an error.<br/>
As for sensors, i do the same but on status registers. I send an IP, discrete number and expected result.<br/>
If the result fails, it is the oposite value.<br/>
I will send out the bash files (scripts). The rest is trivial as it is exactly as in the tutorial.<br/>
I use 500mSec for Sensors polling.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Sep 02, 2015 15:29
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23600976"></a>
                                    <font class="smallfont"><p>Sounds like a plan <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> Keep us posted. I'll happily create some basic doc.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pierre kil at Sep 02, 2015 15:51
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23600979"></a>
                                    <font class="smallfont"><p>I might be needing some help to resolve to sensor issue.<br/>
The control is working perfectly.<br/>
Here is my bash file which returns 0 if the sense request is equal to the value I expecting and 1 if not. It also retuns 2 if there is a communication issue but I did not set this one out yet. I need to add some rules.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
#!/bin/sh

# $1 is ADAM IP, $2 is Channel number 1-12 are input, 17 to 22 are Relay output.
# $3 is expected vlaue 0 or 1
# Respnce will <span class="code-keyword">return</span> 1 <span class="code-keyword">if</span> discrete matches $3, 0 <span class="code-keyword">if</span> not matches $3 and 2 <span class="code-keyword">if</span> communication error  occured.

modbus_io=<span class="code-quote">"$(modpoll -m tcp $1 -r $2 -c 1 -t 0 -1 | tail -1)"</span>
modbus=<span class="code-quote">"$(echo $modbus_io | cut -c $((${#modbus_io})))"</span>

<span class="code-keyword">if</span> [ $modbus -gt 1 ]
then
	echo communication error
	exit 2
fi

<span class="code-keyword">if</span> [ $modbus -eq $3 ]
then
	echo responce match
	exit 1
<span class="code-keyword">else</span>
	echo responce missmatch
	exit 0 
fi
</pre>
</div></div>

<p>The sensor looks like this:</p>




<p><img src="attachments/21039276/23789963.jpg" align="absmiddle" border="0"/></p>











<p>I also enabled the shell command logging as instructed in the forum but it is not in the log directory so I can't debug.</p>

<p>I assume ) and 1 are translated in to on and off of a switch which I have used.</p>

<p>At this point I get no responce from the sensor on the screen. The bash file works OK.</p>

<p>I am not sure if I should move to custom sensor instead of a switch to solve the problem.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Sep 02, 2015 18:02
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23601268"></a>
                                    <font class="smallfont"><p>Finally I got the Modbus and for a matter of fact any other command line based protocol or utility working perfectly.<br/>
The thing is that the OR How to page of Shell Execution protocol is missing some basic info which one must figure out by trail and error.<br/>
I will try and put it all in one post which will enable everyone to add any command line utility as shell execution protocol to OR. I am using Linux so I use Bash files to filter out response and get what is needed by OR.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Sep 14, 2015 20:22
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23601278"></a>
                                    <font class="smallfont"><p>This is an add on information to ModBus and Shell execution Protocol.</p>

<p>This post extends the information about the implementation of the two subjects.</p>

<p>There are few rules to follow to make things running:<br/>
1. Shell commands return values to OR using echo command which is part of Linux shall commands like bash and part of Windows Batch files. These will be refereed to as script files.<br/>
To use a Switch one must use both"echo on" and "echo off" commands within the script files.<br/>
Exit 0 or Exit 1 will not do the job.<br/>
2. If some other form of entity is to be used, a custom sensor may be used to convert the response (something like 1 is on, 0 is off etc.).<br/>
3. The Regex in a switch case shall be (on|off). Keep in mind that the order in this field is insignificant. The logic behind (of the shell command file is what's important).<br/>
4. Verify the the integrated interval of  commands/program (like modpoll in the case of a ModBus) within the script file shall be short enough no to cause overlapping commands.<br/>
That means the OR polling interval shall be longer than the command cycle, which in many cases can be altered (see -l time in modpoll).<br/>
5. I am not sure about the sensor name field as my final stage from which all was working, had to changes at one time and one of them was the sensor name.<br/>
6. Changing the code of the script file shall require a PC re-boot or at least program re-run. Otherwise changes will not take effect.<br/>
7. The script files can be anywhere in the file system as long as:</p>
<ul class="alternate" type="square">
	<li>They are executable</li>
	<li>Permission is at least as the one of the OR folder.</li>
	<li>All files are fully defined in the path in each OR command.<br/>
8. Some devices like Air condition units needs pulse as a trigger and its state (like off/on or error) are defined using dry contact or so, there should be a script that run coil enable and then disable (off to on, delay and on to off) to toggle the function.<br/>
9. Th outcome is that one needs a different sensor to get the state of the unit. The script is to read the proper bit in the Modbus (or any other protocol), and within the script may set to output result to be directly used by OR. That means on q off etc.<br/>
10. I attach the script files. The OR commands and sensors are about the same as in my previous post in this subject.</li>
</ul>


<p>Note: I managed to enable the shall logging only under the last version of the Linux OR (2.1.1 from Feb 2015).</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
#!/bin/sh

# The is Relay_On.sh script file
# Set Relay 0 to 5 to On (<span class="code-object">short</span> state).
# $1 is ADAM IP address, $2 is Channel number 1-12 are input so <span class="code-keyword">do</span> not use, 17 to 22 are Relay output.

modpoll -m tcp $1 -r $2 -c 1 -t 0 -1 1 &gt; /dev/<span class="code-keyword">null</span>

# echo <span class="code-quote">"Relay"</span> $2 <span class="code-quote">"On"</span> $1 <span class="code-quote">"was set to On"</span>
</pre>
</div></div>

<p>See the &gt;  /dev/null. It is designed to prevent the OR sensor from seeing undesiered text that shall be interpreted wrongly.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
#!/bin/sh

# The is Relay_Off.sh script file
# Set Relay 0 to 5 to On (<span class="code-object">short</span> state).
# $1 is ADAM IP address, $2 is Channel number 1-12 are input so <span class="code-keyword">do</span> not use, 17 to 22 are Relay output.

modpoll -m tcp $1 -r $2 -c 1 -t 0 -1 0 &gt; /dev/<span class="code-keyword">null</span>

# echo <span class="code-quote">"Relay"</span> $2 <span class="code-quote">"On"</span> $1 <span class="code-quote">"was set to Off"</span>
</pre>
</div></div>

<p>Ofcoarse one can combine two or more commands to do the correct task.</p>

<p>The sensor script looks like this:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
#! /bin/sh

# This is Relay_On_Off_Status.sh file
# $1 is ADAM IP, $2 is Channel number 1-12 are input, 17 to 22 are Relay output.
# $3 is expected vlaue 0 or 1
# Respnce will <span class="code-keyword">return</span> 1 <span class="code-keyword">if</span> discrete matches $3, 0 <span class="code-keyword">if</span> not matches $3 and 2 <span class="code-keyword">if</span> communication error  occured.
# ech off
modbus_io=<span class="code-quote">"$(modpoll -l 250 -m tcp $1 -r $2 -c 1 -t 0 -1 | tail -1)"</span>
modbus=<span class="code-quote">"$(echo $modbus_io | cut -c $((${#modbus_io})))"</span>

# <span class="code-keyword">if</span> [ $modbus -gt 1 ]
# then
#	echo communication error
#	exit 2
# fi

<span class="code-keyword">if</span> [ $modbus -eq $3 ]
then
	echo on
	exit
<span class="code-keyword">else</span>
	echo off
	exit 
fi

# echo <span class="code-quote">"Status bit"</span> $2 <span class="code-quote">"on"</span> $1 <span class="code-quote">"was tested!"</span>
</pre>
</div></div>

<p>Regex above is to use different values per each sensor to lower the load over the net. I have set it to about 1.1 seconds with 20mSec difference between the set of sensors.<br/>
The regex actually is (on|off).</p>

<p>ADAM devices have 12 bit of Digital Input (1 to 12) and 6 Digital Outputs (17 to 22). This will help you understand the commands for the TCP ModBus device.</p>

<p>Last thing, as you can see, one can arrange the proper parameters according to the device / protocol being used.</p>

<p>I hope I did not miss anything.</p>

<p>My next project is implementing a Modbus Energy meter including events logging (out of range voltage etc.).<br/>
RS-485 based Modbus devices are low price (look at Aliexpress).</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Sep 15, 2015 12:17
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23601430"></a>
                                    <font class="smallfont"><p>Hi,<br/>
does the de-tour using the shell command work well?<br/>
Do you think we can come up with a more sophisticated solution, maybe speaking HTTP or TCP?<br/>
The HTTP "Forbidden" issue came up just the other day talking to another device.<br/>
There might be an issue with our HTTP protocol not sending the authentication information correctly which I want to investigate when I find some time <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/><br/>
-Marcus</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Sep 24, 2015 21:07
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23601437"></a>
                                    <font class="smallfont"><p>Interesting to see that Nir had the same problem with http authentication as I encountered. So would be nice if he could give the http thing one more try with Pro version 1.2 (If he has that)</p>

<p>A side remark on Modbus. Industry is still soaked in that protocol. Not rocket science, but very reliable in hersh envrionments. Because of Nir's search I could make someone very happy with a link to modpoll (which is open source and easy to compile on different platforms I understood)</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Sep 24, 2015 22:32
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23601439"></a>
                                    <font class="smallfont"><p>Well I even did not compile it. I have simply downloded the Linux version run file, lookup for some examples and after a hour I had bash files working simply under Linux.<br/>
Then I have packed the bash file to return on or off (I still need to add error condition handling as well as I had not time for that yet).<br/>
Once this was over, I have used shell command protocol under OR.<br/>
Here I came accress the interval time issue and once I have understood it, I have just set a time in mSec (no m next to the number) and it all works well.<br/>
There are so many devices working under Modbus so it is very usefull. For instance KNX input devices are very expensive while Modbus is very cheep.<br/>
I have also mentioned evnergy meters/analyzers which under Modbus RTU have lots of inexpensive products.<br/>
Finally, any protocol the has a command line utility off the shelf (bash or batch) can be implemented very easily in thus way.<br/>
As for the HTTP, I have only the free edition so I got stuck with it. Keep in mind that not all devices support HTTP protocol.<br/>
I do this work on my own house for the fun so I had no season to move to the pro edition.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Sep 25, 2015 00:34
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23601440"></a>
                                    <font class="smallfont"><blockquote><p>Well I even did not compile it.</p></blockquote>
<p>But my friend was happy he could compile for his platform! And it makes your Modbus solution more generic.</p>

<blockquote><p>Keep in mind that not all devices support HTTP protocol</p></blockquote>
<p>I'am well aware of that. I do understand that you choose not to use the pro version. Would have been a nice test opportunity if you had it. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Sep 25, 2015 08:44
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23601442"></a>
                                    <font class="smallfont"><p>Hi, nice progress <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> If you like to try out the suggestion of Pieter, we are happy to give you a free pro license. Just e-mail me at pierre@openremote.org</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pierre kil at Sep 25, 2015 09:44
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23601551"></a>
                                    <font class="smallfont"><p>Regarding HTTP and authentication you can follow the discussion here: www.openremote.org/pages/viewpage.action?pageId=23601288<br/>
Seems that your HTTP device is also directly returning the 403 instead asking for the authentication information with a 401 first.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Oct 05, 2015 11:04
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23601553"></a>
                                    <font class="smallfont"><p>Yes, I continued in that thread</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Oct 05, 2015 11:13
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602043"></a>
                                    <font class="smallfont"><p>Hi.</p>

<p>Sorry for the delay with testing the ModBus with HTTP. I have repeated the ADAM test with HTTP. I t shows about the same results on the Pro 1.3 version.</p>

<p>I have tested my ADAM device in two configuration as was posted in the above in this post (with and without user and password).<br/>
Both do not work.</p>

<p>With no user and password I get the following errors:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
ERROR [Polling Sensor <span class="code-object">Thread</span> ID = 250156, Name ='AirCon Test Sensor']: ClientProtocolException when executing HTTP method
org.apache.http.client.HttpResponseException: <span class="code-object">Object</span> Not Found
    at org.apache.http.impl.client.BasicResponseHandler.handleResponse(BasicResponseHandler.java:67)
    at org.apache.http.impl.client.BasicResponseHandler.handleResponse(BasicResponseHandler.java:54)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:735)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:709)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:700)
    at org.openremote.controller.protocol.http.HttpGetCommand.requestURL(Unknown Source)
    at org.openremote.controller.protocol.http.HttpGetCommand.read(Unknown Source)
    at org.openremote.controller.model.sensor.Sensor$DeviceReader.read(Unknown Source)
    at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Unknown Source)
    at java.lang.<span class="code-object">Thread</span>.run(<span class="code-object">Thread</span>.java:745)
[Fatal Error] :1:1: Premature end of file.
ERROR [Polling Sensor <span class="code-object">Thread</span> ID = 250156, Name ='AirCon Test Sensor']: Could not perform xpath evaluation
org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 1; Premature end of file.
    at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:257)
    at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:338)
    at javax.xml.parsers.DocumentBuilder.parse(DocumentBuilder.java:121)
    at org.openremote.controller.protocol.http.HttpGetCommand.read(Unknown Source)
    at org.openremote.controller.model.sensor.Sensor$DeviceReader.read(Unknown Source)
    at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Unknown Source)
    at java.lang.<span class="code-object">Thread</span>.run(<span class="code-object">Thread</span>.java:745)
</pre>
</div></div>

<p>The project is tiny and the object exists.</p>

<p>If I put the login user and password (which do not appear in the Wireshark recording) I get about the same but one or two times I got an error<br/>
as the first error:<br/>
"login rejected"<br/>
It is very fast so it is hard to catch. I tried to find it in the debug log but it was not there.</p>

<p>As for the errors:</p>

<p>1. It looks to me that the 1st thing that bugs this one is the "//" at the Xpath Expression.<br/>
Using the follwoingXPAth tester, the XPath is OK:</p>

<p><a href="http://www.freeformatter.com/xpath-tester.html">http://www.freeformatter.com/xpath-tester.html</a></p>

<p>I have no idea what is wrong unless OR canot cope with such a condition.</p>

<p>The xml responce looks like this:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
﻿&lt;?xml version=<span class="code-quote">"1.0"</span> encoding=<span class="code-quote">"UTF-8"</span>?&gt;
&lt;ADAM-6050 status=<span class="code-quote">"OK"</span>&gt;
  &lt;DI&gt;
    &lt;ID&gt;0&lt;/ID&gt;
    &lt;VALUE&gt;0&lt;/VALUE&gt;
  &lt;/DI&gt;
  &lt;DI&gt;
    &lt;ID&gt;1&lt;/ID&gt;
    &lt;VALUE&gt;1&lt;/VALUE&gt;
  &lt;/DI&gt;
  &lt;DI&gt;
   &lt;ID&gt;2&lt;/ID&gt;
   &lt;VALUE&gt;1&lt;/VALUE&gt;
  &lt;/DI&gt;
  &lt;DI&gt;
    &lt;ID&gt;3&lt;/ID&gt;
    &lt;VALUE&gt;1&lt;/VALUE&gt;
  &lt;/DI&gt;
  &lt;DI&gt;
    &lt;ID&gt;4&lt;/ID&gt;
    &lt;VALUE&gt;1&lt;/VALUE&gt;
  &lt;/DI&gt;
  &lt;DI&gt;
    &lt;ID&gt;5&lt;/ID&gt;
    &lt;VALUE&gt;1&lt;/VALUE&gt;
  &lt;/DI&gt;
  &lt;DI&gt;
    &lt;ID&gt;6&lt;/ID&gt;
    &lt;VALUE&gt;1&lt;/VALUE&gt;
  &lt;/DI&gt;
  &lt;DI&gt;
    &lt;ID&gt;7&lt;/ID&gt;
    &lt;VALUE&gt;1&lt;/VALUE&gt;
  &lt;/DI&gt;
  &lt;DI&gt;
    &lt;ID&gt;8&lt;/ID&gt;
    &lt;VALUE&gt;1&lt;/VALUE&gt;
  &lt;/DI&gt;
  &lt;DI&gt;
    &lt;ID&gt;9&lt;/ID&gt;
    &lt;VALUE&gt;1&lt;/VALUE&gt;
  &lt;/DI&gt;
  &lt;DI&gt;
    &lt;ID&gt;10&lt;/ID&gt;
    &lt;VALUE&gt;1&lt;/VALUE&gt;
  &lt;/DI&gt;
  &lt;DI&gt;
  &lt;ID&gt;11&lt;/ID&gt;
  &lt;VALUE&gt;1&lt;/VALUE&gt;
  &lt;/DI&gt;
&lt;/ADAM-6050&gt;
</pre>
</div></div>

<p>2 As for the "object not found" error, I have no idea what is the problem.</p>

<p>If someone wants me to send him the Wireshark file I will be happy to do so.</p>

<p>I hope there is a solution.</p>

<p>Thanks,</p>

<p>Nir</p>

</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Nov 06, 2015 16:21
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602045"></a>
                                    <font class="smallfont"><p>I gave up since both Marcus and the ZWay guys say the other side is wrong. I honestly don't know who is right. Marcus has answered all my questions, but the Zway people have choosen not to respond to my <a href="http://forum.z-wave.me/viewtopic.php?f=3422&amp;t=22016&amp;hilit=authenticate&amp;start=20#p58795">final question</a>.....</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Nov 06, 2015 18:14
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602210"></a>
                                    <font class="smallfont"><p>Nir,<br/>
can you verify that the device is handling the basic authentication problem that Pieter had correctly.</p>

<p>1) Our library first needs a 401 Unauthorized response before sending the authentication information.</p>

<p>2) I cannot find the "Object not found" being part of our HTTP library. This sees to be a error from your side.</p>

<p>Can you verify these 2 issues with wireshark?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Nov 17, 2015 22:37
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602226"></a>
                                    <font class="smallfont"><p>I had hoped that the latest ZWay release (<a href="http://forum.z-wave.me/viewtopic.php?f=3422&amp;t=22362">2.1.2-rc17</a>) had changed a bit on their side (release notes say nothing about it). I see no change. Maybe tomorrow I find the time to run the TCPDUMP once more.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Nov 18, 2015 16:58
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602252"></a>
                                    <font class="smallfont"><p><a href="http://forum.z-wave.me/viewtopic.php?f=3422&amp;t=22016&amp;p=59217#p59217">Still problematic in v2.1.2-rc17</a>. </p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">    DS212&gt; tcpdump -A -v -s 10240 'tcp port 8083 and (((ip[2:2] - ((ip[0]&amp;0xf)&lt;&lt;2)) - ((tcp[12]&amp;0xf0)&gt;&gt;2)) != 0)'
    tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 10240 bytes
    15:38:44.400120 IP (tos 0x0, ttl 64, id 53660, offset 0, flags [DF], proto TCP (6), length 217)
        DS212.56798 &gt; raspberry.fritz.box.8083: Flags [P.], cksum 0x8459 (incorrect -&gt; 0x73aa), seq 785799336:785799501, ack 3299199293, win 183, options [nop,nop,TS val 191007037 ecr 51423], length 165
    E.....@.@......!..........X....=.....Y.....
    .b.=....GET /OpenRemote/SwitchBinaryStatus/9/0 HTTP/1.1
    User-Agent: OpenRemoteController
    Content-Type: application/json
    Host: raspberrypi:8083
    Connection: Keep-Alive


    15:38:44.425443 IP (tos 0x0, ttl 64, id 483, offset 0, flags [DF], proto TCP (6), length 269)
        raspberry.fritz.box.8083 &gt; DS212.56798: Flags [P.], cksum 0x75ba (correct), seq 1:218, ack 165, win 470, options [nop,nop,TS val 51425 ecr 191007037], length 217
    ..@.@..z.......!.......=..YM....u......
    .....b.=HTTP/1.1 401 Unauthorized
    Connection: close
    Access-Control-Allow-Origin: *
    Access-Control-Allow-Credentials: <span class="code-keyword">true</span>
    Content-Type: text/plain
    Content-Length: 13
    Transfer-Encoding: chunked

    D
    Not logged in
    0
</pre>
</div></div>

<p>Looks to me like ZWay properly returns 401, but I do not see OR sending the request with usr/pwd then. The pattern above just repeats every 2seconds as defined by me in the http command. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Nov 19, 2015 14:59
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602262"></a>
                                    <font class="smallfont"><p>I will try this weekend.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Nov 19, 2015 17:53
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23602561"></a>
                                    <font class="smallfont"><p>It has become pretty clear to Marcus and me that the problem I reported is on the ZWay side. So as far as I am concerned this issue is closed.<br/>
I no longer this thread</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Dec 08, 2015 09:45
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23605479"></a>
                                    <font class="smallfont"><p>Hi all.<br/>
I am using 7 module from AHATOS. the modules are connected to my COM port on my PC via RS232 to RS485 converter and I am using modpoll.exe to communicate with the module ( under windows OS).<br/>
in openremote I create ON ,OFF commands ( that runs powershell script that invoke modpoll.exe to set value) , STATUS command ( that runs powershell script invokes modpoll.exe to read value),<br/>
Sensor that runs every 500ms the status command and a switch that combines ON,OFF and sensor elements.<br/>
one switch is working fine. I can set and read from AHATOS module. the problem is when I create 56 switches like the above switch.<br/>
commands are dropped and the and the system is busy.<br/>
I noticed that for each switch there is a thread opened that runs powershell.exe. when openremote controller is running and I read from the AHATOS module manualy, I get some times an indication the the port is already open<br/>
so the current command is lost.<br/>
in addition shell debug file indicates also that readings are also lost (I don't get a valid value "on" or "off" ).</p>

<p>my questions :</p>

<p>1. does 56 switches that runs powershell script are too much?<br/>
2. what is the best way to aggregate all the individual reads to a one thread containing 56 serial reading? if there is a thread contention, this can solve it...<br/>
3. I am not using the PRO controller. is it related?</p>

<p>please advise</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by nitzank at Jan 31, 2016 14:50
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23605482"></a>
                                    <font class="smallfont"><p>Hi Nitzan.</p>

<p>I use 2 ADAM devices with 6 DO and 12 DI each. I use some of them. In order to spread the activity I keep a kind of order of polling que by setting differnt polling time. This way I have one at the time polling. The modpoll has timing parameter.<br/>
Keep it low to free the modpoll shortly after each polling.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by niraviry at Jan 31, 2016 19:12
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23605483"></a>
                                    <font class="smallfont"><p>Nir , thanks.<br/>
I will try it.<br/>
Is it possible that there is a conflict between sensor command ( read ) and on/off commands ( write ) on the serial port?<br/>
Can you give me please an example of the modpoll command with the timing parameter?<br/>
Thanks</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by nitzank at Jan 31, 2016 19:29
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 10:44</font></td>
		    </tr>
	    </table>
    </body>
</html>