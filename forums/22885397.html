<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Alarm output & SONOS Control</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Alarm output & SONOS Control
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Mar 21, 2014 by <font color="#0050B2">andyh747</font>.
				    </div>

				    <p>I'm looking at OR as a possible solution for the following and wonder if anyone can advise what would work best. </p>

<p>I have an alarm system which can output a voltage free contact closure on alarm activation. I have this feeding a centralised lighting system (eDIN from Mode Lighting) which switches on all the lights on activation. I also have a whole house SONOS system with ceiling speakers in each room. What I would like to do is signal SONOS to play a particular track at a specified volume to all zones (or specified zones) on alarm activation. I was hoping to run OR on my Synology DS412+ Which also contains all the music tracks. </p>

<p>The lighting system is already signalled by the alarm and has the ability to output a simple Telnet command on activation of a scene. I had thought it might be possible to add a telnet command to the alarm active scene in the lighting system which sends the telnet command to OR to then select and play the specified track. </p>

<p>I know I can control SONOS from OR but its signalling a certain sequence when the alarm is activated is the issue. </p>

<p>Can anyone advise how difficult this would be to program and provide any pointers?</p>

<p>Many thanks. </p>

				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-22885443"></a>
                                    <font class="smallfont"><p>HI Andy this should be feasible using rules - I have a Sonos system which I control through OR.  You would need to set up a real or virtual sensor in OR which monitors the state of your alarm.  I would start with that part and try and get a panel set up that shows the status of the alarm.  Once you have that then the sonos part is relatively straight forward and documented on the forum.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by jules_bike at Mar 23, 2014 13:30
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885473"></a>
                                    <font class="smallfont"><p>There is no telnet server in OR, is there anything else your automation system can use to notify external systems?<br/>
Sending a UDP packet would be easiest, you can then use the UDPListener protocol in OR.<br/>
If not, you might need to write a small gateway, acting as a telnet server and signaling OR via some other means.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Mar 24, 2014 10:21
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885475"></a>
                                    <font class="smallfont"><p>Thanks for the replies. </p>

<p>So the SONOS control part sounds straightforward. </p>

<p>Signalling OR seems to be the issue. The alarm panel has a few ways to signal but not sure if they are suitable for OR. I'm using one of the volt free contact closures on the alarm panel to input to the lighting system. This then allows the lighting system to control various relays and the lights. I can output from the lighting system to external devices but only via contact closure or telnet which I program into a scene. The lighting system also allows communication externally via RS232 but I haven't used this function as yet. </p>

<p>The alarm panel itself can output using the contact closure stated above or via SMS. Apart from that there's no other means. It does have an Ethernet port for control of the alarm system but you can't use this to output as the manufacturer has locked down the interface and doesn't produce an API. </p>

<p>Would RS232 be an option?  Don't know how you would get this to OR though. I guess you'd need a wired interface from the RS232 output on the lighting panel to some sort of gateway which then networks to OR. </p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by andyh747 at Mar 24, 2014 10:54
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885503"></a>
                                    <font class="smallfont"><p>Do you mind sharing brand/model of your security and lighting systems ?<br/>
Might help in finding the easiest solution.</p>

<p>A lot of things are possible, you can use RS232, directly plug into your Synolgy via a USB-Serial converter, via an Serial-IP converter like a GlobalCach√©.<br/>
You can also use some form of interface to "read" the contact closure in OR, many options would be applicable there.<br/>
Also, as I said earlier, you can implement a small software gateway that could act as a telnet server and translate that to a UDP broadcast, allowing you to integrate your lighting system to OR without additional hardware.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Mar 25, 2014 15:07
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885522"></a>
                                    <font class="smallfont"><p>Thanks Eric for the reply.</p>

<p>My security system is a Cooper Security (now Eaton) Scantronic i-ON40 and the lighting system is Mode Lighting eDIN.</p>

<p>There is no other outputs for the alarm panel except contact closure.  Although it can be accessed and controlled over the LAN, the protocol is locked down by the manufacturer for security and integration in that form is impossible.  I've even approached the manufacturers about this but they will not release the protocol for the ethernet interface.  </p>

<p>eDIN can have a telnet command associated with a scene.  At present, when the alarm is set, all the lights are switched off.  When the alarm is activated then all the lights switch on.  This is achieved using a contact closure output from the alarm panel to an input/output module on eDIN.  So ideally setting a simple telnet command which outputs to OR when the 'Alarm Activated' scene is triggered would be the easiest solution.  eDIN is restricted in what it can send via telnet.  I haven't actually experimented with this function but I understand that you enter an IP address and a command to send via telnet.  I don't think there is an option to send username and password so the telnet server would have to be open.  Again I would have to check this.  The RS232 function is similar allowing an RS232 command to be sent as part of a scene and the output is then delivered via a wired connection directly on the eDIN NPU (Network Processing Unit).  My synology box isn't located near the eDIN system.  It could be moved but I'd rather not have to.</p>

<p>Hope the above helps.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by andyh747 at Mar 26, 2014 11:43
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885549"></a>
                                    <font class="smallfont"><p>Telnet from the eDIN would be easiest but:</p>
<ul class="alternate" type="square">
	<li>you would need to write some software that acts as a telnet server and sends UDP packet to OR</li>
	<li>I took a quick look at the eDIN documentation and indeed it seems that you can't define a username/password, not the port for telnet commands. Former is a bit of a security risk, though in a LAN and with appropriate control this can be mitigated. Later means that you must use the standard telnet port, so if you run that small gateway on the Synology, you need to check if there is no default telnet server there or if you can replace it with your own.</li>
</ul>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by ebariaux at Mar 27, 2014 12:00
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22885551"></a>
                                    <font class="smallfont"><p>Thanks Eric. Much appreciated. </p>

<p>I'll look into the software but am a complete beginner when it comes to that side of things. It would have to be software that could run on the synology and I'm not sure how to even begin to look at that. </p>

<p>Thanks for pointing me in the right direction. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by andyh747 at Mar 27, 2014 14:35
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:34</font></td>
		    </tr>
	    </table>
    </body>
</html>