<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : minutesUntilSunset Custom State Problem</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : minutesUntilSunset Custom State Problem
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Nov 30, 2014 by <font color="#0050B2">rmcerlain</font>.
				    </div>

				    <p>I've just got the Date and Time to work using minutesUntilSunset on my mac.<br/>
I have copied it over to a Raspberry Pi, soft float with 1.6, it now does not work.<br/>
Has anyone any ideas? Log and rule below.</p>


<p>DEBUG 2014-11-30 12:24:24,135 : Created object model for Command( ID = 431, Type = datetime, Properties : <div class="error"><span class="error">Unknown macro: {timezone=Australia/Perth, name=minutesUntilSunset, command=minutesUntilSunset, longitude=115.8589, latitude=-31.9522}</span> </div>).<br/>
DEBUG 2014-11-30 12:24:24,156 : Initializing event processor: Drools Rule Engine<br/>
DEBUG 2014-11-30 12:24:24,398 : Adding Rule 'modeler_rules.drl'...<br/>
ERROR 2014-11-30 12:28:05,925 : Rule definition 'modeler_rules.drl' could not be deployed. See errors below.<br/>
ERROR 2014-11-30 12:28:06,033 : Unable to resolve ObjectType 'CustomState'<br/>
ERROR 2014-11-30 12:28:06,035 : Unable to resolve ObjectType 'CustomState'<br/>
ERROR 2014-11-30 12:28:06,250 : There was an error parsing the rule definition 'modeler_rules.drl' : Could not parse knowledge.<br/>
java.lang.IllegalArgumentException: Could not parse knowledge.<br/>
	at org.drools.builder.impl.KnowledgeBuilderImpl.newKnowledgeBase(KnowledgeBuilderImpl.java:58)<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.getValidKnowledgePackages(RuleEngine.java:532)<br/>
	at org.openremote.controller.statuscache.rules.RuleEngine.start(RuleEngine.java:253)<br/>
	at org.openremote.controller.statuscache.EventProcessorChain.start(EventProcessorChain.java:112)</p>





<p>package org.openremote.controller.model.event</p>

<p>global org.openremote.controller.statuscache.CommandFacade execute;<br/>
global org.openremote.controller.statuscache.SwitchFacade switches;<br/>
import org.openremote.controller.protocol.*;</p>

<p>rule "SunSet"<br/>
when<br/>
CustomState( source=="minutesUntilSunset", value=="1435")<br/>
then<br/>
execute.command("12.8 On");<br/>
System.out.println ( "SunDown" );<br/>
end </p>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:37</font></td>
		    </tr>
	    </table>
    </body>
</html>