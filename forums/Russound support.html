<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Russound support</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Russound support
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Nov 04, 2009 by <font color="#0050B2">mredeker</font>.
				    </div>

				    <p>Hi guys,</p>

<p>I am currently in contact with the german distributor of Russound.<br/>
Russound is a major brand for producing distributed audio-video and multiroom entertainment systems.<br/>
The Russound devices support complete control through a RS232 port and I will implement the protocol for the OpenRemote controller.</p>

<p>Anybody here who already has a Russound device and can suggest what features to implement first?</p>

<p>&#45;-Marcus</p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/5537879/19398696.png">Screenshot 2011.11.11 10.52.25.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/5537879/19398717.png">TestPng.png</a> (image/png)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-5537880"></a>
                                    <font class="smallfont"><p>This would be another awesome contribution from you into OR integration stack!</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Nov 05, 2009 01:14
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-5865548"></a>
                                    <font class="smallfont"><p>The first implementation based on the current controller trunk source is done.<br/>
It supports turning all zones on/off, each zone separately can be turned on/off, you can select the input source for each zone and adjust the volume for each zone.<br/>
Currently only one controller with up to 6 zones is supported but we can easily extend to more controller and zones since all russound commands are stored in a property file.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Nov 15, 2009 12:08
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-5865567"></a>
                                    <font class="smallfont"><p>Very cool, thanks for working on this and contributing it Marcus.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Nov 19, 2009 00:43
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-6258691"></a>
                                    <font class="smallfont"><p>The code for this is currently available in <a href="http://openremote.svn.sourceforge.net/viewvc/openremote/branches/feature/RussoundSupport-mredeker/">/branches/feature/RussoundSupport-mredeker</a></p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Nov 20, 2009 12:28
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601377"></a>
                                    <font class="smallfont"><p>I have a Russound CAV6.6 with 4 additional A-Bus zones attached that I am looking to interface with via OpenRemote. My audio includes a Russound Tuner ST and a BARIX extreemer as a music streamer from my computer as 3rd Russound source. There is also a JDS Technologies Stargate Home Automation Controller that I want to interface with via RS232 but that will have to follow the Home Audio automation.</p>

<p>I have downloaded the /branches/feature/RussoundSupport-mredeker code, compiled and deployed. Now I am looking to configure a few panels from my iTouch to activate the system. I have created a basic screen with a button that does nothing except demo that I have a connection to my OR server (Debian linux on ancient Pentium computer). Now I am just staring at all this stuff wondering what to do next. </p>

<p>I would like to create a panel to do basic stuff on/off just to get a starting place. what are the sequence of actions to link iTouch button to OR action for the Russound? Which option for creating the interface? A: <a href="http://composer.openremote.org/1.0/">http://composer.openremote.org/1.0/</a> or B: <a href="http://composer.openremote.org/demo/Modeler.jsp?">http://composer.openremote.org/demo/Modeler.jsp?</a><br/>
I will start reviewing to code to see if I can figure out the nuts and bolts that drve this tool....</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by omikeneil at Apr 06, 2010 03:13
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601378"></a>
                                    <font class="smallfont"><p>Michael,</p>

<p>the code from the "RussoundSupport-mredeker" branch is based on BOSS 1.0, but the composer for 1.0 does not support the russound commands yet.<br/>
You will have to modify controller.xml by hand to get the Russound commands working.</p>

<p>@Juha: Maybe you can create a 2_0_0_Alpha4 tag which has support for Russound?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 06, 2010 08:23
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601379"></a>
                                    <font class="smallfont"><p>Can you guys port the Russound code from 1.0 to 2.0? I'm a tad busy right now. You can branch either from /trunk/UIDesigner or /branches/project/UIDesigner_2_0_0_Alphas. Both are regularly synced at the moment with the ongoing work. I'll merge back to release branch once you're done.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by admin at Apr 06, 2010 18:39
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601398"></a>
                                    <font class="smallfont"><p>I code for Weblogic and WebSphere using Eclipse in the corporate world. I just recently installed Tomcat on Debian at home and I will need to come up to speed on the code. I am somewhat unfamilier with the opensource nature of the project but I will see if I can dig in and see where this project is headed. </p>

<p>I downloaded OpenRemote-Boss-1.0.2.zip. is there a version 2.0? Reviewing what I have I am not sure that the Russound code is deployed. </p>

<p>I will review the code to see if I can contribute in any way. I would like to see if I can get one thing working before attempting something so cool as porting the code.....</p>

<p>Is there a sample controller.xml file that demos the russound features that I can hack?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by omikeneil at Apr 08, 2010 02:28
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601404"></a>
                                    <font class="smallfont"><p>You're half way there &#8211; you were able to compile and run Marcus' /branches/feature/RussoundSupport-mredeker</p>

<p>This is not included in the 1.0.2 binaries, I never had the time to integrate it back to the mainline (and it slipped my mind).</p>

<p>So work on the RussoundSupport-mredeker binaries you've compiled.</p>

<p>You will find a russound.properties file there with a configuration sample (WEB-INF/classes directory IIRC).</p>

<p>On porting, there has been changes between 1.0: first the protocol API in the controller may need to be adjusted for 2.0. The 2.0 controller has not gone through QA yet but the branch to work from is /branches/feature/Controller-profile-service (that is the 2.0 controller implementation).</p>

<p>The second part of the porting is configuration mechanism has changed, it's driven by the online designer now where you use the web UI to set protocol specific properties, these are downloaded as an XML file to the controller. The Russound implementation would ideally follow the same model (though this is a secondary goal in the porting effort).</p>

<p>So yeah, get your stuff first working with the -mredeker Russound branch to ensure you have a working system to test against.</p>

<p>Then if you're so inclined, can look into 2.0 porting.</p>

<p>Sorry to hear about your second life with Weblogic/Websphere (just kidding... Just Kidding!!). Welcome to Open Source <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Apr 08, 2010 11:35
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601405"></a>
                                    <font class="smallfont"><p>I already have the russound support ported to the 2.0 controller implementation.<br/>
It's just not in SVN in the moment.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 08, 2010 11:46
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601406"></a>
                                    <font class="smallfont"><p>Great! <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Apr 08, 2010 11:55
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601413"></a>
                                    <font class="smallfont"><p>pays the bills.....</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by omikeneil at Apr 09, 2010 02:05
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601414"></a>
                                    <font class="smallfont"><p>Indeed it does <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by admin at Apr 09, 2010 04:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601425"></a>
                                    <font class="smallfont"><p>IT DONT WORK... for me. There was no sample configuration file to hack so I am running a sample I created to see what the code does with it. I am making progress. There are no errors in the controller.log file and I suspect I may not be getting any output on the serial port to the Russound controller. </p>

<p>Correct me if I am wrong: I created an openremote.zip file using the online creator tool. from this it really does not matter what the iTouch screens are since the ButtonCommandRESTServelet.java only reads the command button ID and looks this up in the controller.xml which then supplies the actual command processed. Yes? NO? (don't beat me up Warf...)</p>

<p>I am up to the point where I am viewing the actual command received from the iTouch in the ButtonCommandRESTServelet.java.  I am going to follow this through  - to my guess is reading the controller.xml file in the buttonCommandServiceImll.java for the russound.propeties property to get the zone1.on command string. Then follow that to see why nothing is getting dumped to the device.</p>

<p>I do see in the code (somewhere when I was looking) that the Russound commands are dumped into the serial port (not udp, actual RS232 hardware...as configured in the russound.property file) - Task over. There is no dialog with the controller in this release. I am pretty excited to hopefully get Zone 1 to turn on - if I can only get more than a few hours a week to look at this.</p>

<p>Once I get zone 1 working (ON/OFF -MAX VOLUME to announce to my local world of my triumph) I would like to begin looking into starting up a thread that monitors COM1 I/O picking up traffic and begining dialog with the unit there. <br/>
I am also interested in getting a separate web app to be able to send/receive data to this device via a web service or direct link.</p>

<p>Markus have you had any updates on the dialog with Russound? In the documentation that I have gotten from there web site I understand the RNET "dialog" used. However, they have a directory structure for saving data on the various devices. the directories are numeric values and data can be placed there - for example the bass setting is in a directory structure on the zone controller and it has a value placed there. I have not found documents the tell me what the directories are for, for example directory 0,4,3,4 (4 levels deep) holds the Bass value of 4 (out of possible 10). When I monitor the RNET traffic in a basic com port reader pgm I can see all this detail but I am still deciphering what these directories represent.</p>

<p>I'll keep hacking at it...<br/>
Mike<br/>
RED WINE = VERBOSE</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by omikeneil at Apr 13, 2010 04:05
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601426"></a>
                                    <font class="smallfont"><blockquote>
<p>Correct me if I am wrong: I created an openremote.zip file using the online creator tool. from this it really does not matter what the iTouch screens are since the ButtonCommandRESTServelet.java only reads the command button ID and looks this up in the controller.xml which then supplies the actual command processed. Yes? NO? (don't beat me up Warf...)</p></blockquote>

<p>That's correct. The controller is decoupled from clients, you can invoke the REST interface directly (from your browser if you want to). iTouch is not necessary.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Apr 13, 2010 05:33
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601430"></a>
                                    <font class="smallfont"><p>Now that you mention it - DUH! I really do not need my iTouch, just a link on a web page that performs the same thing. I do like that! But controlling on the iTouch makes that purchase so much more justified....</p>

<p>I did find the RussoundEvent.java was using a different RS232 port configuration than I use when monitoring the port in my utility. So I updated that in the code. Still no luck. I am debugging this event to see if I am hitting the udp or RS232 code and what is the command I am sending.</p>

<p>I really feel a eureka moment is near...</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by omikeneil at Apr 14, 2010 03:49
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601431"></a>
                                    <font class="smallfont"><p>aghh! the moment passed....<br/>
The port WAS 19200, my udp WAS back into the props, my environment is chaotic... do I look like I am going bald?</p>

<p>NOW I think I have it right and I still get no response from the Russound controller. Next step is to hook up the laptop to the com port and monitor the port to see if I get any DC on the port.</p>

<p>This is more of a challenge then I expected....</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by omikeneil at Apr 14, 2010 05:17
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601445"></a>
                                    <font class="smallfont"><p>OK I have tracked my issue to the rxtxComm. The error is in the tomcat/logs/localhost.log: java.lang.NoClassDefFoundError: Could not initialize class gnu.io.CommPortIdentifier</p>

<p>It is apparently not in the classpath. I have the Sun comm.jar in my classpath on tomcat (I use this to read the serial port in my crude port reader pgm). But my program includes this at run time and tomcat apparently is not finding even after adding to the tomcat/bin/setenv.sh</p>

<p>I see RXTXcomm-2.2-pre2.jar file in the Russound tar file, but it does not seem to be found by tomcat/controller when attempting a call to the port. (the error is: java.lang.NoClassDefFoundError: Could not initialize class gnu.io.CommPortIdentifier) </p>

<p>I am new to tomcat. Anyone familier will adding this to the classpath? Which file is required? Sun or rxtx?</p>

<p>I am going to continue to find out if I can use the Sun version, change my controller to use the sun jar file I know works on my model T computer....</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by omikeneil at Apr 19, 2010 03:16
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601446"></a>
                                    <font class="smallfont"><p>You need the RXTX implementation. This comes with a jar and a shared library. You need the jar in your classpath (controller/WEB-INF/lib/classes) and the shared library in your windows or linux library path.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 19, 2010 08:01
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601447"></a>
                                    <font class="smallfont"><p>You need the RXTX implementation. This comes with a jar and a shared library. You need the jar in your classpath (controller/WEB-INF/lib/classes) and the shared library in your windows or linux library path.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 19, 2010 08:01
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-9601453"></a>
                                    <font class="smallfont"><p>EUREKA! Finally!<br/>
OK now this is cool  .. thanks!<br/>
Now to get all the existing commands to work from the property file. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by omikeneil at Apr 20, 2010 02:18
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15532985"></a>
                                    <font class="smallfont"><p>I have a CAV 6.6 installation in my home so naturally i am interested in your work on the Russound serial protocol. Now I wonder, since the designer does not support Russound, would it be possible to check in a sample controller.xml on the Russound branch? Some kind of mini-tutorial covering the necessary configuration would be helpful. Then I am interested in patches for the Controller 2.0, if it would be possible to produce any.</p>

<p>What is your thoughts about the future of the Russound solution you have started? Is it worth continue on it as it is now? I have experience as a Java developer so I might be able to help bring things a bit forward.</p>

<p>As an alternative solution I thought about creating a standalone application for controlling Russound providing a web-interface that could be integrated in the Openremote solution using HTTP. That would simplify the integration in the Designer but with no immediate support status updates. What do you think about such a solution? </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by toesterdahl at Mar 16, 2011 16:37
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15533017"></a>
                                    <font class="smallfont"><p>I am currently working on a new implementation which supports all kinds of control and also read feedback from the device.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Mar 16, 2011 20:29
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-15533087"></a>
                                    <font class="smallfont"><p>Another feature I thought about was to have a daemon listening for keypresses on the Russound keypads and feed them back to use them as input of Openremote.&nbsp;</p>

<p>Anyway, it would be cool to be able to share that code on some new branch. I started migrating the 1.0 Russound code into my 2.0 system and it does not seem to overwelming. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by toesterdahl at Mar 17, 2011 21:59
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-16023589"></a>
                                    <font class="smallfont"><p>Well. This is a key feature to me and I wanted to learn a bit about support for RS232 in OR so I got the code migrated to version 2.0.0 Alpha 11 of the controller. The results are at <a href="https://openremote.svn.sourceforge.net/svnroot/openremote/workspace/toesterdahl/Controller_2_0_0_Alpha11_Russound/">https://openremote.svn.sourceforge.net/svnroot/openremote/workspace/toesterdahl/Controller_2_0_0_Alpha11_Russound/</a>. Works for the functions operating on a Russound Zone implemented by Marcus.<br/>
Right now I see that the following features could be added to the Russound solution;<br/>
1. Support in Designer for Russound protocol. &nbsp;<br/>
2. Feedback through the StatusCommand. &nbsp;<br/>
3. Have keypresses of Russound keypads operating on Sources (Devices in OR lingua) fed back into the OR system.<br/>
4. Support for all Russound commands operating on a Zone.<br/>
5. Reconciling with othere RS232 protocols of OR.<br/>
My opinion is that 1. is vital, manual configuration is a real pain. 2. is mostly sugar but nice if it works. 3. Would clearly be expected in Russound installations but is conceptually a bit alien to OR. 4. Probably does not add much, vital commands is already supported.<br/>
I would be interested in Marcus' opinion about what to do next??</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by toesterdahl at Mar 29, 2011 15:47
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-16023602"></a>
                                    <font class="smallfont"><p>Regarding #3, are you able to provide some generic model of what you mean here to someone not familiar with Russound (keypads operating on sources fed back into OpenRemote?)</p>

<p>May be alien for OR now but if we can understand it, we may be able to bring it to the next major version in some generalized form. Use case description would help.</p>

<p>Thanks for the contribs in SVN,</p>

<p>&#8211; Juha</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Mar 29, 2011 21:12
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-16023605"></a>
                                    <font class="smallfont"><p>The russound system have six listening zones. Each zone have a keypad and is at any moment in time assigned to one audio/video (AV) source. The keypad allows different operations on the system (as a whole), on the zone or one the source.<br/>
The most essential operations on the system and zone level are implemented namely source select, volume up/down and power on/off.<br/>
For the purpose of controlling source devices each keypad have the buttons 'Pause', 'Stop', 'Play', 'Fwd', 'Back', 'Next' and 'Previous' as well as the macro buttions 'F1' and 'F2'.<br/>
From a configuration point of view you would expect to se that your device (the Russound device) could generate the event 'Play' for any of six sources. You would want to map this to commands on source-devices. The mapping could be the same that is currently done for button keypresses in the Designer.<br/>
I am unsure, perhaps the event of my description is exactly what signals do?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by toesterdahl at Mar 29, 2011 22:05
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-16023700"></a>
                                    <font class="smallfont"><p>My current testing is also aiming in this direction. All RNET commands and feedbacks could be supported. It's just a hack and I am still testing but a new version of the Russound support will go in this direction.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 01, 2011 22:39
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-16023708"></a>
                                    <font class="smallfont"><p>I gave it another thought while I browsed other protocol implementations. I see some space for adding a protocol to provide generic support for RS232. This could work very similar to generic support for protocols such as http and telnet. Right now these protocols is not much more then transport mechanisms for messages which could be hex-based or ascii. If they would be improved beyond that for say, interpreting responses, it would make sense to keep the implementation consistent across these protocols. I would categorize these protocols as transport oriented and device-independent. Such a generic RS232 support could easily replace the Russound support as it currently stands. Are there any place for a dedicated Russound protocol then? Well only if the protocol API exposes enough features that actually makes a difference at configuration time. The events discussed in my previous post would be one such feature, though. However it only makes sense to add new features to the protocol if they can be used by other parts of the system, say the designer and the panels. </p>

<p>Take this example. I am also looking into supporting the Denon AVR's over RS232. They have commands for navigating an IPOD, commands that sometimes would return a selection list of songs. However unless there are configurable components to do something with this playlist I would just as well expose the commands and forget about the response, something that can be achieved in a very generic fashion. </p>

<p>At the moment I am hacking some support for my Denon AVR system. It uses some rather readable Ascii messages and it appears that it should be rather painless to make it work. A slight challenge might be to make things generic for various Denon AVR models. Similar to Russound, another challenge is to do something sensible with responses so that they can actually be used by the Openremote system. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by toesterdahl at Apr 02, 2011 14:37
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-16023745"></a>
                                    <font class="smallfont"><p>1) Generic RS232 support would be very interesting, similar to generic HTTP, TCP/IP, Telnet and UDP</p>

<p>2) Yes the protocol (and event) level scripting is coming along, it is being implemented as we speak</p>

<p>3) Does it leave space for Russound specific implementation &#8211; in the long run perhaps not, in the short run a device specific protocol implementation can be easier for users on the designer side with specific commands (play, stop, etc) rather than having to dig up the RS232 protocol specs and type things in.</p>

<p>Longer term, these should be something we store in the Beehive. With a combination of protocol scripting, generic transports and ability to share everything in the cloud, a lot of the need for specific protocol implementations disappear (to what extent depends on the quality of the scripting language, i.e. even KNX IP tunneling could be scripted instead of written in Java but how much that makes sense to do so depends on the use case).</p>


<p>So yeah, your intuition is correct. We need to get the controller up to speed regarding 2.0 release &#8211; the basics need to be solid otherwise the tooling makes little sense.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Apr 05, 2011 14:34
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-16023746"></a>
                                    <font class="smallfont"><p>The problem with Russound is that the RS232 protocol is a binary protocol <img class="emoticon" src="images/icons/emoticons/sad.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> You cannot just send ASCI strings which works with all other home entertainment devices. Also, you have to recalculate a checksum every time you change a value. Which means e.g. a volume slider which can go from 1-100 has 100 commands which are all different because of the value and the checksum. This is what I am currently working on.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 05, 2011 15:01
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-16023747"></a>
                                    <font class="smallfont"><p>The problem with Russound is that the RS232 protocol is a binary protocol <img class="emoticon" src="images/icons/emoticons/sad.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> You cannot just send ASCI strings which works with all other home entertainment devices. Also, you have to recalculate a checksum every time you change a value. Which means e.g. a volume slider which can go from 1-100 has 100 commands which are all different because of the value and the checksum. This is what I am currently working on.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 05, 2011 15:01
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-16023748"></a>
                                    <font class="smallfont"><p>The problem with Russound is that the RS232 protocol is a binary protocol <img class="emoticon" src="images/icons/emoticons/sad.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> You cannot just send ASCI strings which works with all other home entertainment devices. Also, you have to recalculate a checksum every time you change a value. Which means e.g. a volume slider which can go from 1-100 has 100 commands which are all different because of the value and the checksum. This is what I am currently working on.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 05, 2011 15:01
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-16023772"></a>
                                    <font class="smallfont"><p>Thanks. Good point. I guess it applies to anything where you have some parameter to the input; such as the slider in this case. For any pre-configured commands such as button presses the command including checksum can be prepared beforehand, which have been demonstrated. The checksum is indeed rather hairy and seem implementation specific.</p>

<p>This is the procedure for calculating the checksum.</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
Step #1 - Add the HEX value of every <span class="code-object">byte</span> in the message that precedes the Checksum:
Example - 0xF0 + 0x00 + 0x67 + 0x7C + 0xF1 + 0x0F = 0x02D3
Step #2 - Count the number of bytes which precede the Checksum and convert that value from
DEC to HEX (<span class="code-object">byte</span> count). Add the <span class="code-object">byte</span> count in HEX to the previously calculated sum of
bytes:
Example - 0x02D3 + 6 (6 = Decimal value <span class="code-object">byte</span> count) = 0x02D9
Step #3 - This value is then AND-ed with the HEX value 0x007F (7F is the highest BIN value
<span class="code-keyword">for</span> 7 bits = 1111111). The Checksum itself and the End of Message <span class="code-object">Character</span> are not
included in the calculation. Only the low 7 bits are used so overflow is discarded:
Example - 0x02D9 AND 0x007F = 0x59 = Checksum

(no copyright!)
</pre>
</div></div> 
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by toesterdahl at Apr 06, 2011 20:09
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-16023773"></a>
                                    <font class="smallfont"><p>Thanks for information, in particular your view on adding configuration to Beehive. In fact that is what I wanted to do; although I was reluctant to take it on not knowing how good the support for this was in the project. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by toesterdahl at Apr 06, 2011 20:13
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-16023774"></a>
                                    <font class="smallfont"><p>I already have the checksum calculation implemented in the OpenRemote controller <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> Currently I am working on a reader thread which translates RNET protocol data (e.g. keypad buttons) into OpenRemote sensor information.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 06, 2011 21:15
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-16023781"></a>
                                    <font class="smallfont"><p>No problem. I thought so. But I thought someone else following the thread might be interested in what we were talking about. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by toesterdahl at Apr 07, 2011 19:51
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19433675"></a>
                                    <font class="smallfont"><p>Hi Torbjörn,</p>

<p>I rewrote the Russound integration and the commands are not needed as hardcoded hex strings as before. Everything is dynamic now and the checksum is calculated by the controller. We don't need the russoundCommand.properties anymore and I integrated the russound.properties into the general config.properties.</p>

<p>In the designer you now have to specify a zone number (1-6), a controller numer (1-6) and a command.</p>

<p>I also implemented the new EventListener interface which means changes done by the keypads are recognized and displayed back in the UI through sensors.</p>

<p>It is now possible to use sliders for Volume, Balance, Treble and TurnOnVolume.</p>

<p>The changed protocol is currently beeing integrated by Juha into the new 2.0 release.</p>

<p>You can also find it in my branch: workspace/mredeker/Controller_EP_SNAP_20111102_NewProtocols</p>

<p>Here is a screenshot: <br/>
<img src="attachments/5537879/19398696.png" align="absmiddle" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Nov 16, 2011 09:10
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-19434244"></a>
                                    <font class="smallfont"><p>1</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pjmm at Dec 12, 2011 20:27
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:31</font></td>
		    </tr>
	    </table>
    </body>
</html>