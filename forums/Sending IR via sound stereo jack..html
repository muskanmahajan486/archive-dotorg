<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Sending IR via sound stereo jack.</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Sending IR via sound stereo jack.
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Mar 02, 2013 by <font color="#0050B2">aktur</font>.
				    </div>

				    <p>I need to send couple of IR commands and find a full blown IR transceiver prices a little too high for just this. What I though is to use a cheap IR emitter like this one 
<a href="http://www.icasa-domotica.nl/webshop/beschrijving.php?id=30&amp;path=9">http://www.icasa-domotica.nl/webshop/beschrijving.php?id=30&amp;path=9</a><br/>
and use sound output for sending codes as roughly described here <a href="http://wiki.samygo.tv/index.php5/Remote_Control_emulator:_send_custom_IR_codes">http://wiki.samygo.tv/index.php5/Remote_Control_emulator:_send_custom_IR_codes</a></p>

<p>A question is, have anybody in OR community made a similar work which I can use as starting point? Any input will be appreciated.</p>

				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-21858179"></a>
                                    <font class="smallfont"><p>If you have an RS232 port I would use that instead, a very basic circuit is very easy to make look for LIRC DIY circuits.</p>

<p>One way of communicating with such a device in OR would be to use Shell Execution protocol and have scripts / batch files that read and write to the device. I have done this on Linux in the past in order to turn TV on when media PC is switched on. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by kurrazyman at Mar 03, 2013 09:49
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21858181"></a>
                                    <font class="smallfont"><p>There are of course several low-cost solutions, the LIRC serial driver being one of them. But let me address the topic of the thread.</p>

<p>Hardware: You need two of the stick-on emitters, not one, strictly speaking. Using only one may work, at least with some luck: Computing the Fourier series of the singly rectified sine (like connecting a diode (e.g. LED) to a sine centered at 0) shows a very strong second harmonic, and a demodulating chip (like a TSOPxxxx) may trigger on that. Experiments I made some time ago with a Yamaha receiver was positive. </p>

<p>Secondly, there is a widely spread misconception in the internet that a stereo signal is necessary. This is simply plain wrong. Of course, having two channels in anti-phase doubles the amplitude, but that can most often be achieved by adjusting the "volume" properly.</p>

<p>Software: you can generate wave-files with my software <a href="http://www.harctoolbox.org/IrMaster.html">IrMaster</a>. If your Java supports it, it can be sent directly to your audio port. You can also embed its Java library (IrpMaster) into a Java application. (There is of course also other software in the internet generating wave files.)</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by barf at Mar 03, 2013 10:14
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21858213"></a>
                                    <font class="smallfont"><p>Bengt,</p>

<p>thanks for interesting input.<br/>
Just few questions, why do I need two emitters? Can you elaborate?</p>

<p>Can your software IrpMaster be included in OR? IMHO it would be a great addition for low cost IR solution. <br/>
For example, in my application I only need to send Power ON command to my Samsung TV because rest commands can be sent via LAN.</p>

<p>One other thing though, form you experience is it safe to connect IR transmitter directly to the standard audio output or some driver circuit would be advised? I would like just plug in IR emitter directly into ebox sound output but I don't want to damage the ebox (directly or after some time).</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Mar 04, 2013 13:19
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21858215"></a>
                                    <font class="smallfont"><p>Richard,</p>

<p>what advantage would have connecting IR transmitter to RS232 port compared to the sound output.<br/>
For one, RS232 usually has a different plug than off the shelf IR emitters.</p>

<p>Shell execution protocol can be used in both cases. The only problem with the shell execution protocol I have is that it is not easily portable. With OR interface I can easily port my controller design from one platform to the other. With shell commands it frequently means that I need manually change things (paths, binary names, response format). For example, simple ping command gives different result when run on windows/linux, moreover the response language can differ.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by aktur at Mar 04, 2013 13:27
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21858219"></a>
                                    <font class="smallfont"><p>IR Emitters are just diodes so there is no connector, I'm guessing you're referring to emitters which already have a 3.5mm jack and length of wire attached.</p>

<p>Benefit of using RS232 is that you don't have any issues with Analogue to Digital conversion as Bengt was referring to so it is in my opinion a simpler implementation; a basic IR emitter for the serial port only needs a diode, resistor and an IR emitting diode; most serial ports are 5V these days so you might consider an amplifier circuit depending on range requirements and IR emitter used.</p>

<p>I only mentioned the Shell Execution protocol as a means of integrating with OR and isn't related to the use of a serial port specifically. The problem you mentioned with different shell execution responses on different platforms is an expected problem and although OR is platform agnostic (being JAVA) shell commands obviously aren't. This is a problem encountered with any device directly wired to the controller hardware as straight away you've introduced a platform dependency as JAVA cannot talk directly to your hardware.</p>

<p>TCP/IP devices provide that abstraction between the device and the controller as the TCP/IP stack in JAVA is totally cross platform; appreciate the fact though that IR &lt;-&gt; TCP/IP interfaces are not cheap.</p>

<p>Regarding the Samsung TV; I have the exact same issue and I cannot believe Samsung didn't use a NIC that supports Wake-On-LAN as without it the TCP/IP control seems completely pointless as you still need an IR remote to switch the thing on.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by kurrazyman at Mar 04, 2013 18:18
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21858220"></a>
                                    <font class="smallfont"><p>Hi Michal,</p>

<p>the theory behind connecting IR diodes to an audio output is explained on may places in the internet, e.g. <a href="http://lirc.org/html/audio.html">here</a>. Let me explain with my own words: Say that you need to send an IR signal with the typical modulation frequency 38kHz (e.g. NEC1). If your sound card supports 38kHz on output, fine, you are all set with one sender diode. Most (all?) sound cards do not support this. If you double rectify a 19kHz sine symmetric around 0 (see the first figure in the link), you will end up with  something with 38kHz frequency. The double rectification can be done w.g. with <a href="http://en.wikipedia.org/wiki/Rectifier#Full-wave_rectification">four diodes</a>, and then fed to one LED, or you can use two LED, one transmitting during the positive half period, and the other during the negative half period. </p>

<p>Work on integrating IrpMaster into OR has <a href="http://www.openremote.org/display/forums/A+better+IR-Command">already started</a>. (But not as "low cost soluton", but a non-plus-ultra solution <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> ). </p>

<p>There are many reports on the internet on successfully using very simple devices for IR control along these lines. My own test device happens to be at the other end of the scale, with several hundreds or Watts... Generally speaking, I would always use at least some resistor in series with the IR LED. But feel free to experiment.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by barf at Mar 04, 2013 18:19
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21858221"></a>
                                    <font class="smallfont"><p>Shell execution is almost always a non-elegant solution. (Ok, this is the user forum, not the design forum, so I will leave the tar and the feathers in the closet <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/>) LIRC for example, allows at least two other possibilities: If client and server are on the same machine, the client can write to the LIRC "Unix socket" /var/run/lirc/lircd on recent LIRCs IIRC). Or the LIRC daemon lircd can be started with the <del>l (</del>-listen) option making it listening to a (network) socket, and can be sent commands that way. (Works over the network, and is even supported by WinLirc, as opposed to the first method.) I have even on my website a <a href="http://harctoolbox.org/lirc_ccf.html">patch</a> for LIRC allowing arbitrary CCF signals to be sent to lircd, without having to reside on the server. </p>

<p>Ping: good example. Michal, you forgot that it also requires privileges <img class="emoticon" src="images/icons/emoticons/wink.gif" height="20" width="20" align="absmiddle" alt="" border="0"/>. That is why I use Java's isReachable in IrMaster. (Ok it is not really, really, the same) </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by barf at Mar 04, 2013 18:36
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 10:45</font></td>
		    </tr>
	    </table>
    </body>
</html>