<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Ubiquiti Networks mPower devices (mFi)</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Ubiquiti Networks mPower devices (mFi)
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Feb 08, 2015 by <font color="#0050B2">nbright83</font>.
				    </div>

				    <p>I have just acquired a controllable plug made by Ubiquiti.  I was curious if any of you have tested any of this mFi stuff with Openremote.  It runs some sort of dumbed down version of linux, with BusyBox, and can be ssh'd into, and can also take some http commands.  It can provide you with seperate plug switching as well as stats about power factor, voltage, amps, as well as kwh.  They have free controller software, but I got ahold of this thing with the intention of using only Openremote.  They also have a bunch of sensors and a lighting dimmer with similar features.  Seems like it could be a great way to go... Anybody out there?</p>

				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-23600739"></a>
                                    <font class="smallfont"><p>Nick, I've got a few mFi units and I'm pretty confident they're working as anticipated at this point, so I'm looking to do the same as you. </p>

<p>I'd like to get status (on/off), load (power consumption), and control (on/off) of the various ports. </p>

<p>I'm just barely advanced enough to grab stuff from a web site or telnet session if I get really lucky with a regex. </p>

<p>So far, I've gathered that there is an HTTP option described here: 
<a href="https://community.ubnt.com/t5/mFi/mPower-mFi-Switch-and-mFi-In-Wall-Outlet-HTTP-API/m-p/1076449#U1076449">https://community.ubnt.com/t5/mFi/mPower-mFi-Switch-and-mFi-In-Wall-Outlet-HTTP-API/m-p/1076449#U1076449</a> </p>

<p>and there's the option to telnet directly to each device to gather data</p>

<p>and there's this script that seems to help make the telnet option work a little better:
<a href="https://community.ubnt.com/t5/mFi/mPower-mFi-Switch-and-mFi-In-Wall-Outlet-HTTP-API/m-p/1076449#U1076449">https://community.ubnt.com/t5/mFi/mPower-mFi-Switch-and-mFi-In-Wall-Outlet-HTTP-API/m-p/1076449#U1076449</a> </p>

<p>I have yet to successfully get anything to work. But I'm confident that a better techy than I would have no problems doing so. I'm currently trying to launch the script above as a "Shell execution protocol" in the controller with parameters that work from the command line of my controller. So far, no luck. </p>

<p>FTR, I'm going that direction because the mFi HTTP/REST setup requires a separate login from the commands and I have /no/ idea how to do that. So... I figured it would be start with direct telnet and/or script. I'm unable to get telnet to work because it involves multiple steps (so far), so... we'll see.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by gregoryx at Aug 22, 2015 21:39
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23600740"></a>
                                    <font class="smallfont"><p>Gregory,  I have yet to document my use of shell scripts and mFi.  You can expect me to post it here this week.  Basically I have also been using she'll execution protocol to call scripts that ssh into mpower and mports to get information and set outputs.  I have not tested this functionality in depth with mfi controller running to see what conflicts may arise, though I suspect it will cause some issues with any mfi rules you may have in place.  It seems the ideal thing for openremote to do would be to edit mongodb as if mfi had made the change, as well as read data from the database without using shell scripts and ssh.  My time on this project has been limited lately, but I really like ubiquiti and their products and would like to further develop the functionality of it with openremote since it seems mfi has taken a back burner with its developers.  </p>

<p>I will post some links later this week, but if you're impatient then search mfi forums for ssh commands, there are some nuggets of great value hidden there.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by nbright at Aug 23, 2015 00:37
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-23600741"></a>
                                    <font class="smallfont"><p>Sounds great, Nick. </p>

<p>I can confirm (suspect?) that direct control of the relays seems to work fine with the mFi controller, as I'm using an Android app to do just that and it seems to be fine so far. </p>

<p>If you could just post a sample of how you're calling the shell script(s), I'd be really grateful. I'm having no success with that. </p>

<p>That script for controlling all the devices looks really promising to me. Having a single file to store all the device information and being able to return everything I want already in the OR controller seems like a great short-cut. I suspect I can make it work if I keep messing with it. I can't find any logs for telnet or TCP/IP commands, so I'm shooting in the dark so far. </p>

<p>Thanks!</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by gregoryx at Aug 23, 2015 00:55
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 09:39</font></td>
		    </tr>
	    </table>
    </body>
</html>