<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Forums : Status scene change, telnet status, key press delay</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Forums : Status scene change, telnet status, key press delay
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Dec 18, 2012 by <font color="#0050B2">tobo</font>.
				    </div>

				    <p>Hi everyone,</p>

<p>I've been an active reader of these forums for quite some time and I have been using OR for a while. A little around my setup:</p>

<p>KNX controlled house throughout - all lighting, shutters, heating, garage door, door bell, weather station etc.<br/>
Media - XBMC, Pioneer Receiver, IP2IR (arriving today), TV (planning on adding Russound as well)<br/>
Security - Soon to be installed Mobotix IP camera, burglar alarm, fire alarm etc.<br/>
Devices - OR app running on Galaxy note 2, iphone 4s, ipad 1 and 2.</p>

<p>Ie, I'm trying to get everything working in one interface and my choice was quite easy as soon as I discovered OR.</p>

<p>I haven't gotten around to the funkiest bits and pieces, at the moment I'm programming lighting and heating in KNX and OR since that's a must for achieving WAF. I've also managed to move away from using the tv remote, receiver remote and xbmc remote apps and instead I'm just using OR. Working good but not great and now I feel I need to start participating in the discussions here in order to get some clarifications.</p>


<p>Scenes<br/>
I want scenes to be driven by KNX and picked up and "enhanced" by OR, this way scenes will work well when pressing push buttons in the house as well as the OR remote. Also, it has the added benefit of scenes working well-ish even if the OR controller was to crash etc. Right now I'm setting up scenes as far as I can with KNX and then assigning these scenes to push buttons. In OR i have a Macro called "&lt;scene&gt; Macro" which performs extra commands against the TV/Receiver etc and also sends the &lt;scene&gt; in question to KNX. What i would like to achieve is that when scene 1 is sent on the KNX bus, a sensor in OR picks this up and then performs the associated extra actions. I see two issues here. </p>

<p>The first is I can't seem to get the sensor to pickup on any scenes sent over the group address (0/3/1 in my case). I've tried with range 0-63 and custom sensor but when I add a label with this sensor it stays at N/A. Is there a way to pickup the scenes going over a KNX group address, am I doing something wrong here? What is the commands supposed to look like, STATUS/SCENE/LEARN_SCENE?? I've tried 'em all with both DPT 17.001 and 18.001.</p>

<p>The second issue would be that in a perfect world I would like OR to register the scene change even if it's sending the scene itself. Ie, I've gotten OR to send scenes over 0/3/1 using LEARN_SCENE and DPT 18.001 (workaround found in a different topic here) but can it also register the change of scene on a sensor? I guess I could wrap macros around two different scenarios (button press in OR performs extra actions and sends scene / scene on bus activates extra command) if issue 1 is resolvable and issue 2 isn't.</p>

<p>Telnet sensors<br/>
Have I understood it correctly when I assume that commands are one thing and status another for telnet, ie even if a command returns a status that is never linked to a sensor. For instance, if I send Power on to my receiver and it returns "on" I still need a separate telnet commands for a sensor that checks the power status periodically?</p>

<p>I'll probably ask a lot more questions as I get into fine-tuning the solution but these are the two closest at hand.</p>

<p>A big thank you and congrats on the awesome application.</p>

<p>Regards,<br/>
tobo</p>

				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">Attachments:</a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038721/21135440.class">GroupValueRead.class</a> (application/octet-stream)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038721/21135441.class">Unsigned8Bit.class</a> (application/octet-stream)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038721/21135452.class">ApplicationProtocolDataUnit.class</a> (application/octet-stream)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038721/21135453.class">ApplicationProtocolDataUnit$ResponseAPDU.class</a> (application/octet-stream)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038721/21135454.class">ApplicationProtocolDataUnit$ResponseAPDU$1.class</a> (application/octet-stream)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038721/21135449.class">ApplicationProtocolDataUnit.class</a> (application/octet-stream)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038721/21135450.class">ApplicationProtocolDataUnit$ResponseAPDU.class</a> (application/octet-stream)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038721/21135451.class">ApplicationProtocolDataUnit$ResponseAPDU$1.class</a> (application/octet-stream)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038721/22052881.tiff">ets.tiff</a> (image/tiff)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/21038721/22052882.tiff">openremote.tiff</a> (image/tiff)
                                <br/>
                                                    </div>
				    
                                            <div class="tabletitle">
                            <a name="comments">Comments:</a>
                        </div>

                        <table border="0" width="100%">
                                                        <tr>
                                <td >
                                    <a name="comment-21038814"></a>
                                    <font class="smallfont"><p>Hi Tobo,</p>

<p>let's start slow <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> Do you have an ETS and can monitor the bus? What does your KNX switch send when activating a scene? Maybe the DPT and needed data load are not recognized yet.<br/>
With telnet you are right. In the moment the return value of an "action" command cannot be used for a sensor and you need a second command to check periodically.<br/>
I will create a JIRA issue for that since it makes sense to have <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> But I cannot say when this will be available.</p>

<p>--Marcus</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 19, 2012 08:17
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038817"></a>
                                    <font class="smallfont"><p>Sorry for the rant, it's because I needed to do a brain dump in my first post, I'll start to ask more incremental now that I got it out of my system.</p>

<p>Yep, I'm using ETS daily for fiddling with my KNX setup. The GW sends a byte value on GA 0/3/1. Basically the scenes are 1-indexed when programing actuators and 0-indexed when sending scenes on the bus. I've gotten scenes to work from push buttons, ETS (write to group) and also OR. The OR command is LEARN_SCENE (0-indexed) and uses DPT 18.001. I think the correct way is SCENE and DPT 17.001 but a bug existed that needed a workaround. </p>

<p>Regardless, when sending scenes that work the bus just displays a byte value representing scene 0-63.</p>

<p>What would be the correct way of setting up a sensor to catch this, it might be that I just haven't done it properly.</p>

<p>Command<br/>
GA: 0/3/1 (obvious)<br/>
Commands: STATUS/SCENE/LEARN_SCENE ?? (There is no way to query current scene as there is no master for scenes in KNX)<br/>
DPT: &lt;random byte value&gt;/17.001/18.001 ??</p>

<p>Sensor<br/>
Type: Range/Custom ??</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 19, 2012 09:20
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038822"></a>
                                    <font class="smallfont"><p>Would be interesting to see of Command "status" and custom sensor is able to pick up something.<br/>
1 byte can be picked up with dpt 5.001</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 19, 2012 10:00
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038825"></a>
                                    <font class="smallfont"><p>Gotcha, I'll give this a shoot as soon as I'm back home and can test. Will keep you posted!</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 19, 2012 11:09
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038837"></a>
                                    <font class="smallfont">
<div style="max-width: 600px;">
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java"> ERROR [Polling Sensor <span class="code-object">Thread</span> ID = 2261, Name ='Scene sensor']: Implementation error in protocol handler [FRAME] L_Data.req 0.0.0 -&gt; 0/3/1 Data: 0x00 : Unrecognized datapoint type 5.001 on CUSTOM sensor.
java.lang.Error: Unrecognized datapoint type 5.001 on CUSTOM sensor.
        at org.openremote.controller.protocol.knx.GroupValueRead.read(GroupValueRead.java:281)
        at org.openremote.controller.model.sensor.Sensor$DeviceReader.read(Sensor.java:682)
        at org.openremote.controller.model.sensor.Sensor$DeviceReader.run(Sensor.java:608)
        at java.lang.<span class="code-object">Thread</span>.run(<span class="code-object">Thread</span>.java:662)
</pre>
</div></div></div>

<p>The custom sensor casts the above error in the logs. Also tried a Level sensor (0-63), no errors but displays a 0 no matter what's seen on the bus. Any suggestions?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 19, 2012 17:18
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038841"></a>
                                    <font class="smallfont"><p>Could this be because openremote doesn't support sending and listening on the same channel?</p>

<p>I'm not sending the commands via OR, using push buttons or ETS, but I do have command definitions to send scens over 0/3/1 as discussed above. I'll try to remove the sending commands and see if I can get a status.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 19, 2012 18:28
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038842"></a>
                                    <font class="smallfont"><p>No dice with the above fix. Still no update on the Range sensor which is the one I can get working in terms of not throwing errors.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 19, 2012 18:34
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038844"></a>
                                    <font class="smallfont"><p>Which controller version are you using?<br/>
I can try and provide a fix.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 19, 2012 20:05
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038845"></a>
                                    <font class="smallfont"><p>For this test and at the moment I'm using 2.0.1.</p>

<p>I did do a SVN checkout tonight of the pro version v1.0.5 in order to see if that sorted the Android Webconsole issue mentioned in a different thread. Managed to do all the steps including compile/install but then I realized it of course had other (registered pro) user credentials, so no dice. I'm back on 2.0.1!</p>

<p>Tnx for the help btw!</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 19, 2012 20:14
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038853"></a>
                                    <font class="smallfont"><p>Ok, receiving a Scene value from the bus was not yet supported <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/><br/>
I created a fix and you can now use a Level sensor and the command is "status" with DPT 17.001.<br/>
This will give you your scene number which was received on the bus.</p>

<p>The install the fix copy the file "GroupValueRead.class" into the folder "webapps/controller/WEB-INF/classes/org/openremote/controller/protocol/knx"<br/>
and the file "Unsigned8Bit.class" into the folder "webapps/controller/WEB-INF/classes/org/openremote/controller/protocol/knx/datatype"</p>

<p><a href="attachments/21038721/21135440.class">GroupValueRead.class</a><br/>
<a href="attachments/21038721/21135441.class">Unsigned8Bit.class</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 19, 2012 21:52
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038862"></a>
                                    <font class="smallfont"><p>Unfortunately I little time to test this before heading to work but I did manage to do a hasty trial. One weird thing I noticed was that when I used the two files you linked to above, my controller interface looked like the one for the pro version (mac-adress bindings and other stuff on top), although I could still download configuration from the free designer. I think my controller got a bit confused as to whether it was running free or pro.</p>

<p>That aside, I managed to load the new configuration with STATUS, DPT 17.001 and a LEVEL sensor but still no dice. Unfortunately I didn't have time to debug anymore, needed to revert to old class files and restart since OR is actually used daily by myself and the wife. I think it might be time to install a parallell openremote for testing <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> Do you need me to look for anything specifically when I get around to testing this again (hopefully later today)?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 20, 2012 06:50
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038867"></a>
                                    <font class="smallfont"><p>Those 2 files don't have anything todo with pro or not.<br/>
You need the controller-2.1 developer snapshot.<br/>
I tested this last night where i assigned scene sending to one of my KNX push buttons and it worked well.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 20, 2012 08:15
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038868"></a>
                                    <font class="smallfont"><p>Must be something else with my SVN co that made the controller act funky in terms of pro/vanilla, well well it looks ok again at least.</p>

<p>As mentioned in this thread I'm running the 2.0.1 controller but I'll switch over to the 2.1 snapshot. Is this the latest and greatest or do you have a more recent one at hand?</p>

<p><a href="http://sourceforge.net/projects/openremote/files/For%20Developers/OpenRemote%202.0%20%28Developer%20Releases%29/OpenRemote-Controller-2.1.0_Developer-Snapshot-20120920.zip/download">http://sourceforge.net/projects/openremote/files/For%20Developers/OpenRemote%202.0%20%28Developer%20Releases%29/OpenRemote-Controller-2.1.0_Developer-Snapshot-20120920.zip/download</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 20, 2012 08:23
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038869"></a>
                                    <font class="smallfont"><p>That's the one.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 20, 2012 08:28
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038870"></a>
                                    <font class="smallfont"><p>I've installed the 2.1 snapshot and updated with the two files above. Unfortunately I can't check in ETS or use a push button at the moment since I'm doing this remotely but when using a button in OR to send scene value it doesn't work, it might be that sending the value from OR blocks the bus in terms of OR picking up its own message? Do you know if this sounds like an explanation or if it should be able to pickup it's "own" message?</p>

<p>I'll def try push buttons and ETS when I get home.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 20, 2012 08:53
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038874"></a>
                                    <font class="smallfont"><p>This change is only so that OR can receive a scene number from the bus.<br/>
It has nothing todo with sending scene numbers from OR.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 20, 2012 09:00
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038875"></a>
                                    <font class="smallfont"><p>I think I was unclear in asking my question. Sending scenes from OR works for me (with the workaround of using commands "LEARN_SCENE x" and DPT 18.001). I was wondering if using OR to send scenes on GA 0/3/1 block OR from receiving that same scene from GA 0/3/1. Ie, can OR see a bus commands that is sent by OR itself.</p>

<p>How does OR handle the fact that I have a LEARN_SCENE 18.001 against 0/3/1 at the same time as a STATUS 17.001 against 0/3/1?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 20, 2012 09:05
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038876"></a>
                                    <font class="smallfont"><p>Without my patch it was not able todo the STATUS 17.001 against 0/3/1 at all.</p>

<p>Now with the patch, I have to try if I can receive something if it was sent by us. Also, I have to look at the workaround, since LEARN_SCENE is kinda the wrong command name for sending <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 20, 2012 09:35
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038878"></a>
                                    <font class="smallfont"><p>Thanks for all the support Marcus!</p>

<p>I'd be very interested if you got the correct way (SCENE and 17.001) working instead of the workaround. It would be perfect if you found that OR can send and receive as well but I'll have to wait and see what you find out <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>The thread where I found the workaround:
<a href="http://openremote.wiki-neon.adaptavist.com/display/forums/KNX+Scene+and+Learn_Scene+command+issue...?showComments=false">http://openremote.wiki-neon.adaptavist.com/display/forums/KNX+Scene+and+Learn_Scene+command+issue...?showComments=false</a></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 20, 2012 09:42
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21038971"></a>
                                    <font class="smallfont"><p>I've fiddled some more with this and my findings are as follows.</p>

<p>1. A sensor with typ LEVEL connected against commands STATUS with DPT 17.001 updates when scene is sent on the bus (by other means than OR). Halfway there <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/><br/>
2. A scene sent by OR is not picked up by the scene sensor in OR.<br/>
3. I think, without looking at the code but after inspecting the bus and reading the workaround thread, that SCENE and LEARN_SCENE got mixed up? SCENE seems to add 128 to the actual value sent, that's what LEARN_SCENE is supposed to do afaik.</p>

<p>So, the incorrect SCENE and LEARN_SCENE values is one thing to look at but there's a workaround so not the main problem. Not being able to update the sensor with scenes from OR is a bigger thing in my book, let me describe two scenarios and we'll see if you agree or if I'm missing something.</p>

<p>OR can update sensor from scenes sent from OR<br/>
----------------------------------------------<br/>
I can define rules that act upon changes in scene sensor and extend the scenes (turn on TV etc). OR would pickup scenes assigned to push buttons and those sent by OR. Buttons in OR would just be defined to send scene and then rules would do the rest of the magic. Ie, one place to edit scene extensions in rules.</p>


<p>OR can't update sensor from scenes sent from OR<br/>
-------------------------------------------------<br/>
I can define rules that act upon changes in scene sensor and extend the scenes (turn on TV etc). OR would pickup scenes assigned to push buttons. Buttons in OR however would have to have a macro or similar defined that sent the scene and then ran the "extensions" also. One workaround would be to have a button that updated a virtual sensor and the rules definition is triggered by either scene change or status update of that object. I see one problem here though, if a push button is used to set scene 1, then an OR button is used for scene 2, then a push button is used again for scene 1, OR wouldn't pickup on the last change since the last non-OR scene it saw was 1.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 22, 2012 06:39
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21039096"></a>
                                    <font class="smallfont"><p>Attached please find a patch for the switched SCENE and LEARN_SCENE commands.<br/>
Also you don't need to substract 1 anymore.<br/>
Maybe you can give it a try and let me know if the general KNX scene functionality works with this patch?<br/>
Please copy the 3 files to "webapps/controller/WEB-INF/classes/org/openremote/controller/protocol/knx/":</p>

<ul class="alternate" type="square">
	<li><a href="attachments/21038721/21135449.class">ApplicationProtocolDataUnit.class</a></li>
	<li><a href="attachments/21038721/21135450.class">ApplicationProtocolDataUnit$ResponseAPDU.class</a></li>
	<li><a href="attachments/21038721/21135451.class">ApplicationProtocolDataUnit$ResponseAPDU$1.class</a></li>
</ul>


<p>I still have to check if OR can pickup a scene value if the scene command was send by OR itself.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Dec 26, 2012 23:25
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21039110"></a>
                                    <font class="smallfont"><p>Thanks Marcus, I'll try these out later today, tomorrow at the latest, and post my results.</p>

<p>Please get back to me regarding the OR seeing its own messages, a big deal at the moment for me <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 27, 2012 11:58
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21039169"></a>
                                    <font class="smallfont"><p>Tested the patches and everything looks good now. Scene does value -1 and learn_scene does -1+80.</p>

<p>Good and fast fix Marcus.</p>

<p>Tnx!</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 29, 2012 13:19
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21856711"></a>
                                    <font class="smallfont"><p>I just checked if OpenRemote picks up it's own data but that is not the case.<br/>
Sending out a scene command to group address 3/3/1 and having a status command listening on group address 3/3/1, nothing is picked up.<br/>
I can see the value is sent on the bus since it shows up in ETS group monitor but OpenRemote does not receive it.<br/>
Why this is the case, I cannot say. Maybe a physical address cannot receive group addresses that it sent itself.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jan 28, 2013 20:02
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21856719"></a>
                                    <font class="smallfont"><p>Hmmm, the way I see it this is something that needs fixing in order for OR to be "in sync" with the system at all times.</p>

<p>I see two ways of going about this:</p>

<p>1. Preferred<br/>
Since ETS can send and also see what it sends it can't be a limitation in KNX. ETS actually checks that it does see the package it tries to send on the bus, if it doesn't it throws a warning. This way OR would see the "real status" since it's following the traffic on the bus.</p>

<p>2. Workaround with flaws<br/>
Have OR fake a KNX command received if it sends something on the bus. I'm guessing implementing this is more of a hassle and also not perfect. If OR "thinks" it sent something on the bus it would update a sensor even though (if something went wrong) it didn't actually broadcast anything on the bus.</p>

<p>Has anyone looked into option #1 above, it would make the KNX implementation even more stable I'd say. As usual, I'll be happy to test any patches that you provide <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Jan 29, 2013 07:50
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21856723"></a>
                                    <font class="smallfont"><p>I can see in the ETS monitor that the package sent is slightly different between ETS and OR.<br/>
But I did not program the KNX stack in OR and cannot say why this happens and if it's normal or not.</p>

<p>I think it is ok that OR does not see the scene which it sends out since a scene is always linked to different actuators (switches, dimmers, ...) which return their new state as a seperate bus package. This is how OR currently knows about the correct state.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jan 29, 2013 08:30
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21856724"></a>
                                    <font class="smallfont"><p>I both agree and disagree.</p>

<p>In terms of light on etc<br/>
In the old days, actuators and switches didn't have a "status" object and you had to listen to the actual "switch on/off" in order to estimate the status of the light. This has drawbacks in terms of not being able to see status changes through other means such as scene, dimming down to off, dimming on, all lights on/off adress etc. The status object was introduced and an actuator could be set to always send updated status through a group adress, thus capturing state change regardless of how it came about. This is of course the way to see individual lights etc and OR does this well.</p>

<p>Also, even if the "moderna and correct" way of doing it is via status-objects, making OR see its own packages, it would also support older actuators that does not have this status object. In other words, just because there is a better way of doing it, I don't think OR should be limiting people from doing it the old-school way. Not a problem for me, just saying <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>In terms of scenes etc<br/>
Scenes are stateless in the senese that there is no central control saying "last played or active scene". Therefore, if you want to react to scenes in certain ways you have to listen for the scene at all times. Looking at light states etc is not a viable option since they can be "on" in many scenes, by manual intervention etc. If we were only talking KNX this would not be a problem but since OR aims to tie multiple protocols together it needs to be able to extend scenes. This works when a scene is sent by a push button or similar, OR picks up the scene change in a sensor and can act accordingly (turn on reciver etc). But if OR is the originator of the scene it won't extend the scene to incorporate more protocols than KNX since it doesn't see the actual telegram on the bus.</p>

<p>A possible workaround could be to have OR react on scenes sent by other means via rules and then have scenes sent by OR grouped in a macro that does the same thing as the rules. However, having the same thing set up in two places is just asking for trouble and not a "pretty" solution.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Jan 29, 2013 08:47
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21856725"></a>
                                    <font class="smallfont"><p>Agreed. I will have to speak to Juha who knows a little more about the history of the KNX stack and see if something can be done.<br/>
PS: I a only work with KNX for the last 5 years and don't know the "old school" anymore <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jan 29, 2013 09:03
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21856727"></a>
                                    <font class="smallfont"><p>Catching up on this thread. </p>

<p>Tobias, you seem to have deep knowledge of KNX and your help is appreciated. Thanks for all the debugging you've done so far.</p>

<p>Marcus, you said you see different bits in ETS frames vs. OR KNX frames, would be good to see what the differences are.</p>

<p>There's no obvious reason why bytes received from the bus wouldn't be received by OR, short of a glitch in the frame handling. Sending and receiving are done in separate threads, and you can print the received bytes in IPProcessor.PhysicalBusListener.run() method which is the thread implementation. Print the bytes out of the Message b instance, if they came through the socket, they're there.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
      @Override
      <span class="code-keyword">public</span> void run() {
         <span class="code-keyword">synchronized</span> (<span class="code-keyword">this</span>) {
            <span class="code-keyword">this</span>.notify();
         }
         <span class="code-keyword">while</span> (!<span class="code-keyword">this</span>.isInterrupted()) {
            <span class="code-keyword">try</span> {
               Message b = IpProcessor.<span class="code-keyword">this</span>.bus.receive();
               <span class="code-comment">// TODO Check sender address?
</span>
               <span class="code-comment">// Create an IpMessage from received data
</span>               IpMessage m = IpProcessor.<span class="code-keyword">this</span>.create(<span class="code-keyword">new</span> ByteArrayInputStream(b.getContent()));

               <span class="code-comment">// Handle Discovery responses specifically
</span>               <span class="code-keyword">if</span> (m <span class="code-keyword">instanceof</span> IpDiscoverResp) {
                  IpProcessor.<span class="code-keyword">this</span>.listener.notifyMessage(m);
               } <span class="code-keyword">else</span> {
                  <span class="code-comment">// Handle other messages
</span>                  <span class="code-keyword">if</span> (m.getPrimitive() == Primitive.RESP) {

                     <span class="code-comment">// Handle responses
</span>                     <span class="code-keyword">synchronized</span> (IpProcessor.<span class="code-keyword">this</span>.syncLock) {
                        IpProcessor.<span class="code-keyword">this</span>.con = m;
                        IpProcessor.<span class="code-keyword">this</span>.syncLock.notify();
                     }
                  } <span class="code-keyword">else</span> {
                     <span class="code-comment">// Handle requests
</span>                     IpProcessor.<span class="code-keyword">this</span>.listener.notifyMessage(m);
                  }
               }
            } <span class="code-keyword">catch</span> (IOException x) {
               <span class="code-comment">// Socket read error, stop thread
</span>               log.info(<span class="code-quote">"KNX-IP socket listener IOException"</span>, x);
               <span class="code-object">Thread</span>.currentThread().interrupt();
            } <span class="code-keyword">catch</span> (KnxIpException x) {
               <span class="code-comment">// Invalid message, stop thread
</span>               log.warn(<span class="code-quote">"KNX-IP socket listener KnxIpException"</span>, x);
               <span class="code-object">Thread</span>.currentThread().interrupt();
            }
         }
         log.warn(<span class="code-quote">"KNX-IP socket listener stopped"</span>);
      }
   }
</pre>
</div></div></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Jan 29, 2013 10:07
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21856728"></a>
                                    <font class="smallfont"><p>Juha, thanks for looking into this.<br/>
I did not find this piece of code last night and looked later in the hierarchy where the package did not arrive anymore.<br/>
I will debug again tonight and if the package shows up in this code fragment we should be able to provide a fix so that OpenRemote receives it's own bus messages.<br/>
I will also post the differences I saw in ETS.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jan 29, 2013 10:34
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21856729"></a>
                                    <font class="smallfont"><p>Awesome guys, thanks for the quick support! Fingers crossed as this would sort my current scene "issues".</p>

<p>After this I'll have to dig into the wonderful world of reg.exp and produce a working volume slider for my receiver <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Jan 29, 2013 10:37
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21856769"></a>
                                    <font class="smallfont"><p>Ok, I debugged this more and the message does arrive in OpenRemote <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/><br/>
It's just that it has a different MessageCode (first byte) and that's why we ignore it.<br/>
Here are the 2 messages how ETS is seeing them:<br/>
<a href="attachments/21038721/22052882.tiff" title="OpenRemote">OpenRemote</a><br/>
<a href="attachments/21038721/22052881.tiff" title="ETS">ETS</a></p>

<p>So sometimes it's a confirm byte and sometimes a indicate byte. The ETS group monitor shows both types.<br/>
Juha, our "status" command only handles one message code. See here:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
   @Override <span class="code-keyword">public</span> void receive(<span class="code-object">byte</span>[] cEmiFrame)
    {
      <span class="code-keyword">try</span>
      {
        <span class="code-comment">// Check cEMI message code
</span>        <span class="code-keyword">switch</span> (cEmiFrame[KNXCommand.CEMI_MESSAGECODE_OFFSET])
        {
          <span class="code-comment">// <span class="code-object">Runtime</span> confirmation telegram
</span>          <span class="code-keyword">case</span> MessageCode.DATA_CONFIRM_BYTE:
            <span class="code-keyword">synchronized</span> (<span class="code-keyword">this</span>.syncLock)
            {
              <span class="code-keyword">if</span>(<span class="code-keyword">this</span>.con == <span class="code-keyword">null</span>) {
                <span class="code-keyword">this</span>.con = cEmiFrame;
                <span class="code-keyword">this</span>.syncLock.notify();
              } <span class="code-keyword">else</span> {
                log.warn(<span class="code-quote">"Unexpected KNX con  ("</span> + <span class="code-object">Thread</span>.currentThread().toString() +<span class="code-quote">")"</span>);
              }
            }
            <span class="code-keyword">break</span>;
          <span class="code-comment">// Incoming runtime telegram
</span>          <span class="code-keyword">case</span> MessageCode.DATA_INDICATE_BYTE:
            <span class="code-keyword">this</span>.handleLDataInd(cEmiFrame);
            <span class="code-keyword">break</span>;
          <span class="code-keyword">default</span>:
            log.debug(<span class="code-quote">"Ignoring frame"</span>);        <span class="code-comment">// TODO
</span>        }
      }
      <span class="code-keyword">catch</span> (Throwable t)
      {
        log.error(<span class="code-quote">"KNX Error "</span>, t);              <span class="code-comment">// TODO
</span>      }
    }
</pre>
</div></div>

<p>We could just handle all messages or maybe create a second command "localStatus" which is used to listen to the other telegrams.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jan 29, 2013 21:00
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21856921"></a>
                                    <font class="smallfont"><p>Marcus,</p>

<p>Since I'm all happy about Rich releasing the new Android Console, and it works well for me, I thought I'd ping you and see if you've made any progress with the above? More and more pieces are coming together now <img class="emoticon" src="images/icons/emoticons/biggrin.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Jan 31, 2013 21:31
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21856922"></a>
                                    <font class="smallfont"><p>I will have to discuss with Juha how we implement this best.<br/>
I don't know how to handle those different message types correct but like you said it would make sense that OpenRemote also is able to receive it's own bus messages. Once we know how to do it, I will create a patch and you will be first to test it <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Jan 31, 2013 21:41
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21856923"></a>
                                    <font class="smallfont"><p>Perfetto, tnx! <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Jan 31, 2013 21:43
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21859877"></a>
                                    <font class="smallfont"><p>Hi Marcus, really don't mean to be a PITA but it seems I can't help it <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>Any news on this "feature"?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Apr 08, 2013 08:26
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21859938"></a>
                                    <font class="smallfont"><p>No news.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by mredeker at Apr 08, 2013 22:21
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21859949"></a>
                                    <font class="smallfont"><p>Data indicates and confirms are fundamentally different things. The status only listens to Data indicates because that is what is used to send state updates from the bus. The data confirm is used for confirming that the sent frames have been received by their targets.</p>

<p>These are explained here: <a href="http://www.openremote.org/display/knowledge/KNX+Data+Link+Layer+Data+Service+%28L_Data%29" title="KNX Data Link Layer Data Service (L_Data)">KNX Data Link Layer Data Service &#40;L&#95;Data&#41;</a></p>

<p>So the fact that there's a data confirm from a scene and no data indicate is in line with what Tobias is saying &#8211; scene's don't provide 'status' (L_Data.ind).</p>

<p>Even if we do listen to all data confirms (if they all end up broadcast on the bus even if we were not originating the data request L_Data.req), we would need to have some way of determining which of all the possible confirms are of interest to us, and what we would do with that information. </p>

<p>However, looking at the code snippet above, it would seem to hint that we only receive L_Data.con for frames that we originated. This could be a result of the gateway ignoring confirms on the bus that are not confirms to frames originated from the gateway &#8211; but I would need to go back and look at the full class implementation to be sure. If that would be the case, then the "outsider" push button not going through OR case would still not work, only tracking scenes originated from OR. In the latter case the "quick fix" is to push the scene state directly to state cache as the request (and eventual KNX frame) is heading out, the more appropriate fix is wait for the L_Data.con to arrive before doing so.</p>

<p>I'm not sure the effort is worth it in the generic case (of other devices that do not provide data indication frames) and then it would be scenes only that get this special handling.</p>

<p>I'll try to keep that in mind the next time I review the KNX code.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Apr 09, 2013 06:36
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21859951"></a>
                                    <font class="smallfont"><p>Juha,</p>

<p>I find myself having trouble following the logic at one point above. Regarding the "outside push button", that works today (with Marcus' patch), the problem is tracking OR originated scene changes only. Did I misread you above post or did you mistype something?</p>

<p>Tnx,<br/>
Tobias</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Apr 09, 2013 07:18
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-21859953"></a>
                                    <font class="smallfont"><p>I wasn't reading the thread that far up above. Was only commenting on the last part on L_Data.con handling. Read the proposal as using data confirm frames to track when scene has been changed.</p>

<p>L_Data.con is in fact a local confirm only from the data link layer (frame was sent, not acknowledged). Which explains why Olivier's code is only handling local confirms (I was most likely confusing confirms with acks). It also would mean that OR controller could in theory still end up out of sync from the actual physical state &#8211; how likely that is I'm not sure, depends on how KNX bus frame collisions handling, retries, etc.</p>

<p>A scene status (L_data.ind) would be required for more reliably keep the controller and physical devices synced.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Apr 09, 2013 07:47
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877387"></a>
                                    <font class="smallfont"><p>After a long time I'm back on this issue and have been reading the above over and over again and I think my question is this:</p>

<ul class="alternate" type="square">
	<li>Why don't we send DPT 17.001 with indicate, same as ETS?</li>
</ul>


<p>Wouldn't that fix the issue, be in line with KNX and require no change to the way OR reads messages? Maybe my brain isn't able to comprehend the thread anymore? <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> I guess that buttons send the scene as indicate? This would seem logical as it's stateless.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Oct 03, 2013 12:18
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877390"></a>
                                    <font class="smallfont"><p>Glad to see you back <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> I enjoy these deep conversations.</p>

<p>I took just a few minutes to scan back up the thread so it may be I'm missing or misremembering the point.</p>

<p>It seemed to be that the scene doesn't provide a specific status response &#8211; which would arrive as L_Data.ind as shown in the code snippets above and that we <b>do</b> handle as this is the common mechanism to send and receive status updates.</p>

<p>So therefore your question:</p>

<blockquote>
<p>Why don't we send DPT 17.001 with indicate, same as ETS?</p></blockquote>

<p>Seemed odd to me at first (it's the scene that would ideally send the indicate message, not us). Unless you meant why don't we generate an indicate for 17.001 and push it through the stack to make it seem as if an indicate was received, even though we know one will never be arriving?</p>

<p>If that's the intent, then I can look at that but immediately the issue I can imagine with that is we are talking about code fairly deep in the KNX stack and unfortunately, for reasons I don't know, the KNX frames do not carry the DPT information with the frames. So whether we in fact know that we are sending a 17.001 frame at this point is a bit of a question mark.</p>

<p>I'm working on other parts of KNX stack code today, not this particular section but I can take a quick look if it would be possible to make determination based on the DPT. I'm not terribly optimistic but you never know <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> I can afford to do a deeper analysis on a later date but currently there are a couple of more pressing issues with the KNX stack I want to address first.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Oct 03, 2013 13:11
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877391"></a>
                                    <font class="smallfont"><p>Mmm, and if that was indeed the idea, and looking at the code, I could see a possibility to do this. I should have the DPT information available. I can try to create a patch to test but that'll have to wait a few days.</p>

<p>So do we know for certain that 17.001 will never, under any circumstances, from any vendor send a data indicate back? Or is this something specific to certain vendors? Sorry it may have been covered above in the thread, I just didn't have time to look back that far.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Oct 03, 2013 13:18
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877394"></a>
                                    <font class="smallfont"><p>Hehe, thanks for the lightning quick reply, glad to be back <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>I was thinking of sending the same message type as a button would send, ie for DPT 17.001 send an indication and not a confirm? If buttons send both, that's the way to go I guess. Maybe I misunderstood as I haven't looked at the packets in that detail myself but I rather go on Marcus' comments above.</p>

<p>Didn't he conclude in a post above (the one with the tiff attachments) that ETS sends an indicate and not a confirm for DPT 17.001? Then I'm guessing a button would do the same thing and thusly it would be ok for OR as well. Putting me a bit on the spot with the question "never, under any circumstance" <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> I have two follow up questions to that:</p>

<p>1. What would break if anything was to send an indicate back?<br/>
2. What would "ack" a scene change? The status that change is not scene but rather the value of the object affected by the scene (ie, lamp on/of, brightness).</p>

<p>I'd say that we're safe in sending an .ind but wouldn't like to be the one who "broke" OR <img class="emoticon" src="images/icons/emoticons/wink.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>If you create a patch, of course I'll be willing to try it out, running OpenRemote-Controller-2.1.0_SNAPSHOT-2013-06-17 at the moment.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Oct 03, 2013 13:38
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877396"></a>
                                    <font class="smallfont"><p>Hi Tobo,</p>

<p>My house is "just" finished refurbished, and is now running KNX throughout as well, but I am missing a few things, like a door bell (preferable with camera that takes picture) and the survilance cameras. </p>

<p>Any tips on what to buy for doorbell and survilance camera?<br/>
My setup is running from a Synology.</p>

<p>Up untill discovering OpenRemote i have used Siemens LOGO and ETS to make functions, so considering the possebilities with OpenRemote I am now spending day and night to "reprogram" my house and include my denon receiver, samsung tv, garageopener, Sonos and all <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>A bit of topic, and for that I apologize.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by istian at Oct 03, 2013 13:54
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877404"></a>
                                    <font class="smallfont"><blockquote>
<p>Didn't he conclude in a post above (the one with the tiff attachments) that ETS sends an indicate and not a confirm for DPT 17.001?</p></blockquote>

<p>In the attachments as far as I am able to tell are two frames ETS monitored. One is a confirm frame (possibly a remote confirm, I don't see why else it would be sent on the bus) and another is a data indicate frame.</p>

<p>I don't think ETS sent either one (they are from two different sources). Unless it was some kind of ETS programming mode I'm not aware of.</p>

<blockquote>
<p>1. What would break if anything was to send an indicate back?</p></blockquote>

<p>In this case the <b>absence</b> of indicate (and indeed an absence of ACK on the transport layer too) would mean a high likelyhood that the scene was not changed, despite us sending a request to do so. </p>


<p>So what's still confusing here is that there's no clear answer on the DPT 17.001 data indicates &#8211; clearly some are sent on the bus (the ETS can monitor them) and from other posts it appears you <b>can</b> receive an indicate if you use the physical push button. </p>

<p>So the case seems to be that there's NO indicate as a response to a data request made by OR? This I find to be odd, I'd even consider it broken especially if there is an indicate in response to a physical "request" to change a scene. Why would a request to change scene over KNX frame be treated different?</p>


<blockquote>
<p>2. What would "ack" a scene change? The status that change is not scene but rather the value of the object affected by the scene (ie, lamp on/of, brightness).</p></blockquote>

<p>An ACK on tunneling transport level would mean the scene request has been received. It wouldn't yet necessarily mean the scene was set correctly &#8211; since this does require each individual object to confirm their state changes first.</p>

<hr />

<p>To keep this becoming too theoretical, I can still hack together the patch to humour you, but it's not something I would consider for a release unless there's some clarity to the actual frames being sent in case of 17.001. Right now the data indicates seem to exist... just only in response to physical scene change, not a scene change request with a KNX frame? And if the latter is the case, I'd like to see if that's behavior somehow mandated (which I'm finding strange) or something specific to a single vendor?</p>

<p>Sorry for being a pain about this but the information so far to me looks conflicting.</p>

</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Oct 03, 2013 17:19
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877414"></a>
                                    <font class="smallfont"><blockquote>
<p>To keep this becoming too theoretical, I can still hack together the patch to humour you, but it's not something I would consider for a release unless there's some clarity to the actual frames being sent in case of 17.001.</p></blockquote>

<p>What we can do though, even in a release, is to include some kind of 'quirks' mode for the DPT 17.001 that can be turned on. In case we cannot find clarity of exactly what's going on.</p>

<p>Assuming of course we find a working patch first. Will work on that later.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Oct 03, 2013 20:40
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877461"></a>
                                    <font class="smallfont"><p>Theoretical is interesting!</p>

<p>Still, this comment "I can see in the ETS monitor that the package sent is slightly different between ETS and OR." says that one is originating from ETS and one from OR? There is the possibility of doing READ/WRITE on a address, that's what he did from ETS for a 17.001 I'd assume and it turned out to be a indicate.</p>

<p>On your comment "So the case seems to be that there's NO indicate as a response to a data request made by OR? This I find to be odd, I'd even consider it broken especially if there is an indicate in response to a physical "request" to change a scene. Why would a request to change scene over KNX frame be treated different?" - I don't find this odd at all if sources are meant to send indicates for DPT 17, it makes perfect sense then? No master source so it's "best effort" in terms of sender saying that "now it's this scene". Logically, if there's no-one to respond (and contest) there is no right/wrong and a sender might as well say "this is the truth now".</p>

<p>As mentioned earlier, please throw any patch my way and I'll try it out <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Oct 04, 2013 12:00
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877466"></a>
                                    <font class="smallfont"><blockquote>
<p>Still, this comment "I can see in the ETS monitor that the package sent is slightly different between ETS and OR." says that one is originating from ETS and one from OR? There is the possibility of doing READ/WRITE on a address, that's what he did from ETS for a 17.001 I'd assume and it turned out to be a indicate.</p></blockquote>

<p>A group read request over CEMI/IP would always result in an ACK frame and data indicate frame. This is normal. There would never be any other result.</p>

<p>The two frames shown were not the same frames at all, one being a data confirm and another a data indicate. So comparing the two doesn't make sense, they're used for completely different purposes.</p>


<blockquote>
<p>I don't find this odd at all if sources are meant to send indicates for DPT 17, it makes perfect sense then?</p></blockquote>

<p>If there's an indicate being sent in response to a physical switch change but NOT sent in response to a KNX write request, I do find that odd, as it does not appear logical to me. Both result in some sort of state change, in both cases a data indicate should then be sent.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Oct 04, 2013 12:09
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877473"></a>
                                    <font class="smallfont"><p>There might not be a state change, not in terms of changing scenes as there is no "master".</p>

<p>I mean the logic might be as follows:<br/>
When something can answer indicate (ie, there's a status object or similar) a write request is sent. (DPT different from 17.001)<br/>
When there's no master, no-one can send the indicate, therefore the originator of the request sends the indicator. (DPT 17.001)</p>

<p>Is there actually an indicate being sent as a "response" or is it just being sent so to say.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Oct 04, 2013 12:19
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877475"></a>
                                    <font class="smallfont"><blockquote>
<p>When there's no master, no-one can send the indicate, therefore the originator of the request sends the indicator. (DPT 17.001)</p></blockquote>

<p>Ok, I see. Would be good to see some documentation to support that this is indeed what we're supposed to do.</p>

<p>It's also a different variation to the original patch I proposed which would have just created the indicate frame back up the OR call stack (and have OR react to it) not broadcast it to the bus for everyone to see. And I suppose in latter case it would have to be a broadcast since there would be no destination address.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Oct 04, 2013 12:24
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877484"></a>
                                    <font class="smallfont"><p>Now I managed to explain my thinking at least <img class="emoticon" src="images/icons/emoticons/biggrin.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>Yes, it would be good to find documentation on this. What I'm guessing is that I/someone/you could, as a start, check what ETS does and what a button does just to get an inclination? I think that's actually what Marcus has done above already, compared ETS to OR.</p>

<p>I'm fine with your approach as well in order to fix my own problem (have the OR stack see the indicate) but I'm guessing as you say, if OR is to be as compliant as possible it should be broadcast. I'll try to dig up some documentation but I don't really know where to look except google <img class="emoticon" src="images/icons/emoticons/wink.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Oct 04, 2013 13:14
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877485"></a>
                                    <font class="smallfont"><p>There's some notes in one of the supplements of KNX 1.1 specification (17.xxx and above were not part of the spec at this point yet) that could be interpreted to support your thinking. As usual, the KNX documents give little to no context what their notes mean or how should they be interpreted so it's at best a guess at this point. Highly frustrating but not unusual.</p>
</font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Oct 04, 2013 13:51
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877490"></a>
                                    <font class="smallfont"><p>I like interpretations that support my claims <img class="emoticon" src="images/icons/emoticons/wink.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>Still though, are there later version of the KNX spec in which this can be verified? Would be nice for me to get the functionality and for you to get an even better product.</p>

<p>Basically, what's the way forward now, need me to do anything?</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Oct 04, 2013 15:09
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877501"></a>
                                    <font class="smallfont"><p>There's a 2.0 version but haven't spent the money yet to get to read it. Mostly because the basics likely haven't changed (frame structures, etc) but the 1.1 doesn't have any descriptions of DPTs above 16.xxx &#8211; and even the ones we have in 1.1 don't really seem to reveal the amount of detail we've been discussing. You sort of have to infer it. Don't know if they've done a lot of additional writing work in 2.0 (I would hope) but I'm suspicious.</p>

<p>So will get it later, for now will manage with the current version.</p>

<p>I'll create a patch for the local loopback of data indicate to test, should be almost a one liner. A more reliable way to do it would be based on data confirm but will see if that's going to generate more work or having to touch bits that aren't sufficiently backed by tests yet (which would mean more work for now before getting the functionality in). Won't do the public broadcast for now until we get more clarification if that is indeed what's expected. So if the patch works will leave it in as a special config mode and wait for another user to come back to validate whether they have the same issue and if they can reproduce the same behavior wrt lack of data indicates.</p>

<p>That's the plan. If you want to dig up more details from ETS, go ahead. </p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Oct 04, 2013 17:13
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877507"></a>
                                    <font class="smallfont"><p>Being a curious fellow, how much is the 2.0 spec?</p>

<p>Also, thanks in advance for the patch.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Oct 04, 2013 17:45
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877508"></a>
                                    <font class="smallfont"><p>EUR 1000.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Oct 04, 2013 18:14
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22877511"></a>
                                    <font class="smallfont"><p>Ok, that was a bit steep... <img class="emoticon" src="images/icons/emoticons/sad.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Oct 04, 2013 18:48
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22878189"></a>
                                    <font class="smallfont"><p>I've tried talking to people I know that work with patents, unfortunately they had no collaboration with ISO/IEC so I couldn't get a hold off EN 50090. Back to square one for now.</p>

<p>Have you given this more thought Juha, way forward or patch?</p>

<p>Another question I've thought about is when you have an object without a separate status object, then you have to setup a status on the same GA as you use for the setting of that value. This works if the originator is not OR but not if OR is the one sending the message. I've seen discussions about this before, just don't remember what the outcome was.</p>

<p>Example<br/>
I have buttons with thermostats and there are no separate "wanted temperature" and "set temperature" channels. They're both done over the same GA and you Read/Write towards the same channel. If I set the value in ETS it's updated in OR but not when setting the value from OR.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Oct 15, 2013 07:19
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22878227"></a>
                                    <font class="smallfont"><blockquote><p>I've tried talking to people I know that work with patents, unfortunately they had no collaboration with ISO/IEC so I couldn't get a hold off EN 50090</p></blockquote>
<p><b>EN</b> stands for European Norm. Such norms are produced by either CEN, CENELEC, or ETSI. These organisations do not distribute the norms, that is done by the National Stadardisation Institutes, such as DIN in Germany, SIS in Sweden, etc. The EN 50090 comes in several parts, and costs all together a couple of hunred EURO.<br/>
You could try to locate a draft version.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by pz1 at Oct 15, 2013 15:16
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22878229"></a>
                                    <font class="smallfont"><p>Still busy working on other things around KNX. I'll take a look at creating the patch for this though, if it doesn't distract me too much from the work I'm doing.</p>

<p>Thanks for checking the spec. I'll get around ordering the 2.0 specs at some point, but right now spending EUR1000 for a few updates seems a bit silly. The association should just post the things on the net <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>Re: other things wrt KNX with no status objects &#8211; will have to wait until I've had a chance to properly untangle some bits in the KNX stack. We can look at those issues at that point. Right now as things stand it is extremely difficult to find any time at all to work on KNX. Trying to add bits here and there as I can.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by juha at Oct 15, 2013 16:35
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22878231"></a>
                                    <font class="smallfont"><p>Fully agree on it being publicly available <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/> </p>

<p>Thanks for the attention in both cases, scenes and missing status objects! Are they in fact maybe related, time will tell.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Oct 15, 2013 17:04
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22881396"></a>
                                    <font class="smallfont"><p>Hi again Juha, now I'm into my next little implementation part, z-wave. Have gotten it up and running but are ironing out some of the details, as always <img class="emoticon" src="images/icons/emoticons/smile.gif" height="20" width="20" align="absmiddle" alt="" border="0"/></p>

<p>Any luck with looking at our conversation about requests/indicates? I always get back to this after fiddling with other parts of OR.</p>

<p>Also, a quick question that you might be able to answer in the meantime. How would I write my rules so that an Event/Switch does not fire at startup of OR? I have some rules (looking for status "on") based on Switch that fire at restart since the read value is on at start. Tried looking through the threads, found one mention but no solution.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Dec 18, 2013 19:17
                                    </div>
                                </td>
                            </tr>
                                                        <tr>
                                <td  style="border-top: 1px dashed #666666">
                                    <a name="comment-22883345"></a>
                                    <font class="smallfont"><p>Wanted to know if you had any updates on this, has the initiative been "killed" or is it close to reaching a testable patch?</p>

<p>Right now I'm doing work with scenes and need to do the following for both OR and pushbuttons to work:<br/>
1. Have a scene listener in OR that picks up scenes from buttons and then fires rules accordingly.<br/>
2. Have OR-buttons that does the same thing as above and then sends the KNX scene on the bus.</p>

<p>Problems:</p>
<ul class="alternate" type="square">
	<li>When having a status command on the scene bus, OR will "spam" the KNX with STATUS requests since no-one is answering.</li>
	<li>There are multiple places to update when I want to change things around in the scenario.</li>
</ul>


<p>Findings:<br/>
Some equipment actually stores the last scene seen on the bus and if you set the R flag they respond, I don't like enabling this though as they might be out of sync or similar and also, OR should be the master (if any at all). Also, it doesn't solve the issue of OR "not seeing" it's own scene commands.</p>

<p>I'll ask the other question regarding startup in the general forum.</p></font>
                                    <div align="left" class="smallfont" style="color: #666666; width: 98%; margin-bottom: 10px;">
                                        <img src="images/icons/comment_16.gif" height="16" width="16" border="0" align="absmiddle"/>
                                        Posted by tobo at Jan 24, 2014 15:07
                                    </div>
                                </td>
                            </tr>
                                                    </table>
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://www.openremote.org/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 05, 2016 10:45</font></td>
		    </tr>
	    </table>
    </body>
</html>